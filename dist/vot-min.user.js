// ==UserScript==
// @name           [VOT] - Voice Over Translation
// @name:de        [VOT] - Voice-Over-Video-Übersetzung
// @name:es        [VOT] - Traducción de vídeo en off
// @name:fr        [VOT] - Traduction vidéo voix-off
// @name:it        [VOT] - Traduzione Video fuori campo
// @name:ru        [VOT] - Закадровый перевод видео
// @name:zh        [VOT] - 画外音视频翻译
// @description    A small extension that adds a Yandex Browser video translation to other browsers
// @description:de Eine kleine Erweiterung, die eine Voice-over-Übersetzung von Videos aus dem Yandex-Browser zu anderen Browsern hinzufügt
// @description:es Una pequeña extensión que agrega una traducción de voz en off de un video de Yandex Browser a otros navegadores
// @description:fr Une petite extension qui ajoute la traduction vocale de la vidéo du Navigateur Yandex à d'autres navigateurs
// @description:it Una piccola estensione che aggiunge la traduzione vocale del video dal browser Yandex ad altri browser
// @description:ru Небольшое расширение, которое добавляет закадровый перевод видео из Яндекс Браузера в другие браузеры
// @description:zh 一个小扩展，它增加了视频从Yandex浏览器到其他浏览器的画外音翻译
// @grant          unsafeWindow
// @grant          GM_addStyle
// @grant          GM_deleteValue
// @grant          GM_listValues
// @grant          GM_setValue
// @grant          GM_getValue
// @grant          GM_xmlhttpRequest
// @grant          GM_notification
// @grant          GM_info
// @grant          window.focus
// @require        https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.5.18/hls.light.min.js
// @require        https://gist.githubusercontent.com/ilyhalight/6eb5bb4dffc7ca9e3c57d6933e2452f3/raw/7ab38af2228d0bed13912e503bc8a9ee4b11828d/gm-addstyle-polyfill.js
// @match          *://*.youtube.com/*
// @match          *://*.youtube-nocookie.com/*
// @match          *://*.youtubekids.com/*
// @match          *://*.twitch.tv/*
// @match          *://*.xvideos.com/*
// @match          *://*.xvideos-ar.com/*
// @match          *://*.xvideos005.com/*
// @match          *://*.xv-ru.com/*
// @match          *://*.pornhub.com/*
// @match          *://*.pornhub.org/*
// @match          *://*.vk.com/*
// @match          *://*.vkvideo.ru/*
// @match          *://*.vk.ru/*
// @match          *://*.vimeo.com/*
// @match          *://*.imdb.com/*
// @match          *://*.9gag.com/*
// @match          *://*.twitter.com/*
// @match          *://*.x.com/*
// @match          *://*.facebook.com/*
// @match          *://*.rutube.ru/*
// @match          *://*.bilibili.com/*
// @match          *://my.mail.ru/*
// @match          *://*.bitchute.com/*
// @match          *://*.coursera.org/*
// @match          *://*.udemy.com/course/*
// @match          *://*.tiktok.com/*
// @match          *://*.douyin.com/*
// @match          *://rumble.com/*
// @match          *://*.eporner.com/*
// @match          *://*.dailymotion.com/*
// @match          *://*.ok.ru/*
// @match          *://trovo.live/*
// @match          *://disk.yandex.ru/*
// @match          *://disk.yandex.kz/*
// @match          *://disk.yandex.com/*
// @match          *://disk.yandex.com.am/*
// @match          *://disk.yandex.com.ge/*
// @match          *://disk.yandex.com.tr/*
// @match          *://disk.yandex.by/*
// @match          *://disk.yandex.az/*
// @match          *://disk.yandex.co.il/*
// @match          *://disk.yandex.ee/*
// @match          *://disk.yandex.lt/*
// @match          *://disk.yandex.lv/*
// @match          *://disk.yandex.md/*
// @match          *://disk.yandex.net/*
// @match          *://disk.yandex.tj/*
// @match          *://disk.yandex.tm/*
// @match          *://disk.yandex.uz/*
// @match          *://youtube.googleapis.com/embed/*
// @match          *://*.banned.video/*
// @match          *://*.madmaxworld.tv/*
// @match          *://*.weverse.io/*
// @match          *://*.newgrounds.com/*
// @match          *://*.egghead.io/*
// @match          *://*.youku.com/*
// @match          *://*.archive.org/*
// @match          *://*.patreon.com/*
// @match          *://*.reddit.com/*
// @match          *://*.kodik.info/*
// @match          *://*.kodik.biz/*
// @match          *://*.kodik.cc/*
// @match          *://*.kick.com/*
// @match          *://developer.apple.com/*
// @match          *://dev.epicgames.com/*
// @match          *://*.rapid-cloud.co/*
// @match          *://odysee.com/*
// @match          *://learning.sap.com/*
// @match          *://*.watchporn.to/*
// @match          *://*.linkedin.com/*
// @match          *://*.incestflix.net/*
// @match          *://*.incestflix.to/*
// @match          *://*.porntn.com/*
// @match          *://*.dzen.ru/*
// @match          *://*.cloudflarestream.com/*
// @match          *://*.loom.com/*
// @match          *://*.artstation.com/learning/*
// @match          *://*.rt.com/*
// @match          *://*.bitview.net/*
// @match          *://*.kickstarter.com/*
// @match          *://*.thisvid.com/*
// @match          *://*.ign.com/*
// @match          *://*.bunkr.site/*
// @match          *://*.bunkr.black/*
// @match          *://*.bunkr.cat/*
// @match          *://*.bunkr.media/*
// @match          *://*.bunkr.red/*
// @match          *://*.bunkr.ws/*
// @match          *://*.bunkr.org/*
// @match          *://*.bunkr.sk/*
// @match          *://*.bunkr.si/*
// @match          *://*.bunkr.su/*
// @match          *://*.bunkr.ci/*
// @match          *://*.bunkr.cr/*
// @match          *://*.bunkr.fi/*
// @match          *://*.bunkr.ph/*
// @match          *://*.bunkr.pk/*
// @match          *://*.bunkr.ps/*
// @match          *://*.bunkr.ru/*
// @match          *://*.bunkr.la/*
// @match          *://*.bunkr.is/*
// @match          *://*.bunkr.to/*
// @match          *://*.bunkr.ac/*
// @match          *://*.bunkr.ax/*
// @match          *://web.telegram.org/k/*
// @match          *://t2mc.toil.cc/*
// @match          *://mylearn.oracle.com/*
// @match          *://learn.deeplearning.ai/*
// @match          *://learn-staging.deeplearning.ai/*
// @match          *://learn-dev.deeplearning.ai/*
// @match          *://*.netacad.com/content/i2cs/*
// @match          *://*/*.mp4*
// @match          *://*/*.webm*
// @match          *://*.yewtu.be/*
// @match          *://yt.artemislena.eu/*
// @match          *://invidious.flokinet.to/*
// @match          *://iv.melmac.space/*
// @match          *://inv.nadeko.net/*
// @match          *://inv.tux.pizza/*
// @match          *://invidious.private.coffee/*
// @match          *://yt.drgnz.club/*
// @match          *://vid.puffyan.us/*
// @match          *://invidious.dhusch.de/*
// @match          *://*.piped.video/*
// @match          *://piped.tokhmi.xyz/*
// @match          *://piped.moomoo.me/*
// @match          *://piped.syncpundit.io/*
// @match          *://piped.mha.fi/*
// @match          *://watch.whatever.social/*
// @match          *://piped.garudalinux.org/*
// @match          *://efy.piped.pages.dev/*
// @match          *://watch.leptons.xyz/*
// @match          *://piped.lunar.icu/*
// @match          *://yt.dc09.ru/*
// @match          *://piped.mint.lgbt/*
// @match          *://*.il.ax/*
// @match          *://piped.privacy.com.de/*
// @match          *://piped.esmailelbob.xyz/*
// @match          *://piped.projectsegfau.lt/*
// @match          *://piped.in.projectsegfau.lt/*
// @match          *://piped.us.projectsegfau.lt/*
// @match          *://piped.privacydev.net/*
// @match          *://piped.palveluntarjoaja.eu/*
// @match          *://piped.smnz.de/*
// @match          *://piped.adminforge.de/*
// @match          *://piped.qdi.fi/*
// @match          *://piped.hostux.net/*
// @match          *://piped.chauvet.pro/*
// @match          *://piped.jotoma.de/*
// @match          *://piped.pfcd.me/*
// @match          *://piped.frontendfriendly.xyz/*
// @match          *://proxitok.pabloferreiro.es/*
// @match          *://proxitok.pussthecat.org/*
// @match          *://tok.habedieeh.re/*
// @match          *://proxitok.esmailelbob.xyz/*
// @match          *://proxitok.privacydev.net/*
// @match          *://tok.artemislena.eu/*
// @match          *://tok.adminforge.de/*
// @match          *://tt.vern.cc/*
// @match          *://cringe.whatever.social/*
// @match          *://proxitok.lunar.icu/*
// @match          *://proxitok.privacy.com.de/*
// @match          *://peertube.1312.media/*
// @match          *://tube.shanti.cafe/*
// @match          *://*.bee-tube.fr/*
// @match          *://video.sadmin.io/*
// @match          *://*.dalek.zone/*
// @match          *://review.peertube.biz/*
// @match          *://*.peervideo.club/*
// @match          *://tube.la-dina.net/*
// @match          *://peertube.tmp.rcp.tf/*
// @match          *://*.peertube.su/*
// @match          *://video.blender.org/*
// @match          *://videos.viorsan.com/*
// @match          *://tube-sciences-technologies.apps.education.fr/*
// @match          *://tube-numerique-educatif.apps.education.fr/*
// @match          *://tube-arts-lettres-sciences-humaines.apps.education.fr/*
// @match          *://*.beetoons.tv/*
// @match          *://comics.peertube.biz/*
// @match          *://*.makertube.net/*
// @match          *://*.poketube.fun/*
// @match          *://pt.sudovanilla.org/*
// @match          *://poke.ggtyler.dev/*
// @match          *://poke.uk2.littlekai.co.uk/*
// @match          *://poke.blahai.gay/*
// @match          *://*.ricktube.ru/*
// @match          *://*.coursehunter.net/*
// @match          *://*.coursetrain.net/*
// @exclude        file://*/*.mp4*
// @exclude        file://*/*.webm*
// @exclude        *://accounts.youtube.com/*
// @connect        yandex.ru
// @connect        disk.yandex.kz
// @connect        disk.yandex.com
// @connect        disk.yandex.com.am
// @connect        disk.yandex.com.ge
// @connect        disk.yandex.com.tr
// @connect        disk.yandex.by
// @connect        disk.yandex.az
// @connect        disk.yandex.co.il
// @connect        disk.yandex.ee
// @connect        disk.yandex.lt
// @connect        disk.yandex.lv
// @connect        disk.yandex.md
// @connect        disk.yandex.net
// @connect        disk.yandex.tj
// @connect        disk.yandex.tm
// @connect        disk.yandex.uz
// @connect        yandex.net
// @connect        timeweb.cloud
// @connect        raw.githubusercontent.com
// @connect        vimeo.com
// @connect        toil.cc
// @connect        deno.dev
// @connect        onrender.com
// @connect        workers.dev
// @connect        speed.cloudflare.com
// @connect        porntn.com
// @connect        googlevideo.com
// @namespace      vot-min
// @version        1.10.3
// @icon           https://translate.yandex.ru/icons/favicon.ico
// @author         Toil, SashaXser, MrSoczekXD, mynovelhost, sodapng
// @homepageURL    https://github.com/ilyhalight/voice-over-translation
// @updateURL      https://raw.githubusercontent.com/ilyhalight/voice-over-translation/master/dist/vot-min.user.js
// @downloadURL    https://raw.githubusercontent.com/ilyhalight/voice-over-translation/master/dist/vot-min.user.js
// @supportURL     https://github.com/ilyhalight/voice-over-translation/issues
// ==/UserScript==

(()=>{var __webpack_modules__={"./node_modules/@vot.js/core/dist/client.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{Ay:()=>VOTClient,Pu:()=>VOTWorkerClient});var _vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`),_vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/logger.js`),_vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/shared/dist/protos/yandex.js`),_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/@vot.js/shared/dist/secure.js`),_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/utils.js`),_protobuf_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./node_modules/@vot.js/core/dist/protobuf.js`),_types_yandex_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/yandex.js`),_utils_vot_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./node_modules/@vot.js/core/dist/utils/vot.js`),_src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/utils/VOTLocalizedError.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__]);_src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class VOTJSError extends Error{data;constructor(message,data=void 0){super(message),this.data=data,this.name=`VOTJSError`,this.message=message}}class MinimalClient{host;schema;fetch;fetchOpts;sessions={};userAgent=_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.userAgent;headers={"User-Agent":this.userAgent,Accept:`application/x-protobuf`,"Accept-Language":`en`,"Content-Type":`application/x-protobuf`,Pragma:`no-cache`,"Cache-Control":`no-cache`};hostSchemaRe=/(http(s)?):\/\//;constructor({host=_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.host,fetchFn=_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_4__.u9,fetchOpts={},headers={}}={}){let schema=this.hostSchemaRe.exec(host)?.[1];this.host=schema?host.replace(`${schema}://`,``):host,this.schema=schema??`https`,this.fetch=fetchFn,this.fetchOpts=fetchOpts,this.headers={...this.headers,...headers}}async request(path,body,headers={},method=`POST`){let options=this.getOpts(new Blob([body]),headers,method);try{let res=await this.fetch(`${this.schema}://${this.host}${path}`,options),data=await res.arrayBuffer();return{success:res.status===200,data}}catch(err){return{success:!1,data:err?.message}}}async requestJSON(path,body=null,headers={},method=`POST`){let options=this.getOpts(body,{"Content-Type":`application/json`,...headers},method);try{let res=await this.fetch(`${this.schema}://${this.host}${path}`,options),data=await res.json();return{success:res.status===200,data}}catch(err){return{success:!1,data:err?.message}}}getOpts(body,headers={},method=`POST`){return{method,headers:{...this.headers,...headers},body,...this.fetchOpts}}async getSession(module){let timestamp=(0,_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_4__.lg)(),session=this.sessions[module];if(session&&session.timestamp+session.expires>timestamp)return session;let{secretKey,expires,uuid}=await this.createSession(module);return this.sessions[module]={secretKey,expires,timestamp,uuid},this.sessions[module]}async createSession(module){let uuid=(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.yk)(),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.P.encodeSessionRequest(uuid,module),res=await this.request(`/session/create`,body,{"Vtrans-Signature":await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.dD)(body)});if(!res.success)throw new VOTJSError(`Failed to request create session`,res);let sessionResponse=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.P.decodeSessionResponse(res.data);return{...sessionResponse,uuid}}}class VOTClient extends MinimalClient{hostVOT;schemaVOT;apiToken;requestLang;responseLang;paths={videoTranslation:`/video-translation/translate`,videoTranslationFailAudio:`/video-translation/fail-audio-js`,videoTranslationAudio:`/video-translation/audio`,videoTranslationCache:`/video-translation/cache`,videoSubtitles:`/video-subtitles/get-subtitles`,streamPing:`/stream-translation/ping-stream`,streamTranslation:`/stream-translation/translate-stream`};isCustomLink(url){return!!(/\.(m3u8|m4(a|v)|mpd)/.exec(url)??/^https:\/\/cdn\.qstv\.on\.epicgames\.com/.exec(url))}headersVOT={"User-Agent":`vot.js/${_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.version}`,"Content-Type":`application/json`,Pragma:`no-cache`,"Cache-Control":`no-cache`};constructor({host,hostVOT=_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.hostVOT,fetchFn,fetchOpts,requestLang=`en`,responseLang=`ru`,apiToken,headers}={}){super({host,fetchFn,fetchOpts,headers});let schemaVOT=this.hostSchemaRe.exec(hostVOT)?.[1];this.hostVOT=schemaVOT?hostVOT.replace(`${schemaVOT}://`,``):hostVOT,this.schemaVOT=schemaVOT??`https`,this.requestLang=requestLang,this.responseLang=responseLang,this.apiToken=apiToken}get apiTokenHeader(){return this.apiToken?{Authorization:`OAuth ${this.apiToken}`}:{}}async requestVOT(path,body,headers={}){let options=this.getOpts(JSON.stringify(body),{...this.headersVOT,...headers});try{let res=await this.fetch(`${this.schemaVOT}://${this.hostVOT}${path}`,options),data=await res.json();return{success:res.status===200,data}}catch(err){return{success:!1,data:err?.message}}}async translateVideoYAImpl({videoData,requestLang=this.requestLang,responseLang=this.responseLang,translationHelp=null,headers={},extraOpts={},shouldSendFailedAudio=!0}){let{url,duration=_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.defaultDuration}=videoData,session=await this.getSession(`video-translation`),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeTranslationRequest(url,duration,requestLang,responseLang,translationHelp,extraOpts),path=this.paths.videoTranslation,vtransHeaders=await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.C0)(`Vtrans`,session,body,path),apiTokenHeader=extraOpts.useLivelyVoice?this.apiTokenHeader:{},res=await this.request(path,body,{...vtransHeaders,...apiTokenHeader,...headers});if(!res.success)throw new _src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__.n(`requestTranslationFailed`);let translationData=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.decodeTranslationResponse(res.data);_vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__.A.log(`translateVideo`,translationData);let{status,translationId}=translationData;switch(status){case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.FAILED:throw translationData?.message?new VOTJSError(`Yandex couldn't translate video`,translationData):new _src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__.n(`requestTranslationFailed`);case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.FINISHED:case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.PART_CONTENT:if(!translationData.url)throw new _src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__.n(`audioNotReceived`);return{translationId,translated:!0,url:translationData.url,status,remainingTime:translationData.remainingTime??-1};case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.WAITING:case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.LONG_WAITING:return{translationId,translated:!1,status,remainingTime:translationData.remainingTime};case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.AUDIO_REQUESTED:return url.startsWith(`https://youtu.be/`)&&shouldSendFailedAudio?(await this.requestVtransFailAudio(url),await this.requestVtransAudio(url,translationData.translationId,{audioFile:new Uint8Array,fileId:_types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.J.WEB_API_GET_ALL_GENERATING_URLS_DATA_FROM_IFRAME}),await this.translateVideoYAImpl({videoData,requestLang,responseLang,translationHelp,headers,shouldSendFailedAudio:!1})):{translationId,translated:!1,status,remainingTime:translationData.remainingTime??-1};case _types_yandex_js__WEBPACK_IMPORTED_MODULE_6__.v.SESSION_REQUIRED:throw new VOTJSError(`Yandex auth required to translate video. See docs for more info`,translationData);default:throw _vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__.A.error(`Unknown response`,translationData),new VOTJSError(`Unknown response from Yandex`,translationData)}}async translateVideoVOTImpl({url,videoId,service,requestLang=this.requestLang,responseLang=this.responseLang,headers={},provider=`yandex`}){let votData=(0,_utils_vot_js__WEBPACK_IMPORTED_MODULE_7__.p)(service,videoId,url),res=await this.requestVOT(this.paths.videoTranslation,{provider,service:votData.service,video_id:votData.videoId,from_lang:requestLang,to_lang:responseLang,raw_video:url},{...headers});if(!res.success)throw new _src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__.n(`requestTranslationFailed`);let translationData=res.data;switch(translationData.status){case`failed`:throw new VOTJSError(`Yandex couldn't translate video`,translationData);case`success`:if(!translationData.translated_url)throw new _src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__.n(`audioNotReceived`);return{translationId:String(translationData.id),translated:!0,url:translationData.translated_url,status:1,remainingTime:-1};case`waiting`:return{translationId:``,translated:!1,remainingTime:translationData.remaining_time,status:2,message:translationData.message}}}async requestVtransFailAudio(url){let res=await this.requestJSON(this.paths.videoTranslationFailAudio,JSON.stringify({video_url:url}),void 0,`PUT`);if(!res.data||typeof res.data==`string`||res.data.status!==1)throw new VOTJSError(`Failed to request to fake video translation fail audio js`,res);return res}async requestVtransAudio(url,translationId,audioBuffer,partialAudio,headers={}){let session=await this.getSession(`video-translation`),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.isPartialAudioBuffer(audioBuffer)?_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeTranslationAudioRequest(url,translationId,audioBuffer,partialAudio):_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeTranslationAudioRequest(url,translationId,audioBuffer,void 0),path=this.paths.videoTranslationAudio,vtransHeaders=await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.C0)(`Vtrans`,session,body,path),res=await this.request(path,body,{...vtransHeaders,...headers},`PUT`);if(!res.success)throw new VOTJSError(`Failed to request video translation audio`,res);return _protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.decodeTranslationAudioResponse(res.data)}async translateVideoCache({videoData,requestLang=this.requestLang,responseLang=this.responseLang,headers={}}){let{url,duration=_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.defaultDuration}=videoData,session=await this.getSession(`video-translation`),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeTranslationCacheRequest(url,duration,requestLang,responseLang),path=this.paths.videoTranslationCache,vtransHeaders=await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.C0)(`Vtrans`,session,body,path),res=await this.request(path,body,{...vtransHeaders,...headers},`POST`);if(!res.success)throw new VOTJSError(`Failed to request video translation cache`,res);return _protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.decodeTranslationCacheResponse(res.data)}async translateVideo({videoData,requestLang=this.requestLang,responseLang=this.responseLang,translationHelp=null,headers={},extraOpts={},shouldSendFailedAudio=!0}){let{url,videoId,host}=videoData;return this.isCustomLink(url)?await this.translateVideoVOTImpl({url,videoId,service:host,requestLang,responseLang,headers,provider:extraOpts.useLivelyVoice?`yandex_lively`:`yandex`}):await this.translateVideoYAImpl({videoData,requestLang,responseLang,translationHelp,headers,extraOpts,shouldSendFailedAudio})}async getSubtitlesYAImpl({videoData,requestLang=this.requestLang,headers={}}){let{url}=videoData,session=await this.getSession(`video-translation`),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeSubtitlesRequest(url,requestLang),path=this.paths.videoSubtitles,vsubsHeaders=await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.C0)(`Vsubs`,session,body,path),res=await this.request(path,body,{...vsubsHeaders,...headers});if(!res.success)throw new VOTJSError(`Failed to request video subtitles`,res);let subtitlesData=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.decodeSubtitlesResponse(res.data),subtitles=subtitlesData.subtitles.map(subtitle=>{let{language,url,translatedLanguage,translatedUrl}=subtitle;return{language,url,translatedLanguage,translatedUrl}});return{waiting:subtitlesData.waiting,subtitles}}async getSubtitlesVOTImpl({url,videoId,service,headers={}}){let votData=(0,_utils_vot_js__WEBPACK_IMPORTED_MODULE_7__.p)(service,videoId,url),res=await this.requestVOT(this.paths.videoSubtitles,{provider:`yandex`,service:votData.service,video_id:votData.videoId},headers);if(!res.success)throw new VOTJSError(`Failed to request video subtitles`,res);let subtitlesData=res.data,subtitles=subtitlesData.reduce((result,subtitle)=>{if(!subtitle.lang_from)return result;let originalSubtitle=subtitlesData.find(sub=>sub.lang===subtitle.lang_from);return originalSubtitle&&result.push({language:originalSubtitle.lang,url:originalSubtitle.subtitle_url,translatedLanguage:subtitle.lang,translatedUrl:subtitle.subtitle_url}),result},[]);return{waiting:!1,subtitles}}async getSubtitles({videoData,requestLang=this.requestLang,headers={}}){let{url,videoId,host}=videoData;return this.isCustomLink(url)?await this.getSubtitlesVOTImpl({url,videoId,service:host,headers}):await this.getSubtitlesYAImpl({videoData,requestLang,headers})}async pingStream({pingId,headers={}}){let session=await this.getSession(`video-translation`),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeStreamPingRequest(pingId),path=this.paths.streamPing,vtransHeaders=await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.C0)(`Vtrans`,session,body,path),res=await this.request(path,body,{...vtransHeaders,...headers});if(!res.success)throw new VOTJSError(`Failed to request stream ping`,res);return!0}async translateStream({videoData,requestLang=this.requestLang,responseLang=this.responseLang,headers={}}){let{url}=videoData;if(this.isCustomLink(url))throw new _src_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_8__.n(`VOTStreamNotSupportedUrl`);let session=await this.getSession(`video-translation`),body=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.encodeStreamRequest(url,requestLang,responseLang),path=this.paths.streamTranslation,vtransHeaders=await(0,_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_3__.C0)(`Vtrans`,session,body,path),res=await this.request(path,body,{...vtransHeaders,...headers});if(!res.success)throw new VOTJSError(`Failed to request stream translation`,res);let translateResponse=_protobuf_js__WEBPACK_IMPORTED_MODULE_5__.S.decodeStreamResponse(res.data),interval=translateResponse.interval;switch(interval){case _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_2__.q8.NO_CONNECTION:case _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_2__.q8.TRANSLATING:return{translated:!1,interval,message:interval===_vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_2__.q8.NO_CONNECTION?`streamNoConnectionToServer`:`translationTakeFewMinutes`};case _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_2__.q8.STREAMING:return{translated:!0,interval,pingId:translateResponse.pingId,result:translateResponse.translatedInfo};default:throw _vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__.A.error(`Unknown response`,translateResponse),new VOTJSError(`Unknown response from Yandex`,translateResponse)}}}class VOTWorkerClient extends VOTClient{constructor(opts={}){opts.host=opts.host??_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_0__.A.hostWorker,super(opts)}async request(path,body,headers={},method=`POST`){let options=this.getOpts(JSON.stringify({headers:{...this.headers,...headers},body:Array.from(body)}),{"Content-Type":`application/json`},method);try{let res=await this.fetch(`${this.schema}://${this.host}${path}`,options),data=await res.arrayBuffer();return{success:res.status===200,data}}catch(err){return{success:!1,data:err?.message}}}async requestJSON(path,body=null,headers={},method=`POST`){let options=this.getOpts(JSON.stringify({headers:{...this.headers,"Content-Type":`application/json`,Accept:`application/json`,...headers},body}),{Accept:`application/json`,"Content-Type":`application/json`},method);try{let res=await this.fetch(`${this.schema}://${this.host}${path}`,options),data=await res.json();return{success:res.status===200,data}}catch(err){return{success:!1,data:err?.message}}}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./node_modules/@vot.js/core/dist/protobuf.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{P:()=>YandexSessionProtobuf,S:()=>YandexVOTProtobuf});var _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/protos/yandex.js`);class YandexVOTProtobuf{static encodeTranslationRequest(url,duration,requestLang,responseLang,translationHelp,{forceSourceLang=!1,wasStream=!1,videoTitle=``,bypassCache=!1,useLivelyVoice=!1}={}){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.yy.encode({url,firstRequest:!0,duration,unknown0:1,language:requestLang,forceSourceLang,unknown1:0,translationHelp:translationHelp??[],responseLanguage:responseLang,wasStream,unknown2:1,unknown3:2,bypassCache,useLivelyVoice,videoTitle}).finish()}static decodeTranslationResponse(response){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.AJ.decode(new Uint8Array(response))}static encodeTranslationCacheRequest(url,duration,requestLang,responseLang){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.Yx.encode({url,duration,language:requestLang,responseLanguage:responseLang}).finish()}static decodeTranslationCacheResponse(response){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.ZK.decode(new Uint8Array(response))}static isPartialAudioBuffer(audioBuffer){return`chunkId`in audioBuffer}static encodeTranslationAudioRequest(url,translationId,audioBuffer,partialAudio){return partialAudio&&YandexVOTProtobuf.isPartialAudioBuffer(audioBuffer)?_vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.Y7.encode({url,translationId,partialAudioInfo:{...partialAudio,audioBuffer}}).finish():_vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.Y7.encode({url,translationId,audioInfo:audioBuffer}).finish()}static decodeTranslationAudioResponse(response){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.Wi.decode(new Uint8Array(response))}static encodeSubtitlesRequest(url,requestLang){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.P4.encode({url,language:requestLang}).finish()}static decodeSubtitlesResponse(response){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.LD.decode(new Uint8Array(response))}static encodeStreamPingRequest(pingId){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.kO.encode({pingId}).finish()}static encodeStreamRequest(url,requestLang,responseLang){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.Xv.encode({url,language:requestLang,responseLanguage:responseLang,unknown0:1,unknown1:0}).finish()}static decodeStreamResponse(response){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.n_.decode(new Uint8Array(response))}}class YandexSessionProtobuf{static encodeSessionRequest(uuid,module){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.ls.encode({uuid,module}).finish()}static decodeSessionResponse(response){return _vot_js_shared_protos__WEBPACK_IMPORTED_MODULE_0__.Bv.decode(new Uint8Array(response))}}},"./node_modules/@vot.js/core/dist/types/service.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>VideoService});var VideoService;(function(VideoService){VideoService.custom=`custom`,VideoService.directlink=`custom`,VideoService.youtube=`youtube`,VideoService.piped=`piped`,VideoService.invidious=`invidious`,VideoService.vk=`vk`,VideoService.nine_gag=`nine_gag`,VideoService.gag=`nine_gag`,VideoService.twitch=`twitch`,VideoService.proxitok=`proxitok`,VideoService.tiktok=`tiktok`,VideoService.vimeo=`vimeo`,VideoService.xvideos=`xvideos`,VideoService.pornhub=`pornhub`,VideoService.twitter=`twitter`,VideoService.x=`twitter`,VideoService.rumble=`rumble`,VideoService.facebook=`facebook`,VideoService.rutube=`rutube`,VideoService.coub=`coub`,VideoService.bilibili=`bilibili`,VideoService.mail_ru=`mailru`,VideoService.mailru=`mailru`,VideoService.bitchute=`bitchute`,VideoService.eporner=`eporner`,VideoService.peertube=`peertube`,VideoService.dailymotion=`dailymotion`,VideoService.trovo=`trovo`,VideoService.yandexdisk=`yandexdisk`,VideoService.ok_ru=`okru`,VideoService.okru=`okru`,VideoService.googledrive=`googledrive`,VideoService.bannedvideo=`bannedvideo`,VideoService.weverse=`weverse`,VideoService.newgrounds=`newgrounds`,VideoService.egghead=`egghead`,VideoService.youku=`youku`,VideoService.archive=`archive`,VideoService.kodik=`kodik`,VideoService.patreon=`patreon`,VideoService.reddit=`reddit`,VideoService.kick=`kick`,VideoService.apple_developer=`apple_developer`,VideoService.appledeveloper=`apple_developer`,VideoService.poketube=`poketube`,VideoService.epicgames=`epicgames`,VideoService.odysee=`odysee`,VideoService.coursehunterLike=`coursehunterLike`,VideoService.sap=`sap`,VideoService.watchpornto=`watchpornto`,VideoService.linkedin=`linkedin`,VideoService.ricktube=`ricktube`,VideoService.incestflix=`incestflix`,VideoService.porntn=`porntn`,VideoService.dzen=`dzen`,VideoService.cloudflarestream=`cloudflarestream`,VideoService.loom=`loom`,VideoService.rtnews=`rtnews`,VideoService.bitview=`bitview`,VideoService.thisvid=`thisvid`,VideoService.ign=`ign`,VideoService.bunkr=`bunkr`,VideoService.imdb=`imdb`,VideoService.telegram=`telegram`})(VideoService||={})},"./node_modules/@vot.js/core/dist/types/yandex.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{J:()=>AudioDownloadType,v:()=>VideoTranslationStatus});var VideoTranslationStatus;(function(VideoTranslationStatus){VideoTranslationStatus[VideoTranslationStatus.FAILED=0]=`FAILED`,VideoTranslationStatus[VideoTranslationStatus.FINISHED=1]=`FINISHED`,VideoTranslationStatus[VideoTranslationStatus.WAITING=2]=`WAITING`,VideoTranslationStatus[VideoTranslationStatus.LONG_WAITING=3]=`LONG_WAITING`,VideoTranslationStatus[VideoTranslationStatus.PART_CONTENT=5]=`PART_CONTENT`,VideoTranslationStatus[VideoTranslationStatus.AUDIO_REQUESTED=6]=`AUDIO_REQUESTED`,VideoTranslationStatus[VideoTranslationStatus.SESSION_REQUIRED=7]=`SESSION_REQUIRED`})(VideoTranslationStatus||={});var AudioDownloadType;(function(AudioDownloadType){AudioDownloadType.WEB_API_VIDEO_SRC_FROM_IFRAME=`web_api_video_src_from_iframe`,AudioDownloadType.WEB_API_VIDEO_SRC=`web_api_video_src`,AudioDownloadType.WEB_API_GET_ALL_GENERATING_URLS_DATA_FROM_IFRAME=`web_api_get_all_generating_urls_data_from_iframe`,AudioDownloadType.WEB_API_GET_ALL_GENERATING_URLS_DATA_FROM_IFRAME_TMP_EXP=`web_api_get_all_generating_urls_data_from_iframe_tmp_exp`,AudioDownloadType.WEB_API_REPLACED_FETCH_INSIDE_IFRAME=`web_api_replaced_fetch_inside_iframe`,AudioDownloadType.ANDROID_API=`android_api`,AudioDownloadType.WEB_API_SLOW=`web_api_slow`,AudioDownloadType.WEB_API_STEAL_SIG_AND_N=`web_api_steal_sig_and_n`,AudioDownloadType.WEB_API_COMBINED=`web_api_get_all_generating_urls_data_from_iframe,web_api_steal_sig_and_n`})(AudioDownloadType||={})},"./node_modules/@vot.js/core/dist/utils/videoData.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>localLinkRe,A:()=>VideoDataError});class VideoDataError extends Error{constructor(message){super(message),this.name=`VideoDataError`,this.message=message}}let localLinkRe=/(file:\/\/(\/)?|(http(s)?:\/\/)(127\.0\.0\.1|localhost|192\.168\.(\d){1,3}\.(\d){1,3}))/},"./node_modules/@vot.js/core/dist/utils/vot.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{p:()=>convertVOT});var _types_service_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/service.js`);function convertVOT(service,videoId,url){return service===_types_service_js__WEBPACK_IMPORTED_MODULE_0__.r.patreon?{service:`mux`,videoId:new URL(url).pathname.slice(1)}:{service,videoId}}},"./node_modules/@vot.js/ext/dist/client.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>VOTClient,P:()=>VOTWorkerClient});var _vot_js_core_client__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/client.js`),_vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/shared/dist/secure.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_vot_js_core_client__WEBPACK_IMPORTED_MODULE_0__]);_vot_js_core_client__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class VOTClient extends _vot_js_core_client__WEBPACK_IMPORTED_MODULE_0__.Ay{constructor(opts){super(opts),this.headers={..._vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_1__.MG,...this.headers}}}class VOTWorkerClient extends _vot_js_core_client__WEBPACK_IMPORTED_MODULE_0__.Pu{constructor(opts){super(opts),this.headers={..._vot_js_shared_secure__WEBPACK_IMPORTED_MODULE_1__.MG,...this.headers}}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./node_modules/@vot.js/ext/dist/data/sites.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/service.js`),_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/alternativeUrls.js`),_types_service_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/ext/dist/types/service.js`);let __WEBPACK_DEFAULT_EXPORT__=[{additionalData:`mobile`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.youtube,url:`https://youtu.be/`,match:/^m.youtube.com$/,selector:`.player-container`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.youtube,url:`https://youtu.be/`,match:/^(www.)?youtube(-nocookie|kids)?.com$/,selector:`.html5-video-container:not(#inline-player *)`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.invidious,url:`https://youtu.be/`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.Xm,selector:`#player`,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.piped,url:`https://youtu.be/`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.Jo,selector:`.shaka-video-container`,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.poketube,url:`https://youtu.be/`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.sx,selector:`.video-player-container`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.ricktube,url:`https://youtu.be/`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.My,selector:`#oframeplayer > pjsdiv:has(video)`},{additionalData:`mobile`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.vk,url:`https://vk.com/video?z=`,match:[/^m.vk.(com|ru)$/,/^m.vkvideo.ru$/],selector:`vk-video-player`,shadowRoot:!0,needExtraData:!0},{additionalData:`clips`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.vk,url:`https://vk.com/video?z=`,match:/^(www.|m.)?vk.(com|ru)$/,selector:`div[data-testid="clipcontainer-video"]`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.vk,url:`https://vk.com/video?z=`,match:[/^(www.|m.)?vk.(com|ru)$/,/^(www.|m.)?vkvideo.ru$/],selector:`.videoplayer_media`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.nine_gag,url:`https://9gag.com/gag/`,match:/^9gag.com$/,selector:`.video-post`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.twitch,url:`https://twitch.tv/`,match:[/^m.twitch.tv$/,/^(www.)?twitch.tv$/,/^clips.twitch.tv$/,/^player.twitch.tv$/],needExtraData:!0,selector:`.video-ref, main > div > section > div > div > div`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.proxitok,url:`https://www.tiktok.com/`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.TP,selector:`.column.has-text-centered`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.tiktok,url:`https://www.tiktok.com/`,match:/^(www.)?tiktok.com$/,selector:null},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.douyin,url:`https://www.douyin.com/`,match:/^(www.)?douyin.com/,selector:`.xg-video-container`,needExtraData:!0,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.vimeo,url:`https://vimeo.com/`,match:/^vimeo.com$/,needExtraData:!0,selector:`.player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.vimeo,url:`https://player.vimeo.com/`,match:/^player.vimeo.com$/,additionalData:`embed`,needExtraData:!0,needBypassCSP:!0,selector:`.player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.xvideos,url:`https://www.xvideos.com/`,match:[/^(www.)?xvideos(-ar)?.com$/,/^(www.)?xvideos(\d\d\d).com$/,/^(www.)?xv-ru.com$/],selector:`#hlsplayer`,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.pornhub,url:`https://rt.pornhub.com/view_video.php?viewkey=`,match:/^[a-z]+.pornhub.(com|org)$/,selector:`.mainPlayerDiv > .video-element-wrapper-js > div`,eventSelector:`.mgp_eventCatcher`},{additionalData:`embed`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.pornhub,url:`https://rt.pornhub.com/view_video.php?viewkey=`,match:url=>/^[a-z]+.pornhub.(com|org)$/.exec(url.host)&&url.pathname.startsWith(`/embed/`),selector:`#player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.twitter,url:`https://twitter.com/i/status/`,match:/^(twitter|x).com$/,selector:`div[data-testid="videoComponent"] > div:nth-child(1) > div`,eventSelector:`div[data-testid="videoPlayer"]`,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.rumble,url:`https://rumble.com/`,match:/^rumble.com$/,selector:`#videoPlayer > .videoPlayer-Rumble-cls > div`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.facebook,url:`https://facebook.com/`,match:url=>url.host.includes(`facebook.com`)&&url.pathname.includes(`/videos/`),selector:`div[role="main"] div[data-pagelet$="video" i]`,needBypassCSP:!0},{additionalData:`reels`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.facebook,url:`https://facebook.com/`,match:url=>url.host.includes(`facebook.com`)&&url.pathname.includes(`/reel/`),selector:`div[role="main"]`,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.rutube,url:`https://rutube.ru/video/`,match:/^rutube.ru$/,selector:`.video-player > div > div > div:nth-child(2)`},{additionalData:`embed`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.rutube,url:`https://rutube.ru/video/`,match:/^rutube.ru$/,selector:`#app > div > div`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.bilibili,url:`https://www.bilibili.com/`,match:/^(www|m|player).bilibili.com$/,selector:`.bpx-player-video-wrap`},{additionalData:`old`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.bilibili,url:`https://www.bilibili.com/`,match:/^(www|m).bilibili.com$/,selector:null},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.mailru,url:`https://my.mail.ru/`,match:/^my.mail.ru$/,selector:`#b-video-wrapper`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.bitchute,url:`https://www.bitchute.com/video/`,match:/^(www.)?bitchute.com$/,selector:`.video-js`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.eporner,url:`https://www.eporner.com/`,match:/^(www.)?eporner.com$/,selector:`.vjs-v7`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.peertube,url:`stub`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.fV,selector:`.vjs-v7`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.dailymotion,url:`https://dai.ly/`,match:/^geo([\d]+)?.dailymotion.com$/,selector:`.player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.trovo,url:`https://trovo.live/s/`,match:/^trovo.live$/,selector:`.player-video`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.yandexdisk,url:`https://yadi.sk/`,match:/^disk.yandex.(ru|kz|com(\.(am|ge|tr))?|by|az|co\.il|ee|lt|lv|md|net|tj|tm|uz)$/,selector:`.video-player__player > div:nth-child(1)`,eventSelector:`.video-player__player`,needBypassCSP:!0,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.okru,url:`https://ok.ru/video/`,match:/^ok.ru$/,selector:`vk-video-player`,shadowRoot:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.googledrive,url:`https://drive.google.com/file/d/`,match:/^youtube.googleapis.com$/,selector:`.html5-video-container`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.bannedvideo,url:`https://madmaxworld.tv/watch?id=`,match:/^(www.)?banned.video|madmaxworld.tv$/,selector:`.vjs-v7`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.weverse,url:`https://weverse.io/`,match:/^weverse.io$/,selector:`.webplayer-internal-source-wrapper`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.newgrounds,url:`https://www.newgrounds.com/`,match:/^(www.)?newgrounds.com$/,selector:`.ng-video-player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.egghead,url:`https://egghead.io/`,match:/^egghead.io$/,selector:`.cueplayer-react-video-holder`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.youku,url:`https://v.youku.com/`,match:/^v.youku.com$/,selector:`#ykPlayer`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.archive,url:`https://archive.org/details/`,match:/^archive.org$/,selector:`.jw-media`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.kodik,url:`stub`,match:/^kodik.(info|biz|cc)$/,selector:`.fp-player`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.patreon,url:`stub`,match:/^(www.)?patreon.com$/,selector:`div[data-tag="post-card"] div[elevation="subtle"] > div > div > div > div`,needExtraData:!0},{additionalData:`old`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.reddit,url:`stub`,match:/^old.reddit.com$/,selector:`.reddit-video-player-root`,needExtraData:!0,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.reddit,url:`stub`,match:/^(www.|new.)?reddit.com$/,selector:`div[slot=post-media-container]`,shadowRoot:!0,needExtraData:!0,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.kick,url:`https://kick.com/`,match:/^kick.com$/,selector:`#injected-embedded-channel-player-video > div`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.appledeveloper,url:`https://developer.apple.com/`,match:/^developer.apple.com$/,selector:`.developer-video-player`,needExtraData:!0,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.epicgames,url:`https://dev.epicgames.com/community/learning/`,match:/^dev.epicgames.com$/,selector:`.vjs-v7`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.odysee,url:`stub`,match:/^odysee.com$/,selector:`.vjs-v7`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.coursehunterLike,url:`stub`,match:_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_2__.r,selector:`#oframeplayer > pjsdiv:has(video)`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.sap,url:`https://learning.sap.com/courses/`,match:/^learning.sap.com$/,selector:`.playkit-container`,eventSelector:`.playkit-player`,needExtraData:!0,needBypassCSP:!0},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.udemy,url:`https://www.udemy.com/`,match:/udemy.com$/,selector:`div[data-purpose="curriculum-item-viewer-content"] > section > div > div > div > div:nth-of-type(2)`,needExtraData:!0},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.coursera,url:`https://www.coursera.org/`,match:/coursera.org$/,selector:`.vjs-v8`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.watchpornto,url:`https://watchporn.to/`,match:/^watchporn.to$/,selector:`.fp-player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.linkedin,url:`https://www.linkedin.com/learning/`,match:/^(www.)?linkedin.com$/,selector:`.vjs-v7`,needExtraData:!0,needBypassCSP:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.incestflix,url:`https://www.incestflix.net/watch/`,match:/^(www.)?incestflix.(net|to|com)$/,selector:`#incflix-stream`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.porntn,url:`https://porntn.com/videos/`,match:/^porntn.com$/,selector:`.fp-player`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.dzen,url:`https://dzen.ru/video/watch/`,match:/^dzen.ru$/,selector:`.zen-ui-video-video-player`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.cloudflarestream,url:`stub`,match:/^(watch|embed|iframe|customer-[^.]+).cloudflarestream.com$/,selector:null},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.loom,url:`https://www.loom.com/share/`,match:/^(www.)?loom.com$/,selector:`.VideoLayersContainer`,needExtraData:!0,needBypassCSP:!0},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.artstation,url:`https://www.artstation.com/learning/`,match:/^(www.)?artstation.com$/,selector:`.vjs-v7`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.rtnews,url:`https://www.rt.com/`,match:/^(www.)?rt.com$/,selector:`.jw-media`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.bitview,url:`https://www.bitview.net/watch?v=`,match:/^(www.)?bitview.net$/,selector:`.vlScreen`,needExtraData:!0},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.kickstarter,url:`https://www.kickstarter.com/`,match:/^(www.)?kickstarter.com/,selector:`.ksr-video-player`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.thisvid,url:`https://thisvid.com/`,match:/^(www.)?thisvid.com$/,selector:`.fp-player`},{additionalData:`regional`,host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.ign,url:`https://de.ign.com/`,match:/^(\w{2}.)?ign.com$/,needExtraData:!0,selector:`.video-container`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.ign,url:`https://www.ign.com/`,match:/^(www.)?ign.com$/,selector:`.player`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.bunkr,url:`https://bunkr.site/`,match:/^bunkr\.(site|black|cat|media|red|site|ws|org|s[kiu]|c[ir]|fi|p[hks]|ru|la|is|to|a[cx])$/,needExtraData:!0,selector:`.plyr__video-wrapper`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.imdb,url:`https://www.imdb.com/video/`,match:/^(www\.)?imdb\.com$/,selector:`.jw-media`},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.telegram,url:`https://t.me/`,match:url=>/^web\.telegram\.org$/.test(url.hostname)&&url.pathname.startsWith(`/k`),selector:`.ckin__player`},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.oraclelearn,url:`https://mylearn.oracle.com/ou/course/`,match:/^mylearn\.oracle\.com/,selector:`.vjs-v7`,needExtraData:!0,needBypassCSP:!0},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.deeplearningai,url:`https://learn.deeplearning.ai/courses/`,match:/^learn(-dev|-staging)?\.deeplearning\.ai/,selector:`.lesson-video-player`,needExtraData:!0},{host:_types_service_js__WEBPACK_IMPORTED_MODULE_1__.Q.netacad,url:`https://www.netacad.com/`,match:/^(www\.)?netacad\.com/,selector:`.vjs-v8`,needExtraData:!0},{host:_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.custom,url:`stub`,match:url=>/([^.]+)\.(mp4|webm)/.test(url.pathname),rawResult:!0}]},"./node_modules/@vot.js/ext/dist/helpers/base.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>VideoHelperError,q:()=>BaseHelper});var _vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/utils.js`);class VideoHelperError extends Error{constructor(message){super(message),this.name=`VideoHelper`,this.message=message}}class BaseHelper{API_ORIGIN=window.location.origin;fetch;extraInfo;referer;origin;service;video;language;constructor({fetchFn=_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_0__.u9,extraInfo=!0,referer=document.referrer??`${window.location.origin}/`,origin=window.location.origin,service,video,language=`en`}={}){this.fetch=fetchFn,this.extraInfo=extraInfo,this.referer=referer,this.origin=/^(http(s)?):\/\//.test(String(origin))?origin:window.location.origin,this.service=service,this.video=video,this.language=language}async getVideoData(_videoId){}async getVideoId(_url){}returnBaseData(videoId){if(this.service)return{url:this.service.url+videoId,videoId,host:this.service.host,duration:void 0}}}},"./node_modules/@vot.js/ext/dist/helpers/index.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{JW:()=>availableHelpers,Ay:()=>VideoHelper});var service=__webpack_require__(`./node_modules/@vot.js/core/dist/types/service.js`),types_service=__webpack_require__(`./node_modules/@vot.js/ext/dist/types/service.js`),base=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/base.js`),logger=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/logger.js`);class AppleDeveloperHelper extends base.q{API_ORIGIN=`https://developer.apple.com`;async getVideoData(videoId){try{let contentUrl=document.querySelector(`meta[property='og:video']`)?.content;if(!contentUrl)throw new base.a(`Failed to find content url`);return{url:contentUrl}}catch(err){logger.A.error(`Failed to get apple developer video data by video ID: ${videoId}`,err.message);return}}async getVideoId(url){return/videos\/play\/([^/]+)\/([\d]+)/.exec(url.pathname)?.[0]}}class ArchiveHelper extends base.q{async getVideoId(url){return/(details|embed)\/([^/]+)/.exec(url.pathname)?.[2]}}var utils=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/utils.js`);class ArtstationHelper extends base.q{API_ORIGIN=`https://www.artstation.com/api/v2/learning`;getCSRFToken(){return document.querySelector(`meta[name="public-csrf-token"]`)?.content}async getCourseInfo(courseId){try{let res=await this.fetch(`${this.API_ORIGIN}/courses/${courseId}/autoplay.json`,{method:`POST`,headers:{"PUBLIC-CSRF-TOKEN":this.getCSRFToken()}});return await res.json()}catch(err){return logger.A.error(`Failed to get artstation course info by courseId: ${courseId}.`,err.message),!1}}async getVideoUrl(chapterId){try{let res=await this.fetch(`${this.API_ORIGIN}/quicksilver/video_url.json?chapter_id=${chapterId}`),data=await res.json();return data.url.replace(`qsep://`,`https://`)}catch(err){return logger.A.error(`Failed to get artstation video url by chapterId: ${chapterId}.`,err.message),!1}}async getVideoData(videoId){let[,courseId,,,chapterId]=videoId.split(`/`),courseInfo=await this.getCourseInfo(courseId);if(!courseInfo)return;let chapter=courseInfo.chapters.find(chapter=>chapter.hash_id===chapterId);if(!chapter)return;let videoUrl=await this.getVideoUrl(chapter.id);if(!videoUrl)return;let{title,duration,subtitles:videoSubtitles}=chapter,subtitles=videoSubtitles.filter(subtitle=>subtitle.format===`vtt`).map(subtitle=>({language:(0,utils.ec)(subtitle.locale),source:`artstation`,format:`vtt`,url:subtitle.file_url}));return{url:videoUrl,title,duration,subtitles}}async getVideoId(url){return/courses\/(\w{3,5})\/([^/]+)\/chapters\/(\w{3,5})/.exec(url.pathname)?.[0]}}class BannedVideoHelper extends base.q{API_ORIGIN=`https://api.banned.video`;async getVideoInfo(videoId){try{let res=await this.fetch(`${this.API_ORIGIN}/graphql`,{method:`POST`,body:JSON.stringify({operationName:`GetVideo`,query:`query GetVideo($id: String!) {
            getVideo(id: $id) {
              title
              description: summary
              duration: videoDuration
              videoUrl: directUrl
              isStream: live
            }
          }`,variables:{id:videoId}}),headers:{"User-Agent":`bannedVideoFrontEnd`,"apollographql-client-name":`banned-web`,"apollographql-client-version":`1.3`,"content-type":`application/json`}});return await res.json()}catch(err){return console.error(`Failed to get bannedvideo video info by videoId: ${videoId}.`,err.message),!1}}async getVideoData(videoId){let videoInfo=await this.getVideoInfo(videoId);if(!videoInfo)return;let{videoUrl,duration,isStream,description,title}=videoInfo.data.getVideo;return{url:videoUrl,duration,isStream,title,description}}async getVideoId(url){return url.searchParams.get(`id`)??void 0}}class BilibiliHelper extends base.q{async getVideoId(url){let bangumiId=/bangumi\/play\/([^/]+)/.exec(url.pathname)?.[0];if(bangumiId)return bangumiId;let bvid=url.searchParams.get(`bvid`);if(bvid)return`video/${bvid}`;let vid=/video\/([^/]+)/.exec(url.pathname)?.[0];return vid&&url.searchParams.get(`p`)!==null&&(vid+=`/?p=${url.searchParams.get(`p`)}`),vid}}class BitchuteHelper extends base.q{async getVideoId(url){return/(video|embed)\/([^/]+)/.exec(url.pathname)?.[2]}}class BitviewHelper extends base.q{async getVideoData(videoId){try{let videoUrl=document.querySelector(`.vlScreen > video`)?.src;if(!videoUrl)throw new base.a(`Failed to find video URL`);return{url:videoUrl}}catch(err){logger.A.error(`Failed to get Bitview data by videoId: ${videoId}`,err.message);return}}async getVideoId(url){return url.searchParams.get(`v`)}}class BunkrHelper extends base.q{async getVideoData(_videoId){let url=document.querySelector(`#player > source[type="video/mp4"]`)?.src;if(url)return{url}}async getVideoId(url){return/\/f\/([^/]+)/.exec(url.pathname)?.[1]}}class CloudflareStreamHelper extends base.q{async getVideoId(url){return url.pathname+url.search}}class CoursehunterLikeHelper extends base.q{API_ORIGIN=this.origin??`https://coursehunter.net`;async getCourseId(){let courseId=window.course_id;return courseId===void 0?document.querySelector(`input[name="course_id"]`)?.value:String(courseId)}async getLessonsData(courseId){let lessons=window.lessons;if(lessons?.length)return lessons;try{let res=await this.fetch(`${this.API_ORIGIN}/api/v1/course/${courseId}/lessons`);return await res.json()}catch(err){logger.A.error(`Failed to get CoursehunterLike lessons data by courseId: ${courseId}, because ${err.message}`);return}}getLessondId(videoId){let lessondId=videoId.split(`?lesson=`)?.[1];if(lessondId)return+lessondId;let activeLessondEl=document.querySelector(`.lessons-item_active`);return lessondId=activeLessondEl?.dataset?.index,lessondId?+lessondId:1}async getVideoData(videoId){let courseId=await this.getCourseId();if(!courseId)return;let lessonsData=await this.getLessonsData(courseId);if(!lessonsData)return;let lessonId=this.getLessondId(videoId),currentLesson=lessonsData?.[lessonId-1],{file:videoUrl,duration,title}=currentLesson;if(videoUrl)return{url:(0,utils.fl)(videoUrl),duration,title}}async getVideoId(url){let courseId=/course\/([^/]+)/.exec(url.pathname)?.[0];return courseId?courseId+url.search:void 0}}class VideoJSHelper extends base.q{SUBTITLE_SOURCE=`videojs`;SUBTITLE_FORMAT=`vtt`;static getPlayer(){return document.querySelector(`.video-js`)?.player}getVideoDataByPlayer(videoId){try{let player=VideoJSHelper.getPlayer();if(!player)throw Error(`Video player doesn't have player option, videoId ${videoId}`);let duration=player.duration(),sources=Array.isArray(player.currentSources)?player.currentSources:player.getCache()?.sources,{tracks_:tracks}=player.textTracks(),videoUrl=sources.find(source=>source.type===`video/mp4`||source.type===`video/webm`);if(!videoUrl)throw Error(`Failed to find video url for videoID ${videoId}`);let subtitles=tracks.filter(track=>track.src&&track.kind!==`metadata`).map(track=>({language:(0,utils.ec)(track.language),source:this.SUBTITLE_SOURCE,format:this.SUBTITLE_FORMAT,url:track.src}));return{url:videoUrl.src,duration,subtitles}}catch(err){logger.A.error(`Failed to get videojs video data`,err.message);return}}}var consts=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/consts.js`);class CourseraHelper extends VideoJSHelper{API_ORIGIN=`https://www.coursera.org/api`;SUBTITLE_SOURCE=`coursera`;async getCourseData(courseId){try{let response=await this.fetch(`${this.API_ORIGIN}/onDemandCourses.v1/${courseId}`),resJSON=await response.json();return resJSON?.elements?.[0]}catch(err){logger.A.error(`Failed to get course data by courseId: ${courseId}`,err.message);return}}static getPlayer(){return VideoJSHelper.getPlayer()}async getVideoData(videoId){let data=this.getVideoDataByPlayer(videoId);if(!data)return;let{options_:options}=CourseraHelper.getPlayer()??{};!data.subtitles?.length&&options&&(data.subtitles=options.tracks.map(track=>({url:track.src,language:(0,utils.ec)(track.srclang),source:this.SUBTITLE_SOURCE,format:this.SUBTITLE_FORMAT})));let courseId=options?.courseId;if(!courseId)return data;let courseLang=`en`,courseData=await this.getCourseData(courseId);if(courseData){let{primaryLanguageCodes:[primaryLangauge]}=courseData;courseLang=primaryLangauge?(0,utils.ec)(primaryLangauge):`en`}consts.xm.includes(courseLang)||(courseLang=`en`);let subtitleItem=data.subtitles.find(subtitle=>subtitle.language===courseLang)??data.subtitles?.[0],subtitleUrl=subtitleItem?.url;subtitleUrl||logger.A.warn(`Failed to find any subtitle file`);let{url,duration}=data,translationHelp=subtitleUrl?[{target:`subtitles_file_url`,targetUrl:subtitleUrl},{target:`video_file_url`,targetUrl:url}]:null;return{...subtitleUrl?{url:this.service?.url+videoId,translationHelp}:{url,translationHelp},detectedLanguage:courseLang,duration}}async getVideoId(url){let matched=/learn\/([^/]+)\/lecture\/([^/]+)/.exec(url.pathname)??/lecture\/([^/]+)\/([^/]+)/.exec(url.pathname);return matched?.[0]}}class DailymotionHelper extends base.q{async getVideoId(_url){let plainPlayerConfig=Array.from(document.querySelectorAll(`*`)).filter(s=>s.innerHTML.trim().includes(`.m3u8`)),videoUrl=plainPlayerConfig?.[1]?.lastChild?.src;return videoUrl?/\/video\/(\w+)\.m3u8/.exec(videoUrl)?.[1]:void 0}}class DeeplearningAIHelper extends base.q{async getVideoData(_videoId){if(!this.video)return;let sourceUrl=this.video.querySelector(`source[type="application/x-mpegurl"]`)?.src;if(sourceUrl)return{url:sourceUrl}}async getVideoId(url){return/courses\/(([^/]+)\/lesson\/([^/]+)\/([^/]+))/.exec(url.pathname)?.[1]}}class DouyinHelper extends base.q{static getPlayer(){if(!(typeof player>`u`))return player}async getVideoData(_videoId){let xgPlayer=DouyinHelper.getPlayer();if(!xgPlayer)return;let{config:{url:sources,duration,lang,isLive:isStream}}=xgPlayer;if(!sources)return;let source=sources.find(s=>s.src.includes(`www.douyin.com/aweme/v1/play/`));if(source)return{url:(0,utils.fl)(source.src),duration,isStream,...consts.xm.includes(lang)?{detectedLanguage:lang}:{}}}async getVideoId(url){let pathId=/video\/([\d]+)/.exec(url.pathname)?.[0];return pathId||DouyinHelper.getPlayer()?.config.vid}}class DzenHelper extends base.q{async getVideoId(url){return/video\/watch\/([^/]+)/.exec(url.pathname)?.[1]}}class EggheadHelper extends base.q{async getVideoId(url){return url.pathname.slice(1)}}class EpicGamesHelper extends base.q{API_ORIGIN=`https://dev.epicgames.com/community/api/learning`;async getPostInfo(videoId){try{let res=await this.fetch(`${this.API_ORIGIN}/post.json?hash_id=${videoId}`);return await res.json()}catch(err){return logger.A.error(`Failed to get epicgames post info by videoId: ${videoId}.`,err.message),!1}}getVideoBlock(){let videoUrlRe=/videoUrl\s?=\s"([^"]+)"?/,script=Array.from(document.body.querySelectorAll(`script`)).find(s=>videoUrlRe.exec(s.innerHTML));if(!script)return;let content=script.innerHTML.trim(),playlistUrl=videoUrlRe.exec(content)?.[1]?.replace(`qsep://`,`https://`);if(!playlistUrl)return;let subtitlesString=/sources\s?=\s(\[([^\]]+)\])?/.exec(content)?.[1];if(!subtitlesString)return{playlistUrl,subtitles:[]};try{subtitlesString=(subtitlesString.replace(/src:(\s)+?(videoUrl)/g,`src:"removed"`).substring(0,subtitlesString.lastIndexOf(`},`))+`]`).split(`
`).map(line=>line.replace(/([^\s]+):\s?(?!.*\1)/,`"$1":`)).join(`
`);let subtitlesObj=JSON.parse(subtitlesString),subtitles=subtitlesObj.filter(sub=>sub.type===`captions`);return{playlistUrl,subtitles}}catch{return{playlistUrl,subtitles:[]}}}async getVideoData(videoId){let courseId=videoId.split(`:`)?.[1],postInfo=await this.getPostInfo(courseId);if(!postInfo)return;let videoBlock=this.getVideoBlock();if(!videoBlock)return;let{playlistUrl,subtitles:videoSubtitles}=videoBlock,{title,description}=postInfo,subtitles=videoSubtitles.map(caption=>({language:(0,utils.ec)(caption.srclang),source:`epicgames`,format:`vtt`,url:caption.src}));return{url:playlistUrl,title,description,subtitles}}async getVideoId(_url){return new Promise(resolve=>{let origin=`https://dev.epicgames.com`,reqId=btoa(window.location.href);window.addEventListener(`message`,e=>{if(e.origin!==origin||!(typeof e.data==`string`&&e.data.startsWith(`getVideoId:`)))return;let videoId=e.data.replace(`getVideoId:`,``);return resolve(videoId)}),window.top.postMessage(`getVideoId:${reqId}`,origin)})}}class EpornerHelper extends base.q{async getVideoId(url){return/video-([^/]+)\/([^/]+)/.exec(url.pathname)?.[0]}}class FacebookHelper extends base.q{async getVideoId(url){return url.pathname.slice(1)}}class GoogleDriveHelper extends base.q{getPlayerData(){let playerEl=document.querySelector(`#movie_player`);return playerEl?.getVideoData?.call()??void 0}async getVideoId(_url){return this.getPlayerData()?.video_id}}var videoData=__webpack_require__(`./node_modules/@vot.js/core/dist/utils/videoData.js`);class IgnHelper extends base.q{getVideoDataBySource(videoId){let url=document.querySelector(`.icms.video > source[type="video/mp4"][data-quality="360"]`)?.src;return url?{url:(0,utils.fl)(url)}:this.returnBaseData(videoId)}getVideoDataByNext(videoId){try{let nextContent=document.getElementById(`__NEXT_DATA__`)?.textContent;if(!nextContent)throw new videoData.A(`Not found __NEXT_DATA__ content`);let data=JSON.parse(nextContent),{props:{pageProps:{page:{description,title,video:{videoMetadata:{duration},assets}}}}}=data,videoUrl=assets.find(asset=>asset.height===360&&asset.url.includes(`.mp4`))?.url;if(!videoUrl)throw new videoData.A(`Not found video URL in assets`);return{url:(0,utils.fl)(videoUrl),duration,title,description}}catch(err){return logger.A.warn(`Failed to get ign video data by video ID: ${videoId}, because ${err.message}. Using clear link instead...`),this.returnBaseData(videoId)}}async getVideoData(videoId){return document.getElementById(`__NEXT_DATA__`)?this.getVideoDataByNext(videoId):this.getVideoDataBySource(videoId)}async getVideoId(url){return/([^/]+)\/([\d]+)\/video\/([^/]+)/.exec(url.pathname)?.[0]??/\/videos\/([^/]+)/.exec(url.pathname)?.[0]}}class IMDbHelper extends base.q{async getVideoId(url){return/video\/([^/]+)/.exec(url.pathname)?.[1]}}class IncestflixHelper extends base.q{async getVideoData(videoId){try{let sourceEl=document.querySelector(`#incflix-stream source:first-of-type`);if(!sourceEl)throw new base.a(`Failed to find source element`);let srcLink=sourceEl.getAttribute(`src`);if(!srcLink)throw new base.a(`Failed to find source link`);let source=new URL(srcLink.startsWith(`//`)?`https:${srcLink}`:srcLink);return source.searchParams.append(`media-proxy`,`video.mp4`),{url:(0,utils.fl)(source)}}catch(err){logger.A.error(`Failed to get Incestflix data by videoId: ${videoId}`,err.message);return}}async getVideoId(url){return/\/watch\/([^/]+)/.exec(url.pathname)?.[1]}}class KickHelper extends base.q{API_ORIGIN=`https://kick.com/api`;async getClipInfo(clipId){try{let res=await this.fetch(`${this.API_ORIGIN}/v2/clips/${clipId}`),data=await res.json(),{clip_url:url,duration,title}=data.clip;return{url,duration,title}}catch(err){logger.A.error(`Failed to get kick clip info by clipId: ${clipId}.`,err.message);return}}async getVideoInfo(videoId){try{let res=await this.fetch(`${this.API_ORIGIN}/v1/video/${videoId}`),data=await res.json(),{source:url,livestream}=data,{session_title:title,duration}=livestream;return{url,duration:Math.round(duration/1e3),title}}catch(err){logger.A.error(`Failed to get kick video info by videoId: ${videoId}.`,err.message);return}}async getVideoData(videoId){return videoId.startsWith(`videos`)?await this.getVideoInfo(videoId.replace(`videos/`,``)):await this.getClipInfo(videoId.replace(`clips/`,``))}async getVideoId(url){return/([^/]+)\/((videos|clips)\/([^/]+))/.exec(url.pathname)?.[2]}}class KickstarterHelper extends base.q{async getVideoData(videoId){try{let videoEl=document.querySelector(`.ksr-video-player > video`),url=videoEl?.querySelector(`source[type^='video/mp4']`)?.src;if(!url)throw new base.a(`Failed to find video URL`);let subtitles=videoEl?.querySelectorAll(`track`)??[];return{url,subtitles:Array.from(subtitles).reduce((result,sub)=>{let lang=sub.getAttribute(`srclang`),url=sub.getAttribute(`src`);return!lang||!url||result.push({language:(0,utils.ec)(lang),url,format:`vtt`,source:`kickstarter`}),result},[])}}catch(err){logger.A.error(`Failed to get Kickstarter data by videoId: ${videoId}`,err.message);return}}async getVideoId(url){return url.pathname.slice(1)}}var config=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`);class KodikHelper extends base.q{API_ORIGIN=window.location.origin;getSecureData(videoPath){try{let[videoType,videoId,hash]=videoPath.split(`/`).filter(a=>a),allScripts=Array.from(document.getElementsByTagName(`script`)),secureScript=allScripts.filter(s=>s.innerHTML.includes(`videoId = "${videoId}"`)||s.innerHTML.includes(`serialId = Number(${videoId})`));if(!secureScript.length)throw new base.a(`Failed to find secure script`);let secureContent=/'{[^']+}'/.exec(secureScript[0].textContent.trim())?.[0];if(!secureContent)throw new base.a(`Secure json wasn't found in secure script`);let secureJSON=JSON.parse(secureContent.replaceAll(`'`,``));if(videoType!==`serial`)return{videoType,videoId,hash,...secureJSON};let videoInfoContent=allScripts.find(s=>s.innerHTML.includes(`var videoInfo = {}`))?.textContent?.trim();if(!videoInfoContent)throw new base.a(`Failed to find videoInfo content`);let realVideoType=/videoInfo\.type\s+?=\s+?'([^']+)'/.exec(videoInfoContent)?.[1],realVideoId=/videoInfo\.id\s+?=\s+?'([^']+)'/.exec(videoInfoContent)?.[1],realHash=/videoInfo\.hash\s+?=\s+?'([^']+)'/.exec(videoInfoContent)?.[1];if(!realVideoType||!realVideoId||!realHash)throw new base.a(`Failed to parse videoInfo content`);return{videoType:realVideoType,videoId:realVideoId,hash:realHash,...secureJSON}}catch(err){return logger.A.error(`Failed to get kodik secure data by videoPath: ${videoPath}.`,err.message),!1}}async getFtor(secureData){let{videoType,videoId:id,hash,d,d_sign,pd,pd_sign,ref,ref_sign}=secureData;try{let res=await this.fetch(this.API_ORIGIN+`/ftor`,{method:`POST`,headers:{"User-Agent":config.A.userAgent,Origin:this.API_ORIGIN,Referer:`${this.API_ORIGIN}/${videoType}/${id}/${hash}/360p`},body:new URLSearchParams({d,d_sign,pd,pd_sign,ref:decodeURIComponent(ref),ref_sign,bad_user:`false`,cdn_is_working:`true`,info:`{}`,type:videoType,hash,id})});return await res.json()}catch(err){return logger.A.error(`Failed to get kodik video data (type: ${videoType}, id: ${id}, hash: ${hash})`,err.message),!1}}decryptUrl(encryptedUrl){let decryptedUrl=atob(encryptedUrl.replace(/[a-zA-Z]/g,function(e){let charCode=e.charCodeAt(0)+18,pos=e<=`Z`?90:122;return String.fromCharCode(pos>=charCode?charCode:charCode-26)}));return`https:`+decryptedUrl}async getVideoData(videoId){let secureData=this.getSecureData(videoId);if(!secureData)return;let videoData=await this.getFtor(secureData);if(!videoData)return;let videoDataLinks=Object.entries(videoData.links[videoData.default.toString()]),videoLink=videoDataLinks.find(([,data])=>data.type===`application/x-mpegURL`)?.[1];if(videoLink)return{url:videoLink.src.startsWith(`//`)?`https:${videoLink.src}`:this.decryptUrl(videoLink.src)}}async getVideoId(url){return/\/(uv|video|seria|episode|season|serial)\/([^/]+)\/([^/]+)\/([\d]+)p/.exec(url.pathname)?.[0]}}class LinkedinHelper extends VideoJSHelper{SUBTITLE_SOURCE=`linkedin`;async getVideoData(videoId){let data=this.getVideoDataByPlayer(videoId);if(!data)return;let{url,duration,subtitles}=data;return{url:(0,utils.fl)(new URL(url)),duration,subtitles}}async getVideoId(url){return/\/learning\/(([^/]+)\/([^/]+))/.exec(url.pathname)?.[1]}}var dist=__webpack_require__(`./node_modules/@vot.js/shared/dist/index.js`);class LoomHelper extends base.q{getClientVersion(){if(!(typeof SENTRY_RELEASE>`u`))return SENTRY_RELEASE.id}async getVideoData(videoId){try{let clientVer=this.getClientVersion();if(!clientVer)throw new base.a(`Failed to get client version`);let res=await this.fetch(`https://www.loom.com/graphql`,{headers:{"User-Agent":dist.$W.userAgent,"content-type":`application/json`,"x-loom-request-source":`loom_web_${clientVer}`,"apollographql-client-name":`web`,"apollographql-client-version":clientVer,"Alt-Used":`www.loom.com`},body:`{"operationName":"FetchCaptions","variables":{"videoId":"${videoId}"},"query":"query FetchCaptions($videoId: ID!, $password: String) {\\n  fetchVideoTranscript(videoId: $videoId, password: $password) {\\n    ... on VideoTranscriptDetails {\\n      id\\n      captions_source_url\\n      language\\n      __typename\\n    }\\n    ... on GenericError {\\n      message\\n      __typename\\n    }\\n    __typename\\n  }\\n}"}`,method:`POST`});if(res.status!==200)throw new base.a(`Failed to get data from graphql`);let result=await res.json(),data=result.data.fetchVideoTranscript;if(data.__typename===`GenericError`)throw new base.a(data.message);return{url:this.service.url+videoId,subtitles:[{format:`vtt`,language:(0,utils.ec)(data.language),source:`loom`,url:data.captions_source_url}]}}catch(err){return logger.A.error(`Failed to get Loom video data, because: ${err.message}`),this.returnBaseData(videoId)}}async getVideoId(url){return/(embed|share)\/([^/]+)?/.exec(url.pathname)?.[2]}}class MailRuHelper extends base.q{API_ORIGIN=`https://my.mail.ru`;async getVideoMeta(videoId){try{let res=await this.fetch(`${this.API_ORIGIN}/+/video/meta/${videoId}?xemail=&ajax_call=1&func_name=&mna=&mnb=&ext=1&_=${new Date().getTime()}`);return await res.json()}catch(err){logger.A.error(`Failed to get mail.ru video data`,err.message);return}}async getVideoId(url){let pathname=url.pathname;if(/\/(v|mail|bk|inbox)\//.exec(pathname))return pathname.slice(1);let videoId=/video\/embed\/([^/]+)/.exec(pathname)?.[1];if(!videoId)return;let videoData=await this.getVideoMeta(videoId);if(videoData)return videoData.meta.url.replace(`//my.mail.ru/`,``)}}class NewgroundsHelper extends base.q{async getVideoId(url){return/([^/]+)\/(view)\/([^/]+)/.exec(url.pathname)?.[0]}}class NineGAGHelper extends base.q{async getVideoData(videoId){let data=this.returnBaseData(videoId);if(!data)return data;try{if(!this.video)throw Error(`Video element not found`);let videoUrl=this.video.querySelector(`source[type^="video/mp4"], source[type^="video/webm"]`)?.src;if(!videoUrl||!/^https?:\/\//.test(videoUrl))throw Error(`Video source not found`);return{...data,translationHelp:[{target:`video_file_url`,targetUrl:videoUrl}]}}catch{return data}}async getVideoId(url){return/gag\/([^/]+)/.exec(url.pathname)?.[1]}}class OdyseeHelper extends base.q{API_ORIGIN=`https://odysee.com`;async getVideoData(videoId){try{let res=await this.fetch(`${this.API_ORIGIN}/${videoId}`),content=await res.text(),url=/"contentUrl":(\s)?"([^"]+)"/.exec(content)?.[2];if(!url)throw new base.a(`Odysee url doesn't parsed`);return{url}}catch(err){logger.A.error(`Failed to get odysee video data by video ID: ${videoId}`,err.message);return}}async getVideoId(url){return url.pathname.slice(1)}}class OKRuHelper extends base.q{async getVideoId(url){return/\/video\/(\d+)/.exec(url.pathname)?.[1]}}class OracleLearnHelper extends VideoJSHelper{SUBTITLE_SOURCE=`oraclelearn`;async getVideoData(videoId){let data=this.getVideoDataByPlayer(videoId);if(!data)return;let{url,duration,subtitles}=data,baseData=this.returnBaseData(videoId),videoUrl=(0,utils.fl)(new URL(url));return baseData?{url:baseData.url,duration,subtitles,translationHelp:[{target:`video_file_url`,targetUrl:videoUrl}]}:{url:videoUrl,duration,subtitles}}async getVideoId(url){return/\/ou\/course\/(([^/]+)\/(\d+)\/(\d+))/.exec(url.pathname)?.[1]}}class PatreonHelper extends base.q{API_ORIGIN=`https://www.patreon.com/api`;async getPosts(postId){try{let res=await this.fetch(`${this.API_ORIGIN}/posts/${postId}?json-api-use-default-includes=false`);return await res.json()}catch(err){return logger.A.error(`Failed to get patreon posts by postId: ${postId}.`,err.message),!1}}async getVideoData(postId){let postData=await this.getPosts(postId);if(!postData)return;let postFileUrl=postData.data.attributes.post_file.url;if(postFileUrl)return{url:postFileUrl}}async getVideoId(url){let fullPostId=/posts\/([^/]+)/.exec(url.pathname)?.[1];if(fullPostId)return fullPostId.replace(/[^\d.]/g,``)}}class PeertubeHelper extends base.q{async getVideoId(url){return/\/w\/([^/]+)/.exec(url.pathname)?.[0]}}class PornhubHelper extends base.q{async getVideoId(url){return url.searchParams.get(`viewkey`)??/embed\/([^/]+)/.exec(url.pathname)?.[1]}}class PornTNHelper extends base.q{async getVideoData(videoId){try{if(typeof flashvars>`u`)return;let{rnd,video_url:source,video_title:title}=flashvars;if(!source||!rnd)throw new base.a(`Failed to find video source or rnd`);let getFileUrl=new URL(source);getFileUrl.searchParams.append(`rnd`,rnd),logger.A.log(`PornTN get_file link`,getFileUrl.href);let cdnResponse=await this.fetch(getFileUrl.href,{method:`head`}),cdnUrl=new URL(cdnResponse.url);logger.A.log(`PornTN cdn link`,cdnUrl.href);let proxiedUrl=(0,utils.fl)(cdnUrl);return{url:proxiedUrl,title}}catch(err){logger.A.error(`Failed to get PornTN data by videoId: ${videoId}`,err.message);return}}async getVideoId(url){return/\/videos\/(([^/]+)\/([^/]+))/.exec(url.pathname)?.[1]}}class RedditHelper extends base.q{API_ORIGIN=`https://www.reddit.com`;async getContentUrl(_videoId){if(this.service?.additionalData!==`old`)return document.querySelector(`shreddit-player-2`)?.src;let playerEl=document.querySelector(`[data-hls-url]`);return playerEl?.dataset.hlsUrl?.replaceAll(`&amp;`,`&`)}async getVideoData(videoId){try{let contentUrl=await this.getContentUrl(videoId);if(!contentUrl)throw new base.a(`Failed to find content url`);return{url:decodeURIComponent(contentUrl)}}catch(err){logger.A.error(`Failed to get reddit video data by video ID: ${videoId}`,err.message);return}}async getVideoId(url){return/\/r\/(([^/]+)\/([^/]+)\/([^/]+)\/([^/]+))/.exec(url.pathname)?.[1]}}class RtNewsHelper extends base.q{async getVideoData(videoId){let videoEl=document.querySelector(`.jw-video, .media__video_noscript`);if(!videoEl)return;let videoSrc=videoEl.getAttribute(`src`);if(videoSrc)return videoSrc.endsWith(`.MP4`)&&(videoSrc=(0,utils.fl)(videoSrc)),{videoId,url:videoSrc}}async getVideoId(url){return url.pathname.slice(1)}}class RumbleHelper extends base.q{async getVideoId(url){return url.pathname.slice(1)}}class RutubeHelper extends base.q{async getVideoId(url){return/(?:video|embed)\/([^/]+)/.exec(url.pathname)?.[1]}}class SapHelper extends base.q{API_ORIGIN=`https://learning.sap.com/`;async requestKaltura(kalturaDomain,partnerId,entryId){let clientTag=`html5:v3.17.22`,apiVersion=`3.3.0`;try{let res=await this.fetch(`https://${kalturaDomain}/api_v3/service/multirequest`,{method:`POST`,body:JSON.stringify({1:{service:`session`,action:`startWidgetSession`,widgetId:`_${partnerId}`},2:{service:`baseEntry`,action:`list`,ks:`{1:result:ks}`,filter:{redirectFromEntryId:entryId},responseProfile:{type:1,fields:`id,referenceId,name,description,dataUrl,duration,flavorParamsIds,type,dvrStatus,externalSourceType,createdAt,updatedAt,endDate,plays,views,downloadUrl,creatorId`}},3:{service:`baseEntry`,action:`getPlaybackContext`,entryId:`{2:result:objects:0:id}`,ks:`{1:result:ks}`,contextDataParams:{objectType:`KalturaContextDataParams`,flavorTags:`all`}},apiVersion,format:1,ks:``,clientTag,partnerId}),headers:{"Content-Type":`application/json`}});return await res.json()}catch(err){logger.A.error(`Failed to request kaltura data`,err.message);return}}async getKalturaData(videoId){try{let scriptEl=document.querySelector(`script[data-nscript="beforeInteractive"]`);if(!scriptEl)throw new base.a(`Failed to find script element`);let sapData=/https:\/\/([^"]+)\/p\/([^"]+)\/embedPlaykitJs\/uiconf_id\/([^"]+)/.exec(scriptEl?.src);if(!sapData)throw new base.a(`Failed to get sap data for videoId: ${videoId}`);let[,kalturaDomain,partnerId]=sapData,entryId=document.querySelector(`#shadow`)?.firstChild?.getAttribute(`id`);if(!entryId){let nextDataEl=document.querySelector(`#__NEXT_DATA__`);if(!nextDataEl)throw new base.a(`Failed to find next data element`);entryId=/"sourceId":\s?"([^"]+)"/.exec(nextDataEl.innerText)?.[1]}if(!kalturaDomain||Number.isNaN(+partnerId)||!entryId)throw new base.a(`One of the necessary parameters for getting a link to a sap video in wasn't found for ${videoId}. Params: kalturaDomain = ${kalturaDomain}, partnerId = ${partnerId}, entryId = ${entryId}`);return await this.requestKaltura(kalturaDomain,partnerId,entryId)}catch(err){logger.A.error(`Failed to get kaltura data`,err.message);return}}async getVideoData(videoId){let kalturaData=await this.getKalturaData(videoId);if(!kalturaData)return;let[,baseEntryList,playbackContext]=kalturaData,{duration}=baseEntryList.objects[0],videoUrl=playbackContext.sources.find(source=>source.format===`url`&&source.protocols===`http,https`&&source.url.includes(`.mp4`))?.url;if(!videoUrl)return;let subtitles=playbackContext.playbackCaptions.map(caption=>({language:(0,utils.ec)(caption.languageCode),source:`sap`,format:`vtt`,url:caption.webVttUrl,isAutoGenerated:caption.label.includes(`auto-generated`)}));return{url:videoUrl,subtitles,duration}}async getVideoId(url){return/((courses|learning-journeys)\/([^/]+)(\/[^/]+)?)/.exec(url.pathname)?.[1]}}class TelegramHelper extends base.q{static getMediaViewer(){if(!(typeof appMediaViewer>`u`))return appMediaViewer}async getVideoId(_url){let mediaViewer=TelegramHelper.getMediaViewer();if(!mediaViewer||mediaViewer.live)return;let message=mediaViewer.target.message;if(message.peer_id._!==`peerChannel`)return;let media=message.media;if(media._!==`messageMediaDocument`||media.document.type!==`video`)return;let postId=message.mid&4294967295,username=await mediaViewer.managers.appPeersManager.getPeerUsername(message.peerId);return`${username}/${postId}`}}class ThisVidHelper extends base.q{async getVideoId(url){return/(videos|embed)\/[^/]+/.exec(url.pathname)?.[0]}}class TikTokHelper extends base.q{async getVideoId(url){return/([^/]+)\/video\/([^/]+)/.exec(url.pathname)?.[0]}}class TrovoHelper extends base.q{async getVideoId(url){let vid=url.searchParams.get(`vid`),path=/([^/]+)\/([\d]+)/.exec(url.pathname)?.[0];if(!(!vid||!path))return`${path}?vid=${vid}`}}class TwitchHelper extends base.q{API_ORIGIN=`https://clips.twitch.tv`;async getClipLink(pathname,clipId){let schema=document.querySelector(`script[type='application/ld+json']`),clearPathname=pathname.slice(1);if(schema){let schemaJSON=JSON.parse(schema.innerText),channelLink=schemaJSON[`@graph`].find(obj=>obj[`@type`]===`VideoObject`)?.creator.url;if(!channelLink)throw new base.a(`Failed to find channel link`);let channelName=channelLink.replace(`https://www.twitch.tv/`,``);return`${channelName}/clip/${clearPathname}`}let isEmbed=clearPathname===`embed`,channelLink=document.querySelector(isEmbed?`.tw-link[data-test-selector='stream-info-card-component__stream-avatar-link']`:`.clips-player a:not([class])`);if(!channelLink)return;let channelName=channelLink.href.replace(`https://www.twitch.tv/`,``);return`${channelName}/clip/${isEmbed?clipId:clearPathname}`}async getVideoData(videoId){let title=document.querySelector(`[data-a-target="stream-title"], [data-test-selector="stream-info-card-component__subtitle"]`)?.innerText,isStream=!!document.querySelector(`[data-a-target="animated-channel-viewers-count"], .channel-status-info--live, .top-bar--pointer-enabled .tw-channel-status-text-indicator`);return{url:this.service.url+videoId,isStream,title}}async getVideoId(url){let pathname=url.pathname;if(/^m\.twitch\.tv$/.test(pathname))return/videos\/([^/]+)/.exec(url.href)?.[0]??pathname.slice(1);if(/^player\.twitch\.tv$/.test(url.hostname))return`videos/${url.searchParams.get(`video`)}`;let clipPath=/([^/]+)\/(?:clip)\/([^/]+)/.exec(pathname);if(clipPath)return clipPath[0];let isClipsDomain=/^clips\.twitch\.tv$/.test(url.hostname);if(isClipsDomain)return await this.getClipLink(pathname,url.searchParams.get(`clip`));let videoPath=/(?:videos)\/([^/]+)/.exec(pathname);if(videoPath)return videoPath[0];let isUserOfflinePage=document.querySelector(`.home-offline-hero .tw-link`);if(isUserOfflinePage?.href){let pageUrl=new URL(isUserOfflinePage.href);return/(?:videos)\/([^/]+)/.exec(pageUrl.pathname)?.[0]}return document.querySelector(`.persistent-player`)?pathname:void 0}}class TwitterHelper extends base.q{async getVideoId(url){let videoId=/status\/([^/]+)/.exec(url.pathname)?.[1];if(videoId)return videoId;let postEl=this.video?.closest(`[data-testid="tweet"]`),newLink=postEl?.querySelector(`a[role="link"][aria-label]`)?.href;return newLink?/status\/([^/]+)/.exec(newLink)?.[1]:void 0}}class UdemyHelper extends base.q{API_ORIGIN=`https://www.udemy.com/api-2.0`;getModuleData(){let appLoaderEl=document.querySelector(`.ud-app-loader[data-module-id='course-taking']`),moduleData=appLoaderEl?.dataset?.moduleArgs;if(moduleData)return JSON.parse(moduleData)}getLectureId(){return/learn\/lecture\/([^/]+)/.exec(window.location.pathname)?.[1]}isErrorData(data){return Object.hasOwn(data,`error`)}async getLectureData(courseId,lectureId){try{let res=await this.fetch(`${this.API_ORIGIN}/users/me/subscribed-courses/${courseId}/lectures/${lectureId}/?`+new URLSearchParams({"fields[lecture]":`title,description,asset`,"fields[asset]":`length,media_sources,captions`}).toString()),data=await res.json();if(this.isErrorData(data))throw new base.a(data.detail??`unknown error`);return data}catch(err){logger.A.error(`Failed to get lecture data by courseId: ${courseId} and lectureId: ${lectureId}`,err.message);return}}async getCourseLang(courseId){try{let res=await this.fetch(`${this.API_ORIGIN}/users/me/subscribed-courses/${courseId}?`+new URLSearchParams({"fields[course]":`locale`}).toString()),data=await res.json();if(this.isErrorData(data))throw new base.a(data.detail??`unknown error`);return data}catch(err){logger.A.error(`Failed to get course lang by courseId: ${courseId}`,err.message);return}}findVideoUrl(sources){return sources?.find(src=>src.type===`video/mp4`)?.src}findSubtitleUrl(captions,detectedLanguage){let subtitle=captions?.find(caption=>(0,utils.ec)(caption.locale_id)===detectedLanguage)??captions?.find(caption=>(0,utils.ec)(caption.locale_id)===`en`)??captions?.[0];return subtitle?.url}async getVideoData(videoId){let moduleData=this.getModuleData();if(!moduleData)return;let{courseId}=moduleData,lectureId=this.getLectureId();if(logger.A.log(`[Udemy] courseId: ${courseId}, lectureId: ${lectureId}`),!lectureId)return;let lectureData=await this.getLectureData(courseId,lectureId);if(!lectureData)return;let{title,description,asset}=lectureData,{length:duration,media_sources,captions}=asset,videoUrl=this.findVideoUrl(media_sources);if(!videoUrl){logger.A.log(`Failed to find .mp4 video file in media_sources`,media_sources);return}let courseLang=`en`,courseLangData=await this.getCourseLang(courseId);if(courseLangData){let{locale:{locale:courseLocale}}=courseLangData;courseLang=courseLocale?(0,utils.ec)(courseLocale):courseLang}consts.xm.includes(courseLang)||(courseLang=`en`);let subtitleUrl=this.findSubtitleUrl(captions,courseLang);return subtitleUrl||logger.A.log(`Failed to find subtitle file in captions`,captions),{...subtitleUrl?{url:this.service?.url+videoId,translationHelp:[{target:`subtitles_file_url`,targetUrl:subtitleUrl},{target:`video_file_url`,targetUrl:videoUrl}],detectedLanguage:courseLang}:{url:videoUrl,translationHelp:null},duration,title,description}}async getVideoId(url){return url.pathname.slice(1)}}class VimeoHelper extends base.q{API_KEY=``;DEFAULT_SITE_ORIGIN=`https://vimeo.com`;SITE_ORIGIN=this.service?.url?.slice(0,-1)??this.DEFAULT_SITE_ORIGIN;isErrorData(data){return Object.hasOwn(data,`error`)}isPrivatePlayer(){return this.referer&&!this.referer.includes(`vimeo.com`)}async getViewerData(){try{let res=await this.fetch(`https://vimeo.com/_next/viewer`),data=await res.json(),{apiUrl,jwt}=data;return this.API_ORIGIN=`https://${apiUrl}`,this.API_KEY=`jwt ${jwt}`,data}catch(err){return logger.A.error(`Failed to get default viewer data.`,err.message),!1}}async getVideoInfo(videoId){try{let params=new URLSearchParams({fields:`name,link,description,duration`}).toString(),res=await this.fetch(`${this.API_ORIGIN}/videos/${videoId}?${params}`,{headers:{Authorization:this.API_KEY}}),data=await res.json();if(this.isErrorData(data))throw Error(data.developer_message??data.error);return data}catch(err){return logger.A.error(`Failed to get video info by video ID: ${videoId}`,err.message),!1}}async getPrivateVideoSource(files){try{let{default_cdn,cdns}=files.dash,cdnUrl=cdns[default_cdn].url,res=await this.fetch(cdnUrl);if(res.status!==200)throw new base.a(await res.text());let data=await res.json(),baseUrl=new URL(data.base_url,cdnUrl),videoData=data.audio.find(v=>v.mime_type===`audio/mp4`&&v.format===`dash`);if(!videoData)throw new base.a(`Failed to find video data`);let segmentUrl=videoData.segments?.[0]?.url;if(!segmentUrl)throw new base.a(`Failed to find first segment url`);let[videoName,videoParams]=segmentUrl.split(`?`,2),params=new URLSearchParams(videoParams);return params.delete(`range`),new URL(`${videoData.base_url}${videoName}?${params.toString()}`,baseUrl).href}catch(err){return logger.A.error(`Failed to get private video source`,err.message),!1}}async getPrivateVideoInfo(videoId){try{if(typeof playerConfig>`u`)return;let videoSource=await this.getPrivateVideoSource(playerConfig.request.files);if(!videoSource)throw new base.a(`Failed to get private video source`);let{video:{title,duration},request:{text_tracks:subs}}=playerConfig;return{url:`${this.SITE_ORIGIN}/${videoId}`,video_url:videoSource,title,duration,subs}}catch(err){return logger.A.error(`Failed to get private video info by video ID: ${videoId}`,err.message),!1}}async getSubsInfo(videoId){try{let params=new URLSearchParams({per_page:`100`,fields:`language,type,link`}).toString(),res=await this.fetch(`${this.API_ORIGIN}/videos/${videoId}/texttracks?${params}`,{headers:{Authorization:this.API_KEY}}),content=await res.json();if(this.isErrorData(content))throw Error(content.developer_message??content.error);return content.data}catch(err){return logger.A.error(`Failed to get subtitles info by video ID: ${videoId}`,err.message),[]}}async getVideoData(videoId){let isPrivate=this.isPrivatePlayer();if(isPrivate){let videoInfo=await this.getPrivateVideoInfo(videoId);if(!videoInfo)return;let{url,subs,video_url,title,duration}=videoInfo,subtitles=subs.map(sub=>({language:(0,utils.ec)(sub.lang),source:`vimeo`,format:`vtt`,url:this.SITE_ORIGIN+sub.url,isAutoGenerated:sub.lang.includes(`autogenerated`)})),translationHelp=subtitles.length?[{target:`video_file_url`,targetUrl:video_url},{target:`subtitles_file_url`,targetUrl:subtitles[0].url}]:null;return{...translationHelp?{url,translationHelp}:{url:video_url},subtitles,title,duration}}if(!this.extraInfo)return this.returnBaseData(videoId);videoId.includes(`/`)&&(videoId=videoId.replace(`/`,`:`));let viewerData=await this.getViewerData();if(!viewerData)return this.returnBaseData(videoId);let videoInfo=await this.getVideoInfo(videoId);if(!videoInfo)return this.returnBaseData(videoId);let subsData=await this.getSubsInfo(videoId),subtitles=subsData.map(caption=>({language:(0,utils.ec)(caption.language),source:`vimeo`,format:`vtt`,url:caption.link,isAutoGenerated:caption.language.includes(`autogen`)})),{link:url,duration,name:title,description}=videoInfo;return{url,title,description,subtitles,duration}}async getVideoId(url){let embedId=/video\/[^/]+$/.exec(url.pathname)?.[0];if(this.isPrivatePlayer())return embedId;if(embedId){let hash=url.searchParams.get(`h`),videoId=embedId.replace(`video/`,``);return hash?`${videoId}/${hash}`:videoId}let categoriesVideoId=/channels\/[^/]+\/([^/]+)/.exec(url.pathname)?.[1]??/groups\/[^/]+\/videos\/([^/]+)/.exec(url.pathname)?.[1]??/(showcase|album)\/[^/]+\/video\/([^/]+)/.exec(url.pathname)?.[2];return categoriesVideoId||/([^/]+\/)?[^/]+$/.exec(url.pathname)?.[0]}}class VKHelper extends base.q{static getPlayer(){if(!(typeof Videoview>`u`))return Videoview?.getPlayerObject?.call(void 0)}async getVideoData(videoId){let player=VKHelper.getPlayer();if(!player)return this.returnBaseData(videoId);try{let{description:descriptionHTML,duration,md_title:title}=player.vars,parser=new DOMParser,doc=parser.parseFromString(descriptionHTML,`text/html`),description=Array.from(doc.body.childNodes).filter(el=>el.nodeName!==`BR`).map(el=>el.textContent).join(`
`),subtitles;return Object.hasOwn(player.vars,`subs`)&&(subtitles=player.vars.subs.map(sub=>({language:(0,utils.ec)(sub.lang),source:`vk`,format:`vtt`,url:sub.url,isAutoGenerated:!!sub.is_auto}))),{url:this.service.url+videoId,title,description,duration,subtitles}}catch(err){return logger.A.error(`Failed to get VK video data, because: ${err.message}`),this.returnBaseData(videoId)}}async getVideoId(url){let pathID=/^\/(video|clip)-?\d{8,9}_\d{9}$/.exec(url.pathname);if(pathID)return pathID[0].slice(1);let idInsidePlaylist=/\/playlist\/[^/]+\/(video-?\d{8,9}_\d{9})/.exec(url.pathname);if(idInsidePlaylist)return idInsidePlaylist[1];let paramZ=url.searchParams.get(`z`);if(paramZ)return paramZ.split(`/`)[0];let paramOID=url.searchParams.get(`oid`),paramID=url.searchParams.get(`id`);if(paramOID&&paramID)return`video-${Math.abs(parseInt(paramOID))}_${paramID}`}}class WatchPornToHelper extends base.q{async getVideoId(url){return/(video|embed)\/(\d+)(\/[^/]+\/)?/.exec(url.pathname)?.[0]}}var dist_secure=__webpack_require__(`./node_modules/@vot.js/shared/dist/secure.js`);class WeverseHelper extends base.q{API_ORIGIN=`https://global.apis.naver.com/weverse/wevweb`;API_APP_ID=`be4d79eb8fc7bd008ee82c8ec4ff6fd4`;API_HMAC_KEY=`1b9cb6378d959b45714bec49971ade22e6e24e42`;HEADERS={Accept:`application/json, text/plain, */*`,Origin:`https://weverse.io`,Referer:`https://weverse.io/`};getURLData(){return{appId:this.API_APP_ID,language:`en`,os:`WEB`,platform:`WEB`,wpf:`pc`}}async createHash(pathname){let timestamp=Date.now(),salt=pathname.substring(0,Math.min(255,pathname.length))+timestamp,sign=await(0,dist_secure.bT)(this.API_HMAC_KEY,salt);if(!sign)throw new base.a(`Failed to get weverse HMAC signature`);return{wmsgpad:timestamp.toString(),wmd:sign}}async getHashURLParams(pathname){let hash=await this.createHash(pathname);return new URLSearchParams(hash).toString()}async getPostPreview(postId){let pathname=`/post/v1.0/post-${postId}/preview?`+new URLSearchParams({fieldSet:`postForPreview`,...this.getURLData()}).toString();try{let urlParams=await this.getHashURLParams(pathname),res=await this.fetch(this.API_ORIGIN+pathname+`&`+urlParams,{headers:this.HEADERS});return await res.json()}catch(err){return logger.A.error(`Failed to get weverse post preview by postId: ${postId}`,err.message),!1}}async getVideoInKey(videoId){let pathname=`/video/v1.1/vod/${videoId}/inKey?`+new URLSearchParams({gcc:`RU`,...this.getURLData()}).toString();try{let urlParams=await this.getHashURLParams(pathname),res=await this.fetch(this.API_ORIGIN+pathname+`&`+urlParams,{method:`POST`,headers:this.HEADERS});return await res.json()}catch(err){return logger.A.error(`Failed to get weverse InKey by videoId: ${videoId}`,err.message),!1}}async getVideoInfo(infraVideoId,inkey,serviceId){let timestamp=Date.now();try{let urlParams=new URLSearchParams({key:inkey,sid:serviceId,nonce:timestamp.toString(),devt:`html5_pc`,prv:`N`,aup:`N`,stpb:`N`,cpl:`en`,env:`prod`,lc:`en`,adi:JSON.stringify([{adSystem:null}]),adu:`/`}).toString(),res=await this.fetch(`https://global.apis.naver.com/rmcnmv/rmcnmv/vod/play/v2.0/${infraVideoId}?`+urlParams,{headers:this.HEADERS});return await res.json()}catch(err){return logger.A.error(`Failed to get weverse video info (infraVideoId: ${infraVideoId}, inkey: ${inkey}, serviceId: ${serviceId}`,err.message),!1}}extractVideoInfo(videoList){return videoList.find(video=>video.useP2P===!1&&video.source.includes(`.mp4`))}async getVideoData(videoId){let videoPreview=await this.getPostPreview(videoId);if(!videoPreview)return;let{videoId:internalVideoId,serviceId,infraVideoId}=videoPreview.extension.video;if(!(internalVideoId&&serviceId&&infraVideoId))return;let inkeyData=await this.getVideoInKey(internalVideoId);if(!inkeyData)return;let videoInfo=await this.getVideoInfo(infraVideoId,inkeyData.inKey,serviceId);if(!videoInfo)return;let videoItem=this.extractVideoInfo(videoInfo.videos.list);if(videoItem)return{url:videoItem.source,duration:videoItem.duration}}async getVideoId(url){return/([^/]+)\/(live|media)\/([^/]+)/.exec(url.pathname)?.[3]}}class XVideosHelper extends base.q{async getVideoId(url){return/[^/]+\/[^/]+$/.exec(url.pathname)?.[0]}}class YandexDiskHelper extends base.q{API_ORIGIN=window.location.origin;CLIENT_PREFIX=`/client/disk`;INLINE_PREFIX=`/i/`;DISK_PREFIX=`/d/`;isErrorData(data){return Object.hasOwn(data,`error`)}async getClientVideoData(videoId){let url=new URL(window.location.href),dialogId=url.searchParams.get(`idDialog`);if(!dialogId)return;let preloadedScript=document.querySelector(`#preloaded-data`);if(preloadedScript)try{let preloadedData=JSON.parse(preloadedScript.innerText),{idClient,sk}=preloadedData.config,res=await this.fetch(this.API_ORIGIN+`/models-v2?m=mpfs/info`,{method:`POST`,body:JSON.stringify({apiMethod:`mpfs/info`,connection_id:idClient,requestParams:{path:dialogId},sk}),headers:{"Content-Type":`application/json`}}),data=await res.json();if(this.isErrorData(data))throw new base.a(data.error?.message??data.error?.code);if(data?.type!==`file`)throw new base.a(`Failed to get resource info`);let{meta:{short_url,video_info},name}=data;if(!video_info)throw new base.a(`There's no video open right now`);if(!short_url)throw new base.a(`Access to the video is limited`);let title=this.clearTitle(name),duration=Math.round(video_info.duration/1e3);return{url:short_url,title,duration}}catch(err){logger.A.error(`Failed to get yandex disk video data by video ID: ${videoId}, because ${err.message}`);return}}clearTitle(title){return title.replace(/(\.[^.]+)$/,``)}getBodyHash(fileHash,sk){let data=JSON.stringify({hash:fileHash,sk});return encodeURIComponent(data)}async fetchList(dirHash,sk){let body=this.getBodyHash(dirHash,sk),res=await this.fetch(this.API_ORIGIN+`/public/api/fetch-list`,{method:`POST`,body}),data=await res.json();if(Object.hasOwn(data,`error`))throw new base.a(`Failed to fetch folder list`);return data.resources}async getDownloadUrl(fileHash,sk){let body=this.getBodyHash(fileHash,sk),res=await this.fetch(this.API_ORIGIN+`/public/api/download-url`,{method:`POST`,body}),data=await res.json();if(data.error)throw new base.a(`Failed to get download url`);return data.data.url}async getDiskVideoData(videoId){try{let prefetchEl=document.getElementById(`store-prefetch`);if(!prefetchEl)throw new base.a(`Failed to get prefetch data`);let resourcePaths=videoId.split(`/`).slice(3);if(!resourcePaths.length)throw new base.a(`Failed to find video file path`);let data=JSON.parse(prefetchEl.innerText),{resources,rootResourceId,environment:{sk}}=data,rootResource=resources[rootResourceId],resourcePathsLastIdx=resourcePaths.length-1,resourcePath=resourcePaths.filter((_,idx)=>idx!==resourcePathsLastIdx).join(`/`),resourcesList=Object.values(resources);resourcePath.includes(`/`)&&(resourcesList=await this.fetchList(`${rootResource.hash}:/${resourcePath}`,sk));let resource=resourcesList.find(resource=>resource.name===resourcePaths[resourcePathsLastIdx]);if(!resource)throw new base.a(`Failed to find resource`);if(resource&&resource.type===`dir`)throw new base.a(`Path is dir, but expected file`);let{meta:{short_url,mediatype,videoDuration},path,name}=resource;if(mediatype!==`video`)throw new base.a(`Resource isn't a video`);let title=this.clearTitle(name),duration=Math.round(videoDuration/1e3);if(short_url)return{url:short_url,duration,title};let downloadUrl=await this.getDownloadUrl(path,sk);return{url:(0,utils.fl)(new URL(downloadUrl)),duration,title}}catch(err){logger.A.error(`Failed to get yandex disk video data by disk video ID: ${videoId}`,err.message);return}}async getVideoData(videoId){return videoId.startsWith(this.INLINE_PREFIX)||/^\/d\/([^/]+)$/.exec(videoId)?{url:this.service.url+videoId.slice(1)}:(videoId=decodeURIComponent(videoId),videoId.startsWith(this.CLIENT_PREFIX)?await this.getClientVideoData(videoId):await this.getDiskVideoData(videoId))}async getVideoId(url){if(url.pathname.startsWith(this.CLIENT_PREFIX))return url.pathname+url.search;let fileId=/\/i\/([^/]+)/.exec(url.pathname)?.[0];return fileId||(/\/d\/([^/]+)/.exec(url.pathname)?url.pathname:void 0)}}class YoukuHelper extends base.q{async getVideoId(url){return/v_show\/id_[\w=]+/.exec(url.pathname)?.[0]}}var youtube=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/youtube.js`);class NetacadHelper extends VideoJSHelper{SUBTITLE_SOURCE=`netacad`;async getVideoData(videoId){let data=this.getVideoDataByPlayer(videoId);if(!data)return;let{url,duration,subtitles}=data;return{url:(0,utils.fl)(new URL(url)),duration,subtitles}}async getVideoId(url){return url.pathname+url.search}}let availableHelpers={[service.r.mailru]:MailRuHelper,[service.r.weverse]:WeverseHelper,[service.r.kodik]:KodikHelper,[service.r.patreon]:PatreonHelper,[service.r.reddit]:RedditHelper,[service.r.bannedvideo]:BannedVideoHelper,[service.r.kick]:KickHelper,[service.r.appledeveloper]:AppleDeveloperHelper,[service.r.epicgames]:EpicGamesHelper,[service.r.odysee]:OdyseeHelper,[service.r.coursehunterLike]:CoursehunterLikeHelper,[service.r.twitch]:TwitchHelper,[service.r.sap]:SapHelper,[service.r.linkedin]:LinkedinHelper,[service.r.vimeo]:VimeoHelper,[service.r.yandexdisk]:YandexDiskHelper,[service.r.vk]:VKHelper,[service.r.trovo]:TrovoHelper,[service.r.incestflix]:IncestflixHelper,[service.r.porntn]:PornTNHelper,[service.r.googledrive]:GoogleDriveHelper,[service.r.bilibili]:BilibiliHelper,[service.r.xvideos]:XVideosHelper,[service.r.watchpornto]:WatchPornToHelper,[service.r.archive]:ArchiveHelper,[service.r.dailymotion]:DailymotionHelper,[service.r.youku]:YoukuHelper,[service.r.egghead]:EggheadHelper,[service.r.newgrounds]:NewgroundsHelper,[service.r.okru]:OKRuHelper,[service.r.peertube]:PeertubeHelper,[service.r.eporner]:EpornerHelper,[service.r.bitchute]:BitchuteHelper,[service.r.rutube]:RutubeHelper,[service.r.facebook]:FacebookHelper,[service.r.rumble]:RumbleHelper,[service.r.twitter]:TwitterHelper,[service.r.pornhub]:PornhubHelper,[service.r.tiktok]:TikTokHelper,[service.r.proxitok]:TikTokHelper,[service.r.nine_gag]:NineGAGHelper,[service.r.youtube]:youtube.A,[service.r.ricktube]:youtube.A,[service.r.invidious]:youtube.A,[service.r.poketube]:youtube.A,[service.r.piped]:youtube.A,[service.r.dzen]:DzenHelper,[service.r.cloudflarestream]:CloudflareStreamHelper,[service.r.loom]:LoomHelper,[service.r.rtnews]:RtNewsHelper,[service.r.bitview]:BitviewHelper,[service.r.thisvid]:ThisVidHelper,[service.r.ign]:IgnHelper,[service.r.bunkr]:BunkrHelper,[service.r.imdb]:IMDbHelper,[service.r.telegram]:TelegramHelper,[types_service.Q.udemy]:UdemyHelper,[types_service.Q.coursera]:CourseraHelper,[types_service.Q.douyin]:DouyinHelper,[types_service.Q.artstation]:ArtstationHelper,[types_service.Q.kickstarter]:KickstarterHelper,[types_service.Q.oraclelearn]:OracleLearnHelper,[types_service.Q.deeplearningai]:DeeplearningAIHelper,[types_service.Q.netacad]:NetacadHelper};class VideoHelper{helpersData;constructor(helpersData={}){this.helpersData=helpersData}getHelper(service){return new availableHelpers[service](this.helpersData)}}},"./node_modules/@vot.js/ext/dist/helpers/youtube.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>YoutubeHelper});var _base_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/base.js`),_vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/logger.js`),_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/utils.js`),_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/consts.js`);class YoutubeHelper extends _base_js__WEBPACK_IMPORTED_MODULE_0__.q{static isMobile(){return/^m\.youtube\.com$/.test(window.location.hostname)}static getPlayer(){return window.location.pathname.startsWith(`/shorts/`)&&!YoutubeHelper.isMobile()?document.querySelector(`#shorts-player`):document.querySelector(`#movie_player`)}static getPlayerResponse(){return YoutubeHelper.getPlayer()?.getPlayerResponse?.call(void 0)}static getPlayerData(){return YoutubeHelper.getPlayer()?.getVideoData?.call(void 0)}static getVolume(){let player=YoutubeHelper.getPlayer();return player?.getVolume?player.getVolume()/100:1}static setVolume(volume){let player=YoutubeHelper.getPlayer();return player?.setVolume?(player.setVolume(Math.round(volume*100)),!0):!1}static isMuted(){let player=YoutubeHelper.getPlayer();return player?.isMuted?player.isMuted():!1}static videoSeek(video,time){_vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__.A.log(`videoSeek`,time);let preTime=YoutubeHelper.getPlayer()?.getProgressState()?.seekableEnd??video.currentTime,finalTime=preTime-time;video.currentTime=finalTime}static getPoToken(){let player=YoutubeHelper.getPlayer();if(!player)return;let audioTrack=player.getAudioTrack?.call(void 0);if(!audioTrack?.captionTracks?.length)return;let audioTrackWithPoToken=audioTrack.captionTracks.find(captionTrack=>captionTrack.url.includes(`&pot=`));if(audioTrackWithPoToken)return/&pot=([^&]+)/.exec(audioTrackWithPoToken.url)?.[1]}static getGlobalConfig(){return typeof yt<`u`?yt?.config_:typeof ytcfg<`u`?ytcfg?.data_:void 0}static getDeviceParams(){let ytconfig=YoutubeHelper.getGlobalConfig();if(!ytconfig)return`c=WEB`;let innertubeClient=ytconfig.INNERTUBE_CONTEXT?.client,deviceParams=new URLSearchParams(ytconfig.DEVICE);return deviceParams.delete(`ceng`),deviceParams.delete(`cengver`),deviceParams.set(`c`,innertubeClient?.clientName??ytconfig.INNERTUBE_CLIENT_NAME),deviceParams.set(`cver`,innertubeClient?.clientVersion??ytconfig.INNERTUBE_CLIENT_VERSION),deviceParams.set(`cplayer`,`UNIPLAYER`),deviceParams.toString()}static getSubtitles(userLang){let response=YoutubeHelper.getPlayerResponse(),playerCaptions=response?.captions?.playerCaptionsTracklistRenderer;if(!playerCaptions)return[];let captionTracks=playerCaptions.captionTracks??[],translationLanguages=playerCaptions.translationLanguages??[],userLangSupported=translationLanguages.find(language=>language.languageCode===userLang),asrSubtitleItem=captionTracks.find(captionTrack=>captionTrack?.kind===`asr`),asrLang=asrSubtitleItem?.languageCode??`en`,subtitles=captionTracks.reduce((result,captionTrack)=>{if(!(`languageCode`in captionTrack))return result;let language=captionTrack.languageCode?(0,_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_2__.ec)(captionTrack.languageCode):void 0,url=captionTrack.baseUrl;if(!language||!url)return result;let captionUrl=`${url.startsWith(`http`)?url:`${window.location.origin}/${url}`}&fmt=json3`;return result.push({source:`youtube`,format:`json`,language,isAutoGenerated:captionTrack?.kind===`asr`,url:captionUrl}),userLangSupported&&captionTrack.isTranslatable&&captionTrack.languageCode===asrLang&&userLang!==language&&result.push({source:`youtube`,format:`json`,language:userLang,isAutoGenerated:captionTrack?.kind===`asr`,translatedFromLanguage:language,url:`${captionUrl}&tlang=${userLang}`}),result},[]);return _vot_js_shared_utils_logger__WEBPACK_IMPORTED_MODULE_1__.A.log(`youtube subtitles:`,subtitles),subtitles}static getLanguage(){if(!YoutubeHelper.isMobile()){let player=YoutubeHelper.getPlayer(),trackInfo=player?.getAudioTrack?.call(void 0)?.getLanguageInfo();if(trackInfo&&trackInfo.id!==`und`)return(0,_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_2__.ec)(trackInfo.id.split(`.`)[0])}let response=YoutubeHelper.getPlayerResponse(),autoCaption=response?.captions?.playerCaptionsTracklistRenderer.captionTracks.find(caption=>caption.kind===`asr`&&caption.languageCode);return autoCaption?(0,_vot_js_shared_utils_utils__WEBPACK_IMPORTED_MODULE_2__.ec)(autoCaption.languageCode):void 0}async getVideoData(videoId){let{title:localizedTitle}=YoutubeHelper.getPlayerData()??{},{shortDescription:description,isLive:isStream,title}=YoutubeHelper.getPlayerResponse()?.videoDetails??{},subtitles=YoutubeHelper.getSubtitles(this.language),detectedLanguage=YoutubeHelper.getLanguage();detectedLanguage&&!_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_3__.xm.includes(detectedLanguage)&&(detectedLanguage=void 0);let duration=YoutubeHelper.getPlayer()?.getDuration?.call(void 0)??void 0;return{url:this.service.url+videoId,isStream,title,localizedTitle,detectedLanguage,description,subtitles,duration}}async getVideoId(url){if(url.hostname===`youtu.be`&&(url.search=`?v=${url.pathname.replace(`/`,``)}`,url.pathname=`/watch`),url.searchParams.has(`enablejsapi`)){let videoUrl=YoutubeHelper.getPlayer()?.getVideoUrl();url=videoUrl?new URL(videoUrl):url}return/(?:watch|embed|shorts|live)\/([^/]+)/.exec(url.pathname)?.[1]??url.searchParams.get(`v`)}}},"./node_modules/@vot.js/ext/dist/index.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{Ay:()=>_client_js__WEBPACK_IMPORTED_MODULE_0__.A,Pu:()=>_client_js__WEBPACK_IMPORTED_MODULE_0__.P});var _client_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/client.js`),_utils_videoData_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/ext/dist/utils/videoData.js`),_data_sites_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/ext/dist/data/sites.js`),_types_index_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/@vot.js/ext/dist/types/index.js`),_helpers_index_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/index.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_client_js__WEBPACK_IMPORTED_MODULE_0__]);_client_js__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0],__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./node_modules/@vot.js/ext/dist/types/index.js":(__unused_webpack___webpack_module__,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var _service_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/types/service.js`)},"./node_modules/@vot.js/ext/dist/types/service.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>ExtVideoService});var _vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/service.js`),ExtVideoService;(function(ExtVideoService){ExtVideoService.udemy=`udemy`,ExtVideoService.coursera=`coursera`,ExtVideoService.douyin=`douyin`,ExtVideoService.artstation=`artstation`,ExtVideoService.kickstarter=`kickstarter`,ExtVideoService.oraclelearn=`oraclelearn`,ExtVideoService.deeplearningai=`deeplearningai`,ExtVideoService.netacad=`netacad`})(ExtVideoService||={});let VideoService={..._vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r,...ExtVideoService}},"./node_modules/@vot.js/ext/dist/utils/videoData.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{cQ:()=>getService,jY:()=>getVideoID,o4:()=>getVideoData});var _vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/service.js`),_vot_js_core_utils_videoData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/core/dist/utils/videoData.js`),_data_sites_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/ext/dist/data/sites.js`),_helpers_index_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/index.js`);function getService(){if(_vot_js_core_utils_videoData__WEBPACK_IMPORTED_MODULE_1__.$.exec(window.location.href))return[];let hostname=window.location.hostname,enteredURL=new URL(window.location.href),isMatches=match=>match instanceof RegExp?match.test(hostname):typeof match==`string`?hostname.includes(match):typeof match==`function`?match(enteredURL):!1;return _data_sites_js__WEBPACK_IMPORTED_MODULE_2__.A.filter(e=>(Array.isArray(e.match)?e.match.some(isMatches):isMatches(e.match))&&e.host&&e.url)}async function getVideoID(service,opts={}){let url=new URL(window.location.href),serviceHost=service.host;if(Object.keys(_helpers_index_js__WEBPACK_IMPORTED_MODULE_3__.JW).includes(serviceHost)){let helper=new _helpers_index_js__WEBPACK_IMPORTED_MODULE_3__.Ay(opts).getHelper(serviceHost);return await helper.getVideoId(url)}return serviceHost===_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.custom?url.href:void 0}async function getVideoData(service,opts={}){let videoId=await getVideoID(service,opts);if(!videoId)throw new _vot_js_core_utils_videoData__WEBPACK_IMPORTED_MODULE_1__.A(`Entered unsupported link: "${service.host}"`);let origin=window.location.origin;if([_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.peertube,_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.coursehunterLike,_vot_js_core_types_service__WEBPACK_IMPORTED_MODULE_0__.r.cloudflarestream].includes(service.host)&&(service.url=origin),service.rawResult)return{url:videoId,videoId,host:service.host,duration:void 0};if(!service.needExtraData)return{url:service.url+videoId,videoId,host:service.host,duration:void 0};let helper=new _helpers_index_js__WEBPACK_IMPORTED_MODULE_3__.Ay({...opts,service,origin}).getHelper(service.host),result=await helper.getVideoData(videoId);if(!result)throw new _vot_js_core_utils_videoData__WEBPACK_IMPORTED_MODULE_1__.A(`Failed to get video raw url for ${service.host}`);return{...result,videoId,host:service.host}}},"./node_modules/@vot.js/shared/dist/data/alternativeUrls.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Jo:()=>sitesPiped,My:()=>sitesRicktube,TP:()=>sitesProxiTok,Xm:()=>sitesInvidious,fV:()=>sitesPeertube,r:()=>sitesCoursehunterLike,sx:()=>sitesPoketube});let sitesInvidious=[`yewtu.be`,`yt.artemislena.eu`,`invidious.flokinet.to`,`iv.melmac.space`,`inv.nadeko.net`,`inv.tux.pizza`,`invidious.private.coffee`,`yt.drgnz.club`,`vid.puffyan.us`,`invidious.dhusch.de`],sitesPiped=`piped.video,piped.tokhmi.xyz,piped.moomoo.me,piped.syncpundit.io,piped.mha.fi,watch.whatever.social,piped.garudalinux.org,efy.piped.pages.dev,watch.leptons.xyz,piped.lunar.icu,yt.dc09.ru,piped.mint.lgbt,il.ax,piped.privacy.com.de,piped.esmailelbob.xyz,piped.projectsegfau.lt,piped.in.projectsegfau.lt,piped.us.projectsegfau.lt,piped.privacydev.net,piped.palveluntarjoaja.eu,piped.smnz.de,piped.adminforge.de,piped.qdi.fi,piped.hostux.net,piped.chauvet.pro,piped.jotoma.de,piped.pfcd.me,piped.frontendfriendly.xyz`.split(`,`),sitesProxiTok=[`proxitok.pabloferreiro.es`,`proxitok.pussthecat.org`,`tok.habedieeh.re`,`proxitok.esmailelbob.xyz`,`proxitok.privacydev.net`,`tok.artemislena.eu`,`tok.adminforge.de`,`tt.vern.cc`,`cringe.whatever.social`,`proxitok.lunar.icu`,`proxitok.privacy.com.de`],sitesPeertube=[`peertube.1312.media`,`tube.shanti.cafe`,`bee-tube.fr`,`video.sadmin.io`,`dalek.zone`,`review.peertube.biz`,`peervideo.club`,`tube.la-dina.net`,`peertube.tmp.rcp.tf`,`peertube.su`,`video.blender.org`,`videos.viorsan.com`,`tube-sciences-technologies.apps.education.fr`,`tube-numerique-educatif.apps.education.fr`,`tube-arts-lettres-sciences-humaines.apps.education.fr`,`beetoons.tv`,`comics.peertube.biz`,`makertube.net`],sitesPoketube=[`poketube.fun`,`pt.sudovanilla.org`,`poke.ggtyler.dev`,`poke.uk2.littlekai.co.uk`,`poke.blahai.gay`],sitesRicktube=[`ricktube.ru`],sitesMaterialious=null,sitesCoursehunterLike=[`coursehunter.net`,`coursetrain.net`]},"./node_modules/@vot.js/shared/dist/data/config.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});let __WEBPACK_DEFAULT_EXPORT__={host:`api.browser.yandex.ru`,hostVOT:`vot.toil.cc/v1`,hostWorker:`vot-worker.toil.cc`,mediaProxy:`media-proxy.toil.cc`,userAgent:`Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 YaBrowser/25.4.0.0 Safari/537.36`,componentVersion:`25.4.4.543`,hmac:`bt8xH3VOlb4mqf0nqAibnDOoiPlXsisf`,defaultDuration:343,minChunkSize:5295308,loggerLevel:1,version:`2.4.10`}},"./node_modules/@vot.js/shared/dist/data/consts.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{EG:()=>subtitlesFormats,Xh:()=>availableTTS,xm:()=>availableLangs});let availableLangs=[`auto`,`ru`,`en`,`zh`,`ko`,`lt`,`lv`,`ar`,`fr`,`it`,`es`,`de`,`ja`],availableTTS=[`ru`,`en`,`kk`],subtitlesFormats=[`srt`,`vtt`,`json`]},"./node_modules/@vot.js/shared/dist/index.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$W:()=>config.A});var config=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`),yandex=__webpack_require__(`./node_modules/@vot.js/shared/dist/protos/yandex.js`),logger=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/logger.js`),utils=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/utils.js`),types_logger=__webpack_require__(`./node_modules/@vot.js/shared/dist/types/logger.js`),TypeName;(function(TypeName){TypeName.Channel=`Channel`,TypeName.Video=`Video`})(TypeName||={})},"./node_modules/@vot.js/shared/dist/protos/yandex.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q8:()=>StreamInterval,kO:()=>StreamPingRequest,Xv:()=>StreamTranslationRequest,n_:()=>StreamTranslationResponse,P4:()=>SubtitlesRequest,LD:()=>SubtitlesResponse,Y7:()=>VideoTranslationAudioRequest,Wi:()=>VideoTranslationAudioResponse,Yx:()=>VideoTranslationCacheRequest,ZK:()=>VideoTranslationCacheResponse,yy:()=>VideoTranslationRequest,AJ:()=>VideoTranslationResponse,ls:()=>YandexSessionRequest,Bv:()=>YandexSessionResponse});function varint64read(){let lowBits=0,highBits=0;for(let shift=0;shift<28;shift+=7){let b=this.buf[this.pos++];if(lowBits|=(b&127)<<shift,!(b&128))return this.assertBounds(),[lowBits,highBits]}let middleByte=this.buf[this.pos++];if(lowBits|=(middleByte&15)<<28,highBits=(middleByte&112)>>4,!(middleByte&128))return this.assertBounds(),[lowBits,highBits];for(let shift=3;shift<=31;shift+=7){let b=this.buf[this.pos++];if(highBits|=(b&127)<<shift,!(b&128))return this.assertBounds(),[lowBits,highBits]}throw Error(`invalid varint`)}function varint64write(lo,hi,bytes){for(let i=0;i<28;i+=7){let shift=lo>>>i,hasNext=!(!(shift>>>7)&&hi==0),byte=(hasNext?shift|128:shift)&255;if(bytes.push(byte),!hasNext)return}let splitBits=lo>>>28&15|(hi&7)<<4,hasMoreBits=!!(hi>>3);if(bytes.push((hasMoreBits?splitBits|128:splitBits)&255),hasMoreBits){for(let i=3;i<31;i+=7){let shift=hi>>>i,hasNext=!!(shift>>>7),byte=(hasNext?shift|128:shift)&255;if(bytes.push(byte),!hasNext)return}bytes.push(hi>>>31&1)}}let TWO_PWR_32_DBL=4294967296;function int64FromString(dec){let minus=dec[0]===`-`;minus&&(dec=dec.slice(1));let base=1e6,lowBits=0,highBits=0;function add1e6digit(begin,end){let digit1e6=Number(dec.slice(begin,end));highBits*=base,lowBits=lowBits*base+digit1e6,lowBits>=TWO_PWR_32_DBL&&(highBits+=lowBits/TWO_PWR_32_DBL|0,lowBits%=TWO_PWR_32_DBL)}return add1e6digit(-24,-18),add1e6digit(-18,-12),add1e6digit(-12,-6),add1e6digit(-6),minus?negate(lowBits,highBits):newBits(lowBits,highBits)}function int64ToString(lo,hi){let bits=newBits(lo,hi),negative=bits.hi&2147483648;negative&&(bits=negate(bits.lo,bits.hi));let result=uInt64ToString(bits.lo,bits.hi);return negative?`-`+result:result}function uInt64ToString(lo,hi){if({lo,hi}=toUnsigned(lo,hi),hi<=2097151)return String(TWO_PWR_32_DBL*hi+lo);let low=lo&16777215,mid=(lo>>>24|hi<<8)&16777215,high=hi>>16&65535,digitA=low+mid*6777216+high*6710656,digitB=mid+high*8147497,digitC=high*2,base=1e7;return digitA>=base&&(digitB+=Math.floor(digitA/base),digitA%=base),digitB>=base&&(digitC+=Math.floor(digitB/base),digitB%=base),digitC.toString()+decimalFrom1e7WithLeadingZeros(digitB)+decimalFrom1e7WithLeadingZeros(digitA)}function toUnsigned(lo,hi){return{lo:lo>>>0,hi:hi>>>0}}function newBits(lo,hi){return{lo:lo|0,hi:hi|0}}function negate(lowBits,highBits){return highBits=~highBits,lowBits?lowBits=~lowBits+1:highBits+=1,newBits(lowBits,highBits)}let decimalFrom1e7WithLeadingZeros=digit1e7=>{let partial=String(digit1e7);return`0000000`.slice(partial.length)+partial};function varint32write(value,bytes){if(value>=0){for(;value>127;)bytes.push(value&127|128),value>>>=7;bytes.push(value)}else{for(let i=0;i<9;i++)bytes.push(value&127|128),value>>=7;bytes.push(1)}}function varint32read(){let b=this.buf[this.pos++],result=b&127;if(!(b&128)||(b=this.buf[this.pos++],result|=(b&127)<<7,!(b&128))||(b=this.buf[this.pos++],result|=(b&127)<<14,!(b&128))||(b=this.buf[this.pos++],result|=(b&127)<<21,!(b&128)))return this.assertBounds(),result;b=this.buf[this.pos++],result|=(b&15)<<28;for(let readBytes=5;b&128&&readBytes<10;readBytes++)b=this.buf[this.pos++];if(b&128)throw Error(`invalid varint`);return this.assertBounds(),result>>>0}let protoInt64=makeInt64Support();function makeInt64Support(){let dv=new DataView(new ArrayBuffer(8)),ok=typeof BigInt==`function`&&typeof dv.getBigInt64==`function`&&typeof dv.getBigUint64==`function`&&typeof dv.setBigInt64==`function`&&typeof dv.setBigUint64==`function`&&(typeof process!=`object`||typeof process.env!=`object`||process.env.BUF_BIGINT_DISABLE!==`1`);if(ok){let MIN=BigInt(`-9223372036854775808`),MAX=BigInt(`9223372036854775807`),UMIN=BigInt(`0`),UMAX=BigInt(`18446744073709551615`);return{zero:BigInt(0),supported:!0,parse(value){let bi=typeof value==`bigint`?value:BigInt(value);if(bi>MAX||bi<MIN)throw Error(`invalid int64: ${value}`);return bi},uParse(value){let bi=typeof value==`bigint`?value:BigInt(value);if(bi>UMAX||bi<UMIN)throw Error(`invalid uint64: ${value}`);return bi},enc(value){return dv.setBigInt64(0,this.parse(value),!0),{lo:dv.getInt32(0,!0),hi:dv.getInt32(4,!0)}},uEnc(value){return dv.setBigInt64(0,this.uParse(value),!0),{lo:dv.getInt32(0,!0),hi:dv.getInt32(4,!0)}},dec(lo,hi){return dv.setInt32(0,lo,!0),dv.setInt32(4,hi,!0),dv.getBigInt64(0,!0)},uDec(lo,hi){return dv.setInt32(0,lo,!0),dv.setInt32(4,hi,!0),dv.getBigUint64(0,!0)}}}return{zero:`0`,supported:!1,parse(value){return typeof value!=`string`&&(value=value.toString()),assertInt64String(value),value},uParse(value){return typeof value!=`string`&&(value=value.toString()),assertUInt64String(value),value},enc(value){return typeof value!=`string`&&(value=value.toString()),assertInt64String(value),int64FromString(value)},uEnc(value){return typeof value!=`string`&&(value=value.toString()),assertUInt64String(value),int64FromString(value)},dec(lo,hi){return int64ToString(lo,hi)},uDec(lo,hi){return uInt64ToString(lo,hi)}}}function assertInt64String(value){if(!/^-?[0-9]+$/.test(value))throw Error(`invalid int64: `+value)}function assertUInt64String(value){if(!/^[0-9]+$/.test(value))throw Error(`invalid uint64: `+value)}let symbol=Symbol.for(`@bufbuild/protobuf/text-encoding`);function configureTextEncoding(textEncoding){globalThis[symbol]=textEncoding}function getTextEncoding(){if(globalThis[symbol]==null){let te=new globalThis.TextEncoder,td=new globalThis.TextDecoder;globalThis[symbol]={encodeUtf8(text){return te.encode(text)},decodeUtf8(bytes){return td.decode(bytes)},checkUtf8(text){try{return encodeURIComponent(text),!0}catch{return!1}}}}return globalThis[symbol]}var WireType;(function(WireType){WireType[WireType.Varint=0]=`Varint`,WireType[WireType.Bit64=1]=`Bit64`,WireType[WireType.LengthDelimited=2]=`LengthDelimited`,WireType[WireType.StartGroup=3]=`StartGroup`,WireType[WireType.EndGroup=4]=`EndGroup`,WireType[WireType.Bit32=5]=`Bit32`})(WireType||={});let FLOAT32_MAX=34028234663852886e22,FLOAT32_MIN=-34028234663852886e22,UINT32_MAX=4294967295,INT32_MAX=2147483647,INT32_MIN=-2147483648;class BinaryWriter{constructor(encodeUtf8=getTextEncoding().encodeUtf8){this.encodeUtf8=encodeUtf8,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let len=0;for(let i=0;i<this.chunks.length;i++)len+=this.chunks[i].length;let bytes=new Uint8Array(len),offset=0;for(let i=0;i<this.chunks.length;i++)bytes.set(this.chunks[i],offset),offset+=this.chunks[i].length;return this.chunks=[],bytes}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let chunk=this.finish(),prev=this.stack.pop();if(!prev)throw Error(`invalid state, fork stack empty`);return this.chunks=prev.chunks,this.buf=prev.buf,this.uint32(chunk.byteLength),this.raw(chunk)}tag(fieldNo,type){return this.uint32((fieldNo<<3|type)>>>0)}raw(chunk){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(chunk),this}uint32(value){for(assertUInt32(value);value>127;)this.buf.push(value&127|128),value>>>=7;return this.buf.push(value),this}int32(value){return assertInt32(value),varint32write(value,this.buf),this}bool(value){return this.buf.push(value?1:0),this}bytes(value){return this.uint32(value.byteLength),this.raw(value)}string(value){let chunk=this.encodeUtf8(value);return this.uint32(chunk.byteLength),this.raw(chunk)}float(value){assertFloat32(value);let chunk=new Uint8Array(4);return new DataView(chunk.buffer).setFloat32(0,value,!0),this.raw(chunk)}double(value){let chunk=new Uint8Array(8);return new DataView(chunk.buffer).setFloat64(0,value,!0),this.raw(chunk)}fixed32(value){assertUInt32(value);let chunk=new Uint8Array(4);return new DataView(chunk.buffer).setUint32(0,value,!0),this.raw(chunk)}sfixed32(value){assertInt32(value);let chunk=new Uint8Array(4);return new DataView(chunk.buffer).setInt32(0,value,!0),this.raw(chunk)}sint32(value){return assertInt32(value),value=(value<<1^value>>31)>>>0,varint32write(value,this.buf),this}sfixed64(value){let chunk=new Uint8Array(8),view=new DataView(chunk.buffer),tc=protoInt64.enc(value);return view.setInt32(0,tc.lo,!0),view.setInt32(4,tc.hi,!0),this.raw(chunk)}fixed64(value){let chunk=new Uint8Array(8),view=new DataView(chunk.buffer),tc=protoInt64.uEnc(value);return view.setInt32(0,tc.lo,!0),view.setInt32(4,tc.hi,!0),this.raw(chunk)}int64(value){let tc=protoInt64.enc(value);return varint64write(tc.lo,tc.hi,this.buf),this}sint64(value){let tc=protoInt64.enc(value),sign=tc.hi>>31,lo=tc.lo<<1^sign,hi=(tc.hi<<1|tc.lo>>>31)^sign;return varint64write(lo,hi,this.buf),this}uint64(value){let tc=protoInt64.uEnc(value);return varint64write(tc.lo,tc.hi,this.buf),this}}class BinaryReader{constructor(buf,decodeUtf8=getTextEncoding().decodeUtf8){this.decodeUtf8=decodeUtf8,this.varint64=varint64read,this.uint32=varint32read,this.buf=buf,this.len=buf.length,this.pos=0,this.view=new DataView(buf.buffer,buf.byteOffset,buf.byteLength)}tag(){let tag=this.uint32(),fieldNo=tag>>>3,wireType=tag&7;if(fieldNo<=0||wireType<0||wireType>5)throw Error(`illegal tag: field no `+fieldNo+` wire type `+wireType);return[fieldNo,wireType]}skip(wireType,fieldNo){let start=this.pos;switch(wireType){case WireType.Varint:for(;this.buf[this.pos++]&128;);break;case WireType.Bit64:this.pos+=4;case WireType.Bit32:this.pos+=4;break;case WireType.LengthDelimited:let len=this.uint32();this.pos+=len;break;case WireType.StartGroup:for(;;){let[fn,wt]=this.tag();if(wt===WireType.EndGroup){if(fieldNo!==void 0&&fn!==fieldNo)throw Error(`invalid end group tag`);break}this.skip(wt,fn)}break;default:throw Error(`cant skip wire type `+wireType)}return this.assertBounds(),this.buf.subarray(start,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError(`premature EOF`)}int32(){return this.uint32()|0}sint32(){let zze=this.uint32();return zze>>>1^-(zze&1)}int64(){return protoInt64.dec(...this.varint64())}uint64(){return protoInt64.uDec(...this.varint64())}sint64(){let[lo,hi]=this.varint64(),s=-(lo&1);return lo=(lo>>>1|(hi&1)<<31)^s,hi=hi>>>1^s,protoInt64.dec(lo,hi)}bool(){let[lo,hi]=this.varint64();return lo!==0||hi!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return protoInt64.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return protoInt64.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let len=this.uint32(),start=this.pos;return this.pos+=len,this.assertBounds(),this.buf.subarray(start,start+len)}string(){return this.decodeUtf8(this.bytes())}}function assertInt32(arg){if(typeof arg==`string`)arg=Number(arg);else if(typeof arg!=`number`)throw Error(`invalid int32: `+typeof arg);if(!Number.isInteger(arg)||arg>INT32_MAX||arg<INT32_MIN)throw Error(`invalid int32: `+arg)}function assertUInt32(arg){if(typeof arg==`string`)arg=Number(arg);else if(typeof arg!=`number`)throw Error(`invalid uint32: `+typeof arg);if(!Number.isInteger(arg)||arg>UINT32_MAX||arg<0)throw Error(`invalid uint32: `+arg)}function assertFloat32(arg){if(typeof arg==`string`){let o=arg;if(arg=Number(arg),isNaN(arg)&&o!==`NaN`)throw Error(`invalid float32: `+o)}else if(typeof arg!=`number`)throw Error(`invalid float32: `+typeof arg);if(Number.isFinite(arg)&&(arg>FLOAT32_MAX||arg<FLOAT32_MIN))throw Error(`invalid float32: `+arg)}let protobufPackage=``;var StreamInterval;(function(StreamInterval){StreamInterval[StreamInterval.NO_CONNECTION=0]=`NO_CONNECTION`,StreamInterval[StreamInterval.TRANSLATING=10]=`TRANSLATING`,StreamInterval[StreamInterval.STREAMING=20]=`STREAMING`,StreamInterval[StreamInterval.UNRECOGNIZED=-1]=`UNRECOGNIZED`})(StreamInterval||={});function streamIntervalFromJSON(object){switch(object){case 0:case`NO_CONNECTION`:return StreamInterval.NO_CONNECTION;case 10:case`TRANSLATING`:return StreamInterval.TRANSLATING;case 20:case`STREAMING`:return StreamInterval.STREAMING;case-1:case`UNRECOGNIZED`:default:return StreamInterval.UNRECOGNIZED}}function streamIntervalToJSON(object){switch(object){case StreamInterval.NO_CONNECTION:return`NO_CONNECTION`;case StreamInterval.TRANSLATING:return`TRANSLATING`;case StreamInterval.STREAMING:return`STREAMING`;case StreamInterval.UNRECOGNIZED:default:return`UNRECOGNIZED`}}function createBaseVideoTranslationHelpObject(){return{target:``,targetUrl:``}}let VideoTranslationHelpObject={encode(message,writer=new BinaryWriter){return message.target!==``&&writer.uint32(10).string(message.target),message.targetUrl!==``&&writer.uint32(18).string(message.targetUrl),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationHelpObject();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.target=reader.string();continue;case 2:if(tag!==18)break;message.targetUrl=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{target:isSet(object.target)?globalThis.String(object.target):``,targetUrl:isSet(object.targetUrl)?globalThis.String(object.targetUrl):``}},toJSON(message){let obj={};return message.target!==``&&(obj.target=message.target),message.targetUrl!==``&&(obj.targetUrl=message.targetUrl),obj},create(base){return VideoTranslationHelpObject.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationHelpObject();return message.target=object.target??``,message.targetUrl=object.targetUrl??``,message}};function createBaseVideoTranslationRequest(){return{url:``,deviceId:void 0,firstRequest:!1,duration:0,unknown0:0,language:``,forceSourceLang:!1,unknown1:0,translationHelp:[],wasStream:!1,responseLanguage:``,unknown2:0,unknown3:0,bypassCache:!1,useLivelyVoice:!1,videoTitle:``}}let VideoTranslationRequest={encode(message,writer=new BinaryWriter){message.url!==``&&writer.uint32(26).string(message.url),message.deviceId!==void 0&&writer.uint32(34).string(message.deviceId),message.firstRequest!==!1&&writer.uint32(40).bool(message.firstRequest),message.duration!==0&&writer.uint32(49).double(message.duration),message.unknown0!==0&&writer.uint32(56).int32(message.unknown0),message.language!==``&&writer.uint32(66).string(message.language),message.forceSourceLang!==!1&&writer.uint32(72).bool(message.forceSourceLang),message.unknown1!==0&&writer.uint32(80).int32(message.unknown1);for(let v of message.translationHelp)VideoTranslationHelpObject.encode(v,writer.uint32(90).fork()).join();return message.wasStream!==!1&&writer.uint32(104).bool(message.wasStream),message.responseLanguage!==``&&writer.uint32(114).string(message.responseLanguage),message.unknown2!==0&&writer.uint32(120).int32(message.unknown2),message.unknown3!==0&&writer.uint32(128).int32(message.unknown3),message.bypassCache!==!1&&writer.uint32(136).bool(message.bypassCache),message.useLivelyVoice!==!1&&writer.uint32(144).bool(message.useLivelyVoice),message.videoTitle!==``&&writer.uint32(154).string(message.videoTitle),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 3:if(tag!==26)break;message.url=reader.string();continue;case 4:if(tag!==34)break;message.deviceId=reader.string();continue;case 5:if(tag!==40)break;message.firstRequest=reader.bool();continue;case 6:if(tag!==49)break;message.duration=reader.double();continue;case 7:if(tag!==56)break;message.unknown0=reader.int32();continue;case 8:if(tag!==66)break;message.language=reader.string();continue;case 9:if(tag!==72)break;message.forceSourceLang=reader.bool();continue;case 10:if(tag!==80)break;message.unknown1=reader.int32();continue;case 11:if(tag!==90)break;message.translationHelp.push(VideoTranslationHelpObject.decode(reader,reader.uint32()));continue;case 13:if(tag!==104)break;message.wasStream=reader.bool();continue;case 14:if(tag!==114)break;message.responseLanguage=reader.string();continue;case 15:if(tag!==120)break;message.unknown2=reader.int32();continue;case 16:if(tag!==128)break;message.unknown3=reader.int32();continue;case 17:if(tag!==136)break;message.bypassCache=reader.bool();continue;case 18:if(tag!==144)break;message.useLivelyVoice=reader.bool();continue;case 19:if(tag!==154)break;message.videoTitle=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{url:isSet(object.url)?globalThis.String(object.url):``,deviceId:isSet(object.deviceId)?globalThis.String(object.deviceId):void 0,firstRequest:isSet(object.firstRequest)?globalThis.Boolean(object.firstRequest):!1,duration:isSet(object.duration)?globalThis.Number(object.duration):0,unknown0:isSet(object.unknown0)?globalThis.Number(object.unknown0):0,language:isSet(object.language)?globalThis.String(object.language):``,forceSourceLang:isSet(object.forceSourceLang)?globalThis.Boolean(object.forceSourceLang):!1,unknown1:isSet(object.unknown1)?globalThis.Number(object.unknown1):0,translationHelp:globalThis.Array.isArray(object?.translationHelp)?object.translationHelp.map(e=>VideoTranslationHelpObject.fromJSON(e)):[],wasStream:isSet(object.wasStream)?globalThis.Boolean(object.wasStream):!1,responseLanguage:isSet(object.responseLanguage)?globalThis.String(object.responseLanguage):``,unknown2:isSet(object.unknown2)?globalThis.Number(object.unknown2):0,unknown3:isSet(object.unknown3)?globalThis.Number(object.unknown3):0,bypassCache:isSet(object.bypassCache)?globalThis.Boolean(object.bypassCache):!1,useLivelyVoice:isSet(object.useLivelyVoice)?globalThis.Boolean(object.useLivelyVoice):!1,videoTitle:isSet(object.videoTitle)?globalThis.String(object.videoTitle):``}},toJSON(message){let obj={};return message.url!==``&&(obj.url=message.url),message.deviceId!==void 0&&(obj.deviceId=message.deviceId),message.firstRequest!==!1&&(obj.firstRequest=message.firstRequest),message.duration!==0&&(obj.duration=message.duration),message.unknown0!==0&&(obj.unknown0=Math.round(message.unknown0)),message.language!==``&&(obj.language=message.language),message.forceSourceLang!==!1&&(obj.forceSourceLang=message.forceSourceLang),message.unknown1!==0&&(obj.unknown1=Math.round(message.unknown1)),message.translationHelp?.length&&(obj.translationHelp=message.translationHelp.map(e=>VideoTranslationHelpObject.toJSON(e))),message.wasStream!==!1&&(obj.wasStream=message.wasStream),message.responseLanguage!==``&&(obj.responseLanguage=message.responseLanguage),message.unknown2!==0&&(obj.unknown2=Math.round(message.unknown2)),message.unknown3!==0&&(obj.unknown3=Math.round(message.unknown3)),message.bypassCache!==!1&&(obj.bypassCache=message.bypassCache),message.useLivelyVoice!==!1&&(obj.useLivelyVoice=message.useLivelyVoice),message.videoTitle!==``&&(obj.videoTitle=message.videoTitle),obj},create(base){return VideoTranslationRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationRequest();return message.url=object.url??``,message.deviceId=object.deviceId??void 0,message.firstRequest=object.firstRequest??!1,message.duration=object.duration??0,message.unknown0=object.unknown0??0,message.language=object.language??``,message.forceSourceLang=object.forceSourceLang??!1,message.unknown1=object.unknown1??0,message.translationHelp=object.translationHelp?.map(e=>VideoTranslationHelpObject.fromPartial(e))||[],message.wasStream=object.wasStream??!1,message.responseLanguage=object.responseLanguage??``,message.unknown2=object.unknown2??0,message.unknown3=object.unknown3??0,message.bypassCache=object.bypassCache??!1,message.useLivelyVoice=object.useLivelyVoice??!1,message.videoTitle=object.videoTitle??``,message}};function createBaseVideoTranslationResponse(){return{url:void 0,duration:void 0,status:0,remainingTime:void 0,unknown0:void 0,translationId:``,language:void 0,message:void 0,isLivelyVoice:!1,unknown2:void 0}}let VideoTranslationResponse={encode(message,writer=new BinaryWriter){return message.url!==void 0&&writer.uint32(10).string(message.url),message.duration!==void 0&&writer.uint32(17).double(message.duration),message.status!==0&&writer.uint32(32).int32(message.status),message.remainingTime!==void 0&&writer.uint32(40).int32(message.remainingTime),message.unknown0!==void 0&&writer.uint32(48).int32(message.unknown0),message.translationId!==``&&writer.uint32(58).string(message.translationId),message.language!==void 0&&writer.uint32(66).string(message.language),message.message!==void 0&&writer.uint32(74).string(message.message),message.isLivelyVoice!==!1&&writer.uint32(80).bool(message.isLivelyVoice),message.unknown2!==void 0&&writer.uint32(88).int32(message.unknown2),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationResponse();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.url=reader.string();continue;case 2:if(tag!==17)break;message.duration=reader.double();continue;case 4:if(tag!==32)break;message.status=reader.int32();continue;case 5:if(tag!==40)break;message.remainingTime=reader.int32();continue;case 6:if(tag!==48)break;message.unknown0=reader.int32();continue;case 7:if(tag!==58)break;message.translationId=reader.string();continue;case 8:if(tag!==66)break;message.language=reader.string();continue;case 9:if(tag!==74)break;message.message=reader.string();continue;case 10:if(tag!==80)break;message.isLivelyVoice=reader.bool();continue;case 11:if(tag!==88)break;message.unknown2=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{url:isSet(object.url)?globalThis.String(object.url):void 0,duration:isSet(object.duration)?globalThis.Number(object.duration):void 0,status:isSet(object.status)?globalThis.Number(object.status):0,remainingTime:isSet(object.remainingTime)?globalThis.Number(object.remainingTime):void 0,unknown0:isSet(object.unknown0)?globalThis.Number(object.unknown0):void 0,translationId:isSet(object.translationId)?globalThis.String(object.translationId):``,language:isSet(object.language)?globalThis.String(object.language):void 0,message:isSet(object.message)?globalThis.String(object.message):void 0,isLivelyVoice:isSet(object.isLivelyVoice)?globalThis.Boolean(object.isLivelyVoice):!1,unknown2:isSet(object.unknown2)?globalThis.Number(object.unknown2):void 0}},toJSON(message){let obj={};return message.url!==void 0&&(obj.url=message.url),message.duration!==void 0&&(obj.duration=message.duration),message.status!==0&&(obj.status=Math.round(message.status)),message.remainingTime!==void 0&&(obj.remainingTime=Math.round(message.remainingTime)),message.unknown0!==void 0&&(obj.unknown0=Math.round(message.unknown0)),message.translationId!==``&&(obj.translationId=message.translationId),message.language!==void 0&&(obj.language=message.language),message.message!==void 0&&(obj.message=message.message),message.isLivelyVoice!==!1&&(obj.isLivelyVoice=message.isLivelyVoice),message.unknown2!==void 0&&(obj.unknown2=Math.round(message.unknown2)),obj},create(base){return VideoTranslationResponse.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationResponse();return message.url=object.url??void 0,message.duration=object.duration??void 0,message.status=object.status??0,message.remainingTime=object.remainingTime??void 0,message.unknown0=object.unknown0??void 0,message.translationId=object.translationId??``,message.language=object.language??void 0,message.message=object.message??void 0,message.isLivelyVoice=object.isLivelyVoice??!1,message.unknown2=object.unknown2??void 0,message}};function createBaseVideoTranslationCacheItem(){return{status:0,remainingTime:void 0,message:void 0,unknown0:void 0}}let VideoTranslationCacheItem={encode(message,writer=new BinaryWriter){return message.status!==0&&writer.uint32(8).int32(message.status),message.remainingTime!==void 0&&writer.uint32(16).int32(message.remainingTime),message.message!==void 0&&writer.uint32(26).string(message.message),message.unknown0!==void 0&&writer.uint32(32).int32(message.unknown0),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationCacheItem();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==8)break;message.status=reader.int32();continue;case 2:if(tag!==16)break;message.remainingTime=reader.int32();continue;case 3:if(tag!==26)break;message.message=reader.string();continue;case 4:if(tag!==32)break;message.unknown0=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{status:isSet(object.status)?globalThis.Number(object.status):0,remainingTime:isSet(object.remainingTime)?globalThis.Number(object.remainingTime):void 0,message:isSet(object.message)?globalThis.String(object.message):void 0,unknown0:isSet(object.unknown0)?globalThis.Number(object.unknown0):void 0}},toJSON(message){let obj={};return message.status!==0&&(obj.status=Math.round(message.status)),message.remainingTime!==void 0&&(obj.remainingTime=Math.round(message.remainingTime)),message.message!==void 0&&(obj.message=message.message),message.unknown0!==void 0&&(obj.unknown0=Math.round(message.unknown0)),obj},create(base){return VideoTranslationCacheItem.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationCacheItem();return message.status=object.status??0,message.remainingTime=object.remainingTime??void 0,message.message=object.message??void 0,message.unknown0=object.unknown0??void 0,message}};function createBaseVideoTranslationCacheRequest(){return{url:``,duration:0,language:``,responseLanguage:``}}let VideoTranslationCacheRequest={encode(message,writer=new BinaryWriter){return message.url!==``&&writer.uint32(10).string(message.url),message.duration!==0&&writer.uint32(17).double(message.duration),message.language!==``&&writer.uint32(26).string(message.language),message.responseLanguage!==``&&writer.uint32(34).string(message.responseLanguage),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationCacheRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.url=reader.string();continue;case 2:if(tag!==17)break;message.duration=reader.double();continue;case 3:if(tag!==26)break;message.language=reader.string();continue;case 4:if(tag!==34)break;message.responseLanguage=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{url:isSet(object.url)?globalThis.String(object.url):``,duration:isSet(object.duration)?globalThis.Number(object.duration):0,language:isSet(object.language)?globalThis.String(object.language):``,responseLanguage:isSet(object.responseLanguage)?globalThis.String(object.responseLanguage):``}},toJSON(message){let obj={};return message.url!==``&&(obj.url=message.url),message.duration!==0&&(obj.duration=message.duration),message.language!==``&&(obj.language=message.language),message.responseLanguage!==``&&(obj.responseLanguage=message.responseLanguage),obj},create(base){return VideoTranslationCacheRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationCacheRequest();return message.url=object.url??``,message.duration=object.duration??0,message.language=object.language??``,message.responseLanguage=object.responseLanguage??``,message}};function createBaseVideoTranslationCacheResponse(){return{default:void 0,cloning:void 0}}let VideoTranslationCacheResponse={encode(message,writer=new BinaryWriter){return message.default!==void 0&&VideoTranslationCacheItem.encode(message.default,writer.uint32(10).fork()).join(),message.cloning!==void 0&&VideoTranslationCacheItem.encode(message.cloning,writer.uint32(18).fork()).join(),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationCacheResponse();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.default=VideoTranslationCacheItem.decode(reader,reader.uint32());continue;case 2:if(tag!==18)break;message.cloning=VideoTranslationCacheItem.decode(reader,reader.uint32());continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{default:isSet(object.default)?VideoTranslationCacheItem.fromJSON(object.default):void 0,cloning:isSet(object.cloning)?VideoTranslationCacheItem.fromJSON(object.cloning):void 0}},toJSON(message){let obj={};return message.default!==void 0&&(obj.default=VideoTranslationCacheItem.toJSON(message.default)),message.cloning!==void 0&&(obj.cloning=VideoTranslationCacheItem.toJSON(message.cloning)),obj},create(base){return VideoTranslationCacheResponse.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationCacheResponse();return message.default=object.default!==void 0&&object.default!==null?VideoTranslationCacheItem.fromPartial(object.default):void 0,message.cloning=object.cloning!==void 0&&object.cloning!==null?VideoTranslationCacheItem.fromPartial(object.cloning):void 0,message}};function createBaseAudioBufferObject(){return{audioFile:new Uint8Array,fileId:``}}let AudioBufferObject={encode(message,writer=new BinaryWriter){return message.audioFile.length!==0&&writer.uint32(18).bytes(message.audioFile),message.fileId!==``&&writer.uint32(10).string(message.fileId),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseAudioBufferObject();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 2:if(tag!==18)break;message.audioFile=reader.bytes();continue;case 1:if(tag!==10)break;message.fileId=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{audioFile:isSet(object.audioFile)?bytesFromBase64(object.audioFile):new Uint8Array,fileId:isSet(object.fileId)?globalThis.String(object.fileId):``}},toJSON(message){let obj={};return message.audioFile.length!==0&&(obj.audioFile=base64FromBytes(message.audioFile)),message.fileId!==``&&(obj.fileId=message.fileId),obj},create(base){return AudioBufferObject.fromPartial(base??{})},fromPartial(object){let message=createBaseAudioBufferObject();return message.audioFile=object.audioFile??new Uint8Array,message.fileId=object.fileId??``,message}};function createBasePartialAudioBufferObject(){return{audioFile:new Uint8Array,chunkId:0}}let PartialAudioBufferObject={encode(message,writer=new BinaryWriter){return message.audioFile.length!==0&&writer.uint32(18).bytes(message.audioFile),message.chunkId!==0&&writer.uint32(8).int32(message.chunkId),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBasePartialAudioBufferObject();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 2:if(tag!==18)break;message.audioFile=reader.bytes();continue;case 1:if(tag!==8)break;message.chunkId=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{audioFile:isSet(object.audioFile)?bytesFromBase64(object.audioFile):new Uint8Array,chunkId:isSet(object.chunkId)?globalThis.Number(object.chunkId):0}},toJSON(message){let obj={};return message.audioFile.length!==0&&(obj.audioFile=base64FromBytes(message.audioFile)),message.chunkId!==0&&(obj.chunkId=Math.round(message.chunkId)),obj},create(base){return PartialAudioBufferObject.fromPartial(base??{})},fromPartial(object){let message=createBasePartialAudioBufferObject();return message.audioFile=object.audioFile??new Uint8Array,message.chunkId=object.chunkId??0,message}};function createBaseChunkAudioObject(){return{audioBuffer:void 0,audioPartsLength:0,fileId:``,version:0}}let ChunkAudioObject={encode(message,writer=new BinaryWriter){return message.audioBuffer!==void 0&&PartialAudioBufferObject.encode(message.audioBuffer,writer.uint32(10).fork()).join(),message.audioPartsLength!==0&&writer.uint32(16).int32(message.audioPartsLength),message.fileId!==``&&writer.uint32(26).string(message.fileId),message.version!==0&&writer.uint32(32).int32(message.version),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseChunkAudioObject();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.audioBuffer=PartialAudioBufferObject.decode(reader,reader.uint32());continue;case 2:if(tag!==16)break;message.audioPartsLength=reader.int32();continue;case 3:if(tag!==26)break;message.fileId=reader.string();continue;case 4:if(tag!==32)break;message.version=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{audioBuffer:isSet(object.audioBuffer)?PartialAudioBufferObject.fromJSON(object.audioBuffer):void 0,audioPartsLength:isSet(object.audioPartsLength)?globalThis.Number(object.audioPartsLength):0,fileId:isSet(object.fileId)?globalThis.String(object.fileId):``,version:isSet(object.version)?globalThis.Number(object.version):0}},toJSON(message){let obj={};return message.audioBuffer!==void 0&&(obj.audioBuffer=PartialAudioBufferObject.toJSON(message.audioBuffer)),message.audioPartsLength!==0&&(obj.audioPartsLength=Math.round(message.audioPartsLength)),message.fileId!==``&&(obj.fileId=message.fileId),message.version!==0&&(obj.version=Math.round(message.version)),obj},create(base){return ChunkAudioObject.fromPartial(base??{})},fromPartial(object){let message=createBaseChunkAudioObject();return message.audioBuffer=object.audioBuffer!==void 0&&object.audioBuffer!==null?PartialAudioBufferObject.fromPartial(object.audioBuffer):void 0,message.audioPartsLength=object.audioPartsLength??0,message.fileId=object.fileId??``,message.version=object.version??0,message}};function createBaseVideoTranslationAudioRequest(){return{translationId:``,url:``,partialAudioInfo:void 0,audioInfo:void 0}}let VideoTranslationAudioRequest={encode(message,writer=new BinaryWriter){return message.translationId!==``&&writer.uint32(10).string(message.translationId),message.url!==``&&writer.uint32(18).string(message.url),message.partialAudioInfo!==void 0&&ChunkAudioObject.encode(message.partialAudioInfo,writer.uint32(34).fork()).join(),message.audioInfo!==void 0&&AudioBufferObject.encode(message.audioInfo,writer.uint32(50).fork()).join(),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationAudioRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.translationId=reader.string();continue;case 2:if(tag!==18)break;message.url=reader.string();continue;case 4:if(tag!==34)break;message.partialAudioInfo=ChunkAudioObject.decode(reader,reader.uint32());continue;case 6:if(tag!==50)break;message.audioInfo=AudioBufferObject.decode(reader,reader.uint32());continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{translationId:isSet(object.translationId)?globalThis.String(object.translationId):``,url:isSet(object.url)?globalThis.String(object.url):``,partialAudioInfo:isSet(object.partialAudioInfo)?ChunkAudioObject.fromJSON(object.partialAudioInfo):void 0,audioInfo:isSet(object.audioInfo)?AudioBufferObject.fromJSON(object.audioInfo):void 0}},toJSON(message){let obj={};return message.translationId!==``&&(obj.translationId=message.translationId),message.url!==``&&(obj.url=message.url),message.partialAudioInfo!==void 0&&(obj.partialAudioInfo=ChunkAudioObject.toJSON(message.partialAudioInfo)),message.audioInfo!==void 0&&(obj.audioInfo=AudioBufferObject.toJSON(message.audioInfo)),obj},create(base){return VideoTranslationAudioRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationAudioRequest();return message.translationId=object.translationId??``,message.url=object.url??``,message.partialAudioInfo=object.partialAudioInfo!==void 0&&object.partialAudioInfo!==null?ChunkAudioObject.fromPartial(object.partialAudioInfo):void 0,message.audioInfo=object.audioInfo!==void 0&&object.audioInfo!==null?AudioBufferObject.fromPartial(object.audioInfo):void 0,message}};function createBaseVideoTranslationAudioResponse(){return{status:0,remainingChunks:[]}}let VideoTranslationAudioResponse={encode(message,writer=new BinaryWriter){message.status!==0&&writer.uint32(8).int32(message.status);for(let v of message.remainingChunks)writer.uint32(18).string(v);return writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseVideoTranslationAudioResponse();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==8)break;message.status=reader.int32();continue;case 2:if(tag!==18)break;message.remainingChunks.push(reader.string());continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{status:isSet(object.status)?globalThis.Number(object.status):0,remainingChunks:globalThis.Array.isArray(object?.remainingChunks)?object.remainingChunks.map(e=>globalThis.String(e)):[]}},toJSON(message){let obj={};return message.status!==0&&(obj.status=Math.round(message.status)),message.remainingChunks?.length&&(obj.remainingChunks=message.remainingChunks),obj},create(base){return VideoTranslationAudioResponse.fromPartial(base??{})},fromPartial(object){let message=createBaseVideoTranslationAudioResponse();return message.status=object.status??0,message.remainingChunks=object.remainingChunks?.map(e=>e)||[],message}};function createBaseSubtitlesObject(){return{language:``,url:``,unknown0:0,translatedLanguage:``,translatedUrl:``,unknown1:0,unknown2:0}}let SubtitlesObject={encode(message,writer=new BinaryWriter){return message.language!==``&&writer.uint32(10).string(message.language),message.url!==``&&writer.uint32(18).string(message.url),message.unknown0!==0&&writer.uint32(24).int32(message.unknown0),message.translatedLanguage!==``&&writer.uint32(34).string(message.translatedLanguage),message.translatedUrl!==``&&writer.uint32(42).string(message.translatedUrl),message.unknown1!==0&&writer.uint32(48).int32(message.unknown1),message.unknown2!==0&&writer.uint32(56).int32(message.unknown2),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseSubtitlesObject();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.language=reader.string();continue;case 2:if(tag!==18)break;message.url=reader.string();continue;case 3:if(tag!==24)break;message.unknown0=reader.int32();continue;case 4:if(tag!==34)break;message.translatedLanguage=reader.string();continue;case 5:if(tag!==42)break;message.translatedUrl=reader.string();continue;case 6:if(tag!==48)break;message.unknown1=reader.int32();continue;case 7:if(tag!==56)break;message.unknown2=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{language:isSet(object.language)?globalThis.String(object.language):``,url:isSet(object.url)?globalThis.String(object.url):``,unknown0:isSet(object.unknown0)?globalThis.Number(object.unknown0):0,translatedLanguage:isSet(object.translatedLanguage)?globalThis.String(object.translatedLanguage):``,translatedUrl:isSet(object.translatedUrl)?globalThis.String(object.translatedUrl):``,unknown1:isSet(object.unknown1)?globalThis.Number(object.unknown1):0,unknown2:isSet(object.unknown2)?globalThis.Number(object.unknown2):0}},toJSON(message){let obj={};return message.language!==``&&(obj.language=message.language),message.url!==``&&(obj.url=message.url),message.unknown0!==0&&(obj.unknown0=Math.round(message.unknown0)),message.translatedLanguage!==``&&(obj.translatedLanguage=message.translatedLanguage),message.translatedUrl!==``&&(obj.translatedUrl=message.translatedUrl),message.unknown1!==0&&(obj.unknown1=Math.round(message.unknown1)),message.unknown2!==0&&(obj.unknown2=Math.round(message.unknown2)),obj},create(base){return SubtitlesObject.fromPartial(base??{})},fromPartial(object){let message=createBaseSubtitlesObject();return message.language=object.language??``,message.url=object.url??``,message.unknown0=object.unknown0??0,message.translatedLanguage=object.translatedLanguage??``,message.translatedUrl=object.translatedUrl??``,message.unknown1=object.unknown1??0,message.unknown2=object.unknown2??0,message}};function createBaseSubtitlesRequest(){return{url:``,language:``}}let SubtitlesRequest={encode(message,writer=new BinaryWriter){return message.url!==``&&writer.uint32(10).string(message.url),message.language!==``&&writer.uint32(18).string(message.language),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseSubtitlesRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.url=reader.string();continue;case 2:if(tag!==18)break;message.language=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{url:isSet(object.url)?globalThis.String(object.url):``,language:isSet(object.language)?globalThis.String(object.language):``}},toJSON(message){let obj={};return message.url!==``&&(obj.url=message.url),message.language!==``&&(obj.language=message.language),obj},create(base){return SubtitlesRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseSubtitlesRequest();return message.url=object.url??``,message.language=object.language??``,message}};function createBaseSubtitlesResponse(){return{waiting:!1,subtitles:[]}}let SubtitlesResponse={encode(message,writer=new BinaryWriter){message.waiting!==!1&&writer.uint32(8).bool(message.waiting);for(let v of message.subtitles)SubtitlesObject.encode(v,writer.uint32(18).fork()).join();return writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseSubtitlesResponse();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==8)break;message.waiting=reader.bool();continue;case 2:if(tag!==18)break;message.subtitles.push(SubtitlesObject.decode(reader,reader.uint32()));continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{waiting:isSet(object.waiting)?globalThis.Boolean(object.waiting):!1,subtitles:globalThis.Array.isArray(object?.subtitles)?object.subtitles.map(e=>SubtitlesObject.fromJSON(e)):[]}},toJSON(message){let obj={};return message.waiting!==!1&&(obj.waiting=message.waiting),message.subtitles?.length&&(obj.subtitles=message.subtitles.map(e=>SubtitlesObject.toJSON(e))),obj},create(base){return SubtitlesResponse.fromPartial(base??{})},fromPartial(object){let message=createBaseSubtitlesResponse();return message.waiting=object.waiting??!1,message.subtitles=object.subtitles?.map(e=>SubtitlesObject.fromPartial(e))||[],message}};function createBaseStreamTranslationObject(){return{url:``,timestamp:``}}let StreamTranslationObject={encode(message,writer=new BinaryWriter){return message.url!==``&&writer.uint32(10).string(message.url),message.timestamp!==``&&writer.uint32(18).string(message.timestamp),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseStreamTranslationObject();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.url=reader.string();continue;case 2:if(tag!==18)break;message.timestamp=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{url:isSet(object.url)?globalThis.String(object.url):``,timestamp:isSet(object.timestamp)?globalThis.String(object.timestamp):``}},toJSON(message){let obj={};return message.url!==``&&(obj.url=message.url),message.timestamp!==``&&(obj.timestamp=message.timestamp),obj},create(base){return StreamTranslationObject.fromPartial(base??{})},fromPartial(object){let message=createBaseStreamTranslationObject();return message.url=object.url??``,message.timestamp=object.timestamp??``,message}};function createBaseStreamTranslationRequest(){return{url:``,language:``,responseLanguage:``,unknown0:0,unknown1:0}}let StreamTranslationRequest={encode(message,writer=new BinaryWriter){return message.url!==``&&writer.uint32(10).string(message.url),message.language!==``&&writer.uint32(18).string(message.language),message.responseLanguage!==``&&writer.uint32(26).string(message.responseLanguage),message.unknown0!==0&&writer.uint32(40).int32(message.unknown0),message.unknown1!==0&&writer.uint32(48).int32(message.unknown1),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseStreamTranslationRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.url=reader.string();continue;case 2:if(tag!==18)break;message.language=reader.string();continue;case 3:if(tag!==26)break;message.responseLanguage=reader.string();continue;case 5:if(tag!==40)break;message.unknown0=reader.int32();continue;case 6:if(tag!==48)break;message.unknown1=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{url:isSet(object.url)?globalThis.String(object.url):``,language:isSet(object.language)?globalThis.String(object.language):``,responseLanguage:isSet(object.responseLanguage)?globalThis.String(object.responseLanguage):``,unknown0:isSet(object.unknown0)?globalThis.Number(object.unknown0):0,unknown1:isSet(object.unknown1)?globalThis.Number(object.unknown1):0}},toJSON(message){let obj={};return message.url!==``&&(obj.url=message.url),message.language!==``&&(obj.language=message.language),message.responseLanguage!==``&&(obj.responseLanguage=message.responseLanguage),message.unknown0!==0&&(obj.unknown0=Math.round(message.unknown0)),message.unknown1!==0&&(obj.unknown1=Math.round(message.unknown1)),obj},create(base){return StreamTranslationRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseStreamTranslationRequest();return message.url=object.url??``,message.language=object.language??``,message.responseLanguage=object.responseLanguage??``,message.unknown0=object.unknown0??0,message.unknown1=object.unknown1??0,message}};function createBaseStreamTranslationResponse(){return{interval:0,translatedInfo:void 0,pingId:void 0}}let StreamTranslationResponse={encode(message,writer=new BinaryWriter){return message.interval!==0&&writer.uint32(8).int32(message.interval),message.translatedInfo!==void 0&&StreamTranslationObject.encode(message.translatedInfo,writer.uint32(18).fork()).join(),message.pingId!==void 0&&writer.uint32(24).int32(message.pingId),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseStreamTranslationResponse();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==8)break;message.interval=reader.int32();continue;case 2:if(tag!==18)break;message.translatedInfo=StreamTranslationObject.decode(reader,reader.uint32());continue;case 3:if(tag!==24)break;message.pingId=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{interval:isSet(object.interval)?streamIntervalFromJSON(object.interval):0,translatedInfo:isSet(object.translatedInfo)?StreamTranslationObject.fromJSON(object.translatedInfo):void 0,pingId:isSet(object.pingId)?globalThis.Number(object.pingId):void 0}},toJSON(message){let obj={};return message.interval!==0&&(obj.interval=streamIntervalToJSON(message.interval)),message.translatedInfo!==void 0&&(obj.translatedInfo=StreamTranslationObject.toJSON(message.translatedInfo)),message.pingId!==void 0&&(obj.pingId=Math.round(message.pingId)),obj},create(base){return StreamTranslationResponse.fromPartial(base??{})},fromPartial(object){let message=createBaseStreamTranslationResponse();return message.interval=object.interval??0,message.translatedInfo=object.translatedInfo!==void 0&&object.translatedInfo!==null?StreamTranslationObject.fromPartial(object.translatedInfo):void 0,message.pingId=object.pingId??void 0,message}};function createBaseStreamPingRequest(){return{pingId:0}}let StreamPingRequest={encode(message,writer=new BinaryWriter){return message.pingId!==0&&writer.uint32(8).int32(message.pingId),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseStreamPingRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==8)break;message.pingId=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{pingId:isSet(object.pingId)?globalThis.Number(object.pingId):0}},toJSON(message){let obj={};return message.pingId!==0&&(obj.pingId=Math.round(message.pingId)),obj},create(base){return StreamPingRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseStreamPingRequest();return message.pingId=object.pingId??0,message}};function createBaseYandexSessionRequest(){return{uuid:``,module:``}}let YandexSessionRequest={encode(message,writer=new BinaryWriter){return message.uuid!==``&&writer.uint32(10).string(message.uuid),message.module!==``&&writer.uint32(18).string(message.module),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseYandexSessionRequest();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.uuid=reader.string();continue;case 2:if(tag!==18)break;message.module=reader.string();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{uuid:isSet(object.uuid)?globalThis.String(object.uuid):``,module:isSet(object.module)?globalThis.String(object.module):``}},toJSON(message){let obj={};return message.uuid!==``&&(obj.uuid=message.uuid),message.module!==``&&(obj.module=message.module),obj},create(base){return YandexSessionRequest.fromPartial(base??{})},fromPartial(object){let message=createBaseYandexSessionRequest();return message.uuid=object.uuid??``,message.module=object.module??``,message}};function createBaseYandexSessionResponse(){return{secretKey:``,expires:0}}let YandexSessionResponse={encode(message,writer=new BinaryWriter){return message.secretKey!==``&&writer.uint32(10).string(message.secretKey),message.expires!==0&&writer.uint32(16).int32(message.expires),writer},decode(input,length){let reader=input instanceof BinaryReader?input:new BinaryReader(input),end=length===void 0?reader.len:reader.pos+length,message=createBaseYandexSessionResponse();for(;reader.pos<end;){let tag=reader.uint32();switch(tag>>>3){case 1:if(tag!==10)break;message.secretKey=reader.string();continue;case 2:if(tag!==16)break;message.expires=reader.int32();continue}if((tag&7)==4||tag===0)break;reader.skip(tag&7)}return message},fromJSON(object){return{secretKey:isSet(object.secretKey)?globalThis.String(object.secretKey):``,expires:isSet(object.expires)?globalThis.Number(object.expires):0}},toJSON(message){let obj={};return message.secretKey!==``&&(obj.secretKey=message.secretKey),message.expires!==0&&(obj.expires=Math.round(message.expires)),obj},create(base){return YandexSessionResponse.fromPartial(base??{})},fromPartial(object){let message=createBaseYandexSessionResponse();return message.secretKey=object.secretKey??``,message.expires=object.expires??0,message}};function bytesFromBase64(b64){if(globalThis.Buffer)return Uint8Array.from(globalThis.Buffer.from(b64,`base64`));{let bin=globalThis.atob(b64),arr=new Uint8Array(bin.length);for(let i=0;i<bin.length;++i)arr[i]=bin.charCodeAt(i);return arr}}function base64FromBytes(arr){if(globalThis.Buffer)return globalThis.Buffer.from(arr).toString(`base64`);{let bin=[];return arr.forEach(byte=>{bin.push(globalThis.String.fromCharCode(byte))}),globalThis.btoa(bin.join(``))}}function isSet(value){return value!=null}},"./node_modules/@vot.js/shared/dist/secure.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C0:()=>getSecYaHeaders,MG:()=>browserSecHeaders,bT:()=>getHmacSha1,dD:()=>getSignature,yk:()=>getUUID});var _data_config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`),_utils_logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/logger.js`);let{componentVersion}=_data_config_js__WEBPACK_IMPORTED_MODULE_0__.A;async function getCrypto(){return typeof window<`u`&&window.crypto?window.crypto:await Promise.resolve().then(function(){var e=Error(`Cannot find module 'node:crypto'`);throw e.code=`MODULE_NOT_FOUND`,e})}let utf8Encoder=new TextEncoder;async function signHMAC(hashName,hmac,data){let crypto=await getCrypto(),key=await crypto.subtle.importKey(`raw`,utf8Encoder.encode(hmac),{name:`HMAC`,hash:{name:hashName}},!1,[`sign`,`verify`]);return await crypto.subtle.sign(`HMAC`,key,data)}async function getSignature(body){let signature=await signHMAC(`SHA-256`,_data_config_js__WEBPACK_IMPORTED_MODULE_0__.A.hmac,body);return new Uint8Array(signature).reduce((str,byte)=>str+byte.toString(16).padStart(2,`0`),``)}async function getSecYaHeaders(secType,session,body,path){let{secretKey,uuid}=session,token=`${uuid}:${path}:${componentVersion}`,tokenBody=utf8Encoder.encode(token),tokenSign=await getSignature(tokenBody);if(secType===`Ya-Summary`)return{[`X-${secType}-Sk`]:secretKey,[`X-${secType}-Token`]:`${tokenSign}:${token}`};let sign=await getSignature(body);return{[`${secType}-Signature`]:sign,[`Sec-${secType}-Sk`]:secretKey,[`Sec-${secType}-Token`]:`${tokenSign}:${token}`}}function getUUID(){let hexDigits=`0123456789ABCDEF`,uuid=``;for(let i=0;i<32;i++){let randomDigit=Math.floor(Math.random()*16);uuid+=hexDigits[randomDigit]}return uuid}async function getHmacSha1(hmacKey,salt){try{let hmacSalt=utf8Encoder.encode(salt),signature=await signHMAC(`SHA-1`,hmacKey,hmacSalt);return btoa(String.fromCharCode(...new Uint8Array(signature)))}catch(err){return _utils_logger_js__WEBPACK_IMPORTED_MODULE_1__.A.error(err),!1}}let browserSecHeaders={"sec-ch-ua":`"Chromium";v="134", "YaBrowser";v="${componentVersion.slice(0,5)}", "Not?A_Brand";v="24", "Yowser";v="2.5"`,"sec-ch-ua-full-version-list":`"Chromium";v="134.0.6998.543", "YaBrowser";v="${componentVersion}", "Not?A_Brand";v="24.0.0.0", "Yowser";v="2.5"`,"Sec-Fetch-Mode":`no-cors`}},"./node_modules/@vot.js/shared/dist/types/logger.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>LoggerLevel});var LoggerLevel;(function(LoggerLevel){LoggerLevel[LoggerLevel.DEBUG=0]=`DEBUG`,LoggerLevel[LoggerLevel.INFO=1]=`INFO`,LoggerLevel[LoggerLevel.WARN=2]=`WARN`,LoggerLevel[LoggerLevel.ERROR=3]=`ERROR`,LoggerLevel[LoggerLevel.SILENCE=4]=`SILENCE`})(LoggerLevel||={})},"./node_modules/@vot.js/shared/dist/utils/logger.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Logger});var _data_config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`),_types_logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/shared/dist/types/logger.js`);class Logger{static prefix=`[vot.js v${_data_config_js__WEBPACK_IMPORTED_MODULE_0__.A.version}]`;static canLog(level){return _data_config_js__WEBPACK_IMPORTED_MODULE_0__.A.loggerLevel<=level}static log(...messages){Logger.canLog(_types_logger_js__WEBPACK_IMPORTED_MODULE_1__.T.DEBUG)&&console.log(Logger.prefix,...messages)}static info(...messages){Logger.canLog(_types_logger_js__WEBPACK_IMPORTED_MODULE_1__.T.INFO)&&console.info(Logger.prefix,...messages)}static warn(...messages){Logger.canLog(_types_logger_js__WEBPACK_IMPORTED_MODULE_1__.T.WARN)&&console.warn(Logger.prefix,...messages)}static error(...messages){Logger.canLog(_types_logger_js__WEBPACK_IMPORTED_MODULE_1__.T.ERROR)&&console.error(Logger.prefix,...messages)}}},"./node_modules/@vot.js/shared/dist/utils/subs.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{vk:()=>convertSubs});function convertToStrTime(ms,delimiter=`,`){let seconds=ms/1e3,hours=Math.floor(seconds/3600),minutes=Math.floor(seconds%3600/60),remainingSeconds=Math.floor(seconds%60),milliseconds=Math.floor(ms%1e3);return`${hours.toString().padStart(2,`0`)}:${minutes.toString().padStart(2,`0`)}:${remainingSeconds.toString().padStart(2,`0`)}${delimiter}${milliseconds.toString().padStart(3,`0`)}`}function convertToMSTime(time){let parts=time.split(` `)?.[0]?.split(`:`);parts.length<3&&parts.unshift(`00`);let[strHours,strMinutes,strSeconds]=parts,secs=+strSeconds.replace(/[,.]/,``),mins=strMinutes*6e4,hours=strHours*36e5;return hours+mins+secs}function convertSubsFromJSON(data,output=`srt`){let isVTT=output===`vtt`,delimiter=isVTT?`.`:`,`,subs=data.subtitles.map((sub,idx)=>{let result=isVTT?``:`${idx+1}\n`;return result+`${convertToStrTime(sub.startMs,delimiter)} --> ${convertToStrTime(sub.startMs+sub.durationMs,delimiter)}\n${sub.text}\n\n`}).join(``).trim();return isVTT?`WEBVTT\n\n${subs}`:subs}function convertSubsToJSON(data,from=`srt`){let parts=data.split(/\r?\n\r?\n/g);from===`vtt`&&parts.shift(),/^\d+\r?\n/.exec(parts?.[0]??``)&&(from=`srt`);let offset=+(from===`srt`),subtitles=parts.reduce((result,part)=>{let lines=part.trim().split(`
`),time=lines[offset],text=lines.slice(offset+1).join(`
`);if((lines.length!==2||!part.includes(` --> `))&&!time?.includes(` --> `))return result.length===0||(result[result.length-1].text+=`\n\n${lines.join(`
`)}`),result;let[start,end]=time.split(` --> `),startMs=convertToMSTime(start),endMs=convertToMSTime(end),durationMs=endMs-startMs;return result.push({text,startMs,durationMs,speakerId:`0`}),result},[]);return{containsTokens:!1,subtitles}}function getSubsFormat(data){return typeof data==`string`?/^(WEBVTT([^\n]+)?)(\r?\n)/.exec(data)?`vtt`:`srt`:`json`}function convertSubs(data,output=`srt`){let from=getSubsFormat(data);return from===output?data:from===`json`?convertSubsFromJSON(data,output):(data=convertSubsToJSON(data,from),output===`json`?data:convertSubsFromJSON(data,output))}},"./node_modules/@vot.js/shared/dist/utils/utils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ec:()=>normalizeLang,fl:()=>proxyMedia,lg:()=>getTimestamp,u9:()=>fetchWithTimeout});var _data_config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`);let iso6392to6391={afr:`af`,aka:`ak`,alb:`sq`,amh:`am`,ara:`ar`,arm:`hy`,asm:`as`,aym:`ay`,aze:`az`,baq:`eu`,bel:`be`,ben:`bn`,bos:`bs`,bul:`bg`,bur:`my`,cat:`ca`,chi:`zh`,cos:`co`,cze:`cs`,dan:`da`,div:`dv`,dut:`nl`,eng:`en`,epo:`eo`,est:`et`,ewe:`ee`,fin:`fi`,fre:`fr`,fry:`fy`,geo:`ka`,ger:`de`,gla:`gd`,gle:`ga`,glg:`gl`,gre:`el`,grn:`gn`,guj:`gu`,hat:`ht`,hau:`ha`,hin:`hi`,hrv:`hr`,hun:`hu`,ibo:`ig`,ice:`is`,ind:`id`,ita:`it`,jav:`jv`,jpn:`ja`,kan:`kn`,kaz:`kk`,khm:`km`,kin:`rw`,kir:`ky`,kor:`ko`,kur:`ku`,lao:`lo`,lat:`la`,lav:`lv`,lin:`ln`,lit:`lt`,ltz:`lb`,lug:`lg`,mac:`mk`,mal:`ml`,mao:`mi`,mar:`mr`,may:`ms`,mlg:`mg`,mlt:`mt`,mon:`mn`,nep:`ne`,nor:`no`,nya:`ny`,ori:`or`,orm:`om`,pan:`pa`,per:`fa`,pol:`pl`,por:`pt`,pus:`ps`,que:`qu`,rum:`ro`,rus:`ru`,san:`sa`,sin:`si`,slo:`sk`,slv:`sl`,smo:`sm`,sna:`sn`,snd:`sd`,som:`so`,sot:`st`,spa:`es`,srp:`sr`,sun:`su`,swa:`sw`,swe:`sv`,tam:`ta`,tat:`tt`,tel:`te`,tgk:`tg`,tha:`th`,tir:`ti`,tso:`ts`,tuk:`tk`,tur:`tr`,uig:`ug`,ukr:`uk`,urd:`ur`,uzb:`uz`,vie:`vi`,wel:`cy`,xho:`xh`,yid:`yi`,yor:`yo`,zul:`zu`};async function fetchWithTimeout(url,options={headers:{"User-Agent":_data_config_js__WEBPACK_IMPORTED_MODULE_0__.A.userAgent}}){let{timeout=3e3,...fetchOptions}=options,controller=new AbortController,timeoutId=setTimeout(()=>controller.abort(),timeout),response=await fetch(url,{signal:controller.signal,...fetchOptions});return clearTimeout(timeoutId),response}function getTimestamp(){return Math.floor(Date.now()/1e3)}function normalizeLang(lang){return lang.length===3?iso6392to6391[lang]:lang.toLowerCase().split(/[_;-]/)[0].trim()}function proxyMedia(url,format=`mp4`){let generalUrl=`https://${_data_config_js__WEBPACK_IMPORTED_MODULE_0__.A.mediaProxy}/v1/proxy/video.${format}?format=base64&force=true`;return url instanceof URL?`${generalUrl}&url=${btoa(url.href)}&origin=${url.origin}&referer=${url.origin}`:`${generalUrl}&url=${btoa(url)}`}},"./node_modules/bowser/es5.js":function(module){(function(e,t){module.exports=t()})(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){typeof Symbol<`u`&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:`Module`}),Object.defineProperty(e,`__esModule`,{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t||4&t&&typeof e==`object`&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,`default`,{enumerable:!0,value:e}),2&t&&typeof e!=`string`)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,`a`,t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=``,r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||``},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||``},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case`NT`:return`NT`;case`XP`:return`XP`;case`NT 5.0`:return`2000`;case`NT 5.1`:return`XP`;case`NT 5.2`:return`2003`;case`NT 6.0`:return`Vista`;case`NT 6.1`:return`7`;case`NT 6.2`:return`8`;case`NT 6.3`:return`8.1`;case`NT 10.0`:return`10`;default:return}},e.getMacOSVersionName=function(e){var t=e.split(`.`).splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),t[0]===10)switch(t[1]){case 5:return`Leopard`;case 6:return`Snow Leopard`;case 7:return`Lion`;case 8:return`Mountain Lion`;case 9:return`Mavericks`;case 10:return`Yosemite`;case 11:return`El Capitan`;case 12:return`Sierra`;case 13:return`High Sierra`;case 14:return`Mojave`;case 15:return`Catalina`;default:return}},e.getAndroidVersionName=function(e){var t=e.split(`.`).splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),!(t[0]===1&&t[1]<5))return t[0]===1&&t[1]<6?`Cupcake`:t[0]===1&&t[1]>=6?`Donut`:t[0]===2&&t[1]<2?`Eclair`:t[0]===2&&t[1]===2?`Froyo`:t[0]===2&&t[1]>2?`Gingerbread`:t[0]===3?`Honeycomb`:t[0]===4&&t[1]<1?`Ice Cream Sandwich`:t[0]===4&&t[1]<4?`Jelly Bean`:t[0]===4&&t[1]>=4?`KitKat`:t[0]===5?`Lollipop`:t[0]===6?`Marshmallow`:t[0]===7?`Nougat`:t[0]===8?`Oreo`:t[0]===9?`Pie`:void 0},e.getVersionPrecision=function(e){return e.split(`.`).length},e.compareVersions=function(t,r,n){n===void 0&&(n=!1);var i=e.getVersionPrecision(t),s=e.getVersionPrecision(r),a=Math.max(i,s),o=0,u=e.map([t,r],function(t){var r=a-e.getVersionPrecision(t),n=t+Array(r+1).join(`.0`);return e.map(n.split(`.`),function(e){return Array(20-e.length).join(`0`)+e}).reverse()});for(n&&(o=a-Math.min(i,s)),--a;a>=o;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===o)return 0;--a}else if(u[0][a]<u[1][a])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(s));var o=function(){var e=s[t];typeof e==`object`&&e&&Object.keys(e).forEach(function(t){n[t]=e[t]})};for(t=0,r=s.length;t<r;t+=1)o();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||``},e}();t.default=i,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":`amazon_silk`,"Android Browser":`android`,Bada:`bada`,BlackBerry:`blackberry`,Chrome:`chrome`,Chromium:`chromium`,Electron:`electron`,Epiphany:`epiphany`,Firefox:`firefox`,Focus:`focus`,Generic:`generic`,"Google Search":`google_search`,Googlebot:`googlebot`,"Internet Explorer":`ie`,"K-Meleon":`k_meleon`,Maxthon:`maxthon`,"Microsoft Edge":`edge`,"MZ Browser":`mz`,"NAVER Whale Browser":`naver`,Opera:`opera`,"Opera Coast":`opera_coast`,PhantomJS:`phantomjs`,Puffin:`puffin`,QupZilla:`qupzilla`,QQ:`qq`,QQLite:`qqlite`,Safari:`safari`,Sailfish:`sailfish`,"Samsung Internet for Android":`samsung_internet`,SeaMonkey:`seamonkey`,Sleipnir:`sleipnir`,Swing:`swing`,Tizen:`tizen`,"UC Browser":`uc`,Vivaldi:`vivaldi`,"WebOS Browser":`webos`,WeChat:`wechat`,"Yandex Browser":`yandex`,Roku:`roku`},t.BROWSER_MAP={amazon_silk:`Amazon Silk`,android:`Android Browser`,bada:`Bada`,blackberry:`BlackBerry`,chrome:`Chrome`,chromium:`Chromium`,electron:`Electron`,epiphany:`Epiphany`,firefox:`Firefox`,focus:`Focus`,generic:`Generic`,googlebot:`Googlebot`,google_search:`Google Search`,ie:`Internet Explorer`,k_meleon:`K-Meleon`,maxthon:`Maxthon`,edge:`Microsoft Edge`,mz:`MZ Browser`,naver:`NAVER Whale Browser`,opera:`Opera`,opera_coast:`Opera Coast`,phantomjs:`PhantomJS`,puffin:`Puffin`,qupzilla:`QupZilla`,qq:`QQ Browser`,qqlite:`QQ Browser Lite`,safari:`Safari`,sailfish:`Sailfish`,samsung_internet:`Samsung Internet for Android`,seamonkey:`SeaMonkey`,sleipnir:`Sleipnir`,swing:`Swing`,tizen:`Tizen`,uc:`UC Browser`,vivaldi:`Vivaldi`,webos:`WebOS Browser`,wechat:`WeChat`,yandex:`Yandex Browser`},t.PLATFORMS_MAP={tablet:`tablet`,mobile:`mobile`,desktop:`desktop`,tv:`tv`},t.OS_MAP={WindowsPhone:`Windows Phone`,Windows:`Windows`,MacOS:`macOS`,iOS:`iOS`,Android:`Android`,WebOS:`WebOS`,BlackBerry:`BlackBerry`,Bada:`Bada`,Tizen:`Tizen`,Linux:`Linux`,ChromeOS:`Chrome OS`,PlayStation4:`PlayStation 4`,Roku:`Roku`},t.ENGINE_MAP={EdgeHTML:`EdgeHTML`,Blink:`Blink`,Trident:`Trident`,Presto:`Presto`,Gecko:`Gecko`,WebKit:`WebKit`}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},s=r(18);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,`value`in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(t===void 0&&(t=!1),typeof e!=`string`)throw Error(`UserAgent should be a string`);return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:`BROWSER_MAP`,get:function(){return s.BROWSER_MAP}},{key:`ENGINE_MAP`,get:function(){return s.ENGINE_MAP}},{key:`OS_MAP`,get:function(){return s.OS_MAP}},{key:`PLATFORMS_MAP`,get:function(){return s.PLATFORMS_MAP}}],(r=null)&&a(t.prototype,r),n&&a(t,n),e}();t.default=o,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=u(r(92)),i=u(r(93)),s=u(r(94)),a=u(r(95)),o=u(r(17));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(t===void 0&&(t=!1),e==null||e===``)throw Error(`UserAgent parameter can't be empty`);this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(n.default,function(t){if(typeof t.test==`function`)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error(`Browser's test function is not valid`)});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||``:this.getBrowser().name||``},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(i.default,function(t){if(typeof t.test==`function`)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error(`Browser's test function is not valid`)});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||``:t||``},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){e===void 0&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||``:t||``},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(s.default,function(t){if(typeof t.test==`function`)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error(`Browser's test function is not valid`)});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||``:this.getEngine().name||``},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(a.default,function(t){if(typeof t.test==`function`)return t.test(e);if(t.test instanceof Array)return t.test.some(function(t){return e.test(t)});throw Error(`Browser's test function is not valid`)});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},s=0;if(Object.keys(e).forEach(function(t){var a=e[t];typeof a==`string`?(i[t]=a,s+=1):typeof a==`object`&&(r[t]=a,n+=1)}),n>0){var a=Object.keys(r),u=o.default.find(a,function(e){return t.isOS(e)});if(u){var d=this.satisfies(r[u]);if(d!==void 0)return d}var c=o.default.find(a,function(e){return t.isPlatform(e)});if(c){var f=this.satisfies(r[c]);if(f!==void 0)return f}}if(s>0){var l=Object.keys(i),h=o.default.find(l,function(e){return t.isBrowser(e,!0)});if(h!==void 0)return this.compareVersion(i[h])}},t.isBrowser=function(e,t){t===void 0&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=o.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if(typeof i==`string`)return e[0]===`>`||e[0]===`<`?(r=e.substr(1),e[1]===`=`?(n=!0,r=e.substr(2)):t=[],e[0]===`>`?t.push(1):t.push(-1)):e[0]===`=`?r=e.substr(1):e[0]===`~`&&(n=!0,r=e.substr(1)),t.indexOf(o.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return t===void 0&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return e===void 0&&(e=[]),e.some(function(e){return t.is(e)})},e}();t.default=d,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:`Googlebot`},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:`Opera`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:`Opera`},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:`Samsung Internet for Android`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:`NAVER Whale Browser`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:`MZ Browser`},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:`Focus`},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:`Swing`},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:`Opera Coast`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:`Opera Touch`},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:`Yandex Browser`},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:`UC Browser`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:`Maxthon`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:`Epiphany`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:`Puffin`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:`Sleipnir`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:`K-Meleon`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:`WeChat`},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?`QQ Browser Lite`:`QQ Browser`},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:`Internet Explorer`},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:`Microsoft Edge`},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:`Microsoft Edge`},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:`Vivaldi`},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:`SeaMonkey`},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:`Sailfish`},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:`Amazon Silk`},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:`PhantomJS`},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:`SlimerJS`},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:`BlackBerry`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:`WebOS Browser`},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:`Bada`},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:`Tizen`},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:`QupZilla`},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:`Firefox`},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:`Electron`},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:`Miui`},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:`Chromium`},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:`Chrome`},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:`Google Search`},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:`Android Browser`},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:`PlayStation 4`},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:`Safari`},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=e.search(`\\(`)===-1?/^(.*)\/(.*) /:/^(.*)\/(.*)[ \t]\((.*)/;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:s.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:s.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:s.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,`.`),r=i.default.getMacOSVersionName(t),n={name:s.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,`.`);return{name:s.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:s.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:s.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:s.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:s.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:s.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18),a=[{test:[/googlebot/i],describe:function(){return{type:`bot`,vendor:`Google`}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&`Nova`,r={type:s.PLATFORMS_MAP.mobile,vendor:`Huawei`};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:`Nexus`}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:`Apple`,model:`iPad`}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:`Apple`,model:`iPad`}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:`Amazon`,model:`Kindle Fire HD 7`}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:`Amazon`}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:s.PLATFORMS_MAP.mobile,vendor:`Apple`,model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:`Nexus`}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return e.getBrowserName(!0)===`blackberry`},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:`BlackBerry`}}},{test:function(e){return e.getBrowserName(!0)===`bada`},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return e.getBrowserName()===`windows phone`},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:`Microsoft`}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(`.`)[0]);return e.getOSName(!0)===`android`&&t>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){return e.getOSName(!0)===`android`},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return e.getOSName(!0)===`macos`},describe:function(){return{type:s.PLATFORMS_MAP.desktop,vendor:`Apple`}}},{test:function(e){return e.getOSName(!0)===`windows`},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return e.getOSName(!0)===`linux`},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return e.getOSName(!0)===`playstation 4`},describe:function(){return{type:s.PLATFORMS_MAP.tv}}},{test:function(e){return e.getOSName(!0)===`roku`},describe:function(){return{type:s.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18),a=[{test:function(e){return e.getBrowserName(!0)===`microsoft edge`},describe:function(e){if(/\sedg\//i.test(e))return{name:s.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:s.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:s.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:s.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:s.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:s.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:s.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=a,e.exports=t.default}})})},"./node_modules/browser-id3-writer/dist/browser-id3-writer.mjs":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>o});function e(e){return String(e).split(``).map(e=>e.charCodeAt(0))}function t(t){return new Uint8Array(e(t))}function a(t){let a=new ArrayBuffer(2*t.length),r=new Uint8Array(a);return new Uint16Array(a).set(e(t)),r}function r(e){let t=255;return[e>>>24&t,e>>>16&t,e>>>8&t,e&t]}function n(e){return 11+e}function s(e,t,a,r){return 11+t+1+1+(r?2+2*(a+1):a+1)+e}function i(e){let t=0;return e.forEach(e=>{t+=2+2*e[0].length+2+2+2*e[1].length+2}),11+t}function c(e,t){let a=2*t,r=0;return e.forEach(e=>{r+=2+2*e[0].length+2+4}),18+a+2+r}class o{_setIntegerFrame(e,t){let a=parseInt(t,10);this.frames.push({name:e,value:a,size:n(a.toString().length)})}_setStringFrame(e,t){let a=t.toString(),r=13+2*a.length;e===`TDAT`&&(r=n(a.length)),this.frames.push({name:e,value:a,size:r})}_setPictureFrame(e,t,a,r){let n=function(e){if(!e||!e.length)return null;if(e[0]===255&&e[1]===216&&e[2]===255)return`image/jpeg`;if(e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71)return`image/png`;if(e[0]===71&&e[1]===73&&e[2]===70)return`image/gif`;if(e[8]===87&&e[9]===69&&e[10]===66&&e[11]===80)return`image/webp`;let t=e[0]===73&&e[1]===73&&e[2]===42&&e[3]===0,a=e[0]===77&&e[1]===77&&e[2]===0&&e[3]===42;return t||a?`image/tiff`:e[0]===66&&e[1]===77?`image/bmp`:e[0]===0&&e[1]===0&&e[2]===1&&e[3]===0?`image/x-icon`:null}(new Uint8Array(t)),i=a.toString();if(!n)throw Error(`Unknown picture MIME type`);a||(r=!1),this.frames.push({name:`APIC`,value:t,pictureType:e,mimeType:n,useUnicodeEncoding:r,description:i,size:s(t.byteLength,n.length,i.length,r)})}_setLyricsFrame(e,t,a){let r=e.split(``).map(e=>e.charCodeAt(0)),n=t.toString(),s=a.toString();var i,c;this.frames.push({name:`USLT`,value:s,language:r,description:n,size:(i=n.length,c=s.length,16+2*i+2+2+2*c)})}_setCommentFrame(e,t,a){let r=e.split(``).map(e=>e.charCodeAt(0)),n=t.toString(),s=a.toString();var i,c;this.frames.push({name:`COMM`,value:s,language:r,description:n,size:(i=n.length,c=s.length,16+2*i+2+2+2*c)})}_setPrivateFrame(e,t){let a=e.toString();var r,n;this.frames.push({name:`PRIV`,value:t,id:a,size:(r=a.length,n=t.byteLength,10+r+1+n)})}_setUserStringFrame(e,t){let a=e.toString(),r=t.toString();var n,s;this.frames.push({name:`TXXX`,description:a,value:r,size:(n=a.length,s=r.length,13+2*n+2+2+2*s)})}_setUrlLinkFrame(e,t){let a=t.toString();var r;this.frames.push({name:e,value:a,size:(r=a.length,10+r)})}_setPairedTextFrame(e,t){this.frames.push({name:e,value:t,size:i(t)})}_setSynchronisedLyricsFrame(e,t,a,r,n){let s=n.toString(),i=r.split(``).map(e=>e.charCodeAt(0));this.frames.push({name:`SYLT`,value:t,language:i,description:s,type:e,timestampFormat:a,size:c(t,s.length)})}constructor(e){if(!e||typeof e!=`object`||!(`byteLength`in e))throw Error(`First argument should be an instance of ArrayBuffer or Buffer`);this.arrayBuffer=e,this.padding=4096,this.frames=[],this.url=``}setFrame(e,t){switch(e){case`TPE1`:case`TCOM`:case`TCON`:{if(!Array.isArray(t))throw Error(`${e} frame value should be an array of strings`);let a=e===`TCON`?`;`:`/`,r=t.join(a);this._setStringFrame(e,r);break}case`TLAN`:case`TIT1`:case`TIT2`:case`TIT3`:case`TALB`:case`TPE2`:case`TPE3`:case`TPE4`:case`TRCK`:case`TPOS`:case`TMED`:case`TPUB`:case`TCOP`:case`TKEY`:case`TEXT`:case`TDAT`:case`TCMP`:case`TSRC`:this._setStringFrame(e,t);break;case`TBPM`:case`TLEN`:case`TYER`:this._setIntegerFrame(e,t);break;case`USLT`:if(t.language=t.language||`eng`,typeof t!=`object`||!(`description`in t)||!(`lyrics`in t))throw Error(`USLT frame value should be an object with keys description and lyrics`);if(t.language&&!t.language.match(/[a-z]{3}/i))throw Error(`Language must be coded following the ISO 639-2 standards`);this._setLyricsFrame(t.language,t.description,t.lyrics);break;case`APIC`:if(typeof t!=`object`||!(`type`in t)||!(`data`in t)||!(`description`in t))throw Error(`APIC frame value should be an object with keys type, data and description`);if(t.type<0||t.type>20)throw Error(`Incorrect APIC frame picture type`);this._setPictureFrame(t.type,t.data,t.description,!!t.useUnicodeEncoding);break;case`TXXX`:if(typeof t!=`object`||!(`description`in t)||!(`value`in t))throw Error(`TXXX frame value should be an object with keys description and value`);this._setUserStringFrame(t.description,t.value);break;case`WCOM`:case`WCOP`:case`WOAF`:case`WOAR`:case`WOAS`:case`WORS`:case`WPAY`:case`WPUB`:this._setUrlLinkFrame(e,t);break;case`COMM`:if(t.language=t.language||`eng`,typeof t!=`object`||!(`description`in t)||!(`text`in t))throw Error(`COMM frame value should be an object with keys description and text`);if(t.language&&!t.language.match(/[a-z]{3}/i))throw Error(`Language must be coded following the ISO 639-2 standards`);this._setCommentFrame(t.language,t.description,t.text);break;case`PRIV`:if(typeof t!=`object`||!(`id`in t)||!(`data`in t))throw Error(`PRIV frame value should be an object with keys id and data`);this._setPrivateFrame(t.id,t.data);break;case`IPLS`:if(!Array.isArray(t)||!Array.isArray(t[0]))throw Error(`IPLS frame value should be an array of pairs`);this._setPairedTextFrame(e,t);break;case`SYLT`:if(typeof t!=`object`||!(`type`in t)||!(`text`in t)||!(`timestampFormat`in t))throw Error(`SYLT frame value should be an object with keys type, text and timestampFormat`);if(!Array.isArray(t.text)||!Array.isArray(t.text[0]))throw Error(`SYLT frame text value should be an array of pairs`);if(t.type<0||t.type>6)throw Error(`Incorrect SYLT frame content type`);if(t.timestampFormat<1||t.timestampFormat>2)throw Error(`Incorrect SYLT frame time stamp format`);t.language=t.language||`eng`,t.description=t.description||``,this._setSynchronisedLyricsFrame(t.type,t.text,t.timestampFormat,t.language,t.description);break;default:throw Error(`Unsupported frame ${e}`)}return this}removeTag(){if(this.arrayBuffer.byteLength<10)return;let e=new Uint8Array(this.arrayBuffer),t=e[3],a=((r=[e[6],e[7],e[8],e[9]])[0]<<21)+(r[1]<<14)+(r[2]<<7)+r[3]+10;var r,n;(n=e)[0]!==73||n[1]!==68||n[2]!==51||t<2||t>4||(this.arrayBuffer=new Uint8Array(e.subarray(a)).buffer)}addTag(){this.removeTag();let e=[255,254],n=10+this.frames.reduce((e,t)=>e+t.size,0)+this.padding,s=new ArrayBuffer(this.arrayBuffer.byteLength+n),i=new Uint8Array(s),c=0,o=[];return o=[73,68,51,3],i.set(o,c),c+=o.length,c++,c++,o=function(e){let t=127;return[e>>>21&t,e>>>14&t,e>>>7&t,e&t]}(n-10),i.set(o,c),c+=o.length,this.frames.forEach(n=>{switch(o=t(n.name),i.set(o,c),c+=o.length,o=r(n.size-10),i.set(o,c),c+=o.length,c+=2,n.name){case`WCOM`:case`WCOP`:case`WOAF`:case`WOAR`:case`WOAS`:case`WORS`:case`WPAY`:case`WPUB`:o=t(n.value),i.set(o,c),c+=o.length;break;case`TPE1`:case`TCOM`:case`TCON`:case`TLAN`:case`TIT1`:case`TIT2`:case`TIT3`:case`TALB`:case`TPE2`:case`TPE3`:case`TPE4`:case`TRCK`:case`TPOS`:case`TKEY`:case`TMED`:case`TPUB`:case`TCOP`:case`TEXT`:case`TSRC`:o=[1].concat(e),i.set(o,c),c+=o.length,o=a(n.value),i.set(o,c),c+=o.length;break;case`TXXX`:case`USLT`:case`COMM`:o=[1],n.name!==`USLT`&&n.name!==`COMM`||(o=o.concat(n.language)),o=o.concat(e),i.set(o,c),c+=o.length,o=a(n.description),i.set(o,c),c+=o.length,o=[0,0].concat(e),i.set(o,c),c+=o.length,o=a(n.value),i.set(o,c),c+=o.length;break;case`TBPM`:case`TLEN`:case`TDAT`:case`TYER`:c++,o=t(n.value),i.set(o,c),c+=o.length;break;case`PRIV`:o=t(n.id),i.set(o,c),c+=o.length,c++,i.set(new Uint8Array(n.value),c),c+=n.value.byteLength;break;case`APIC`:o=[n.useUnicodeEncoding?1:0],i.set(o,c),c+=o.length,o=t(n.mimeType),i.set(o,c),c+=o.length,o=[0,n.pictureType],i.set(o,c),c+=o.length,n.useUnicodeEncoding?(o=[].concat(e),i.set(o,c),c+=o.length,o=a(n.description),i.set(o,c),c+=o.length,c+=2):(o=t(n.description),i.set(o,c),c+=o.length,c++),i.set(new Uint8Array(n.value),c),c+=n.value.byteLength;break;case`IPLS`:o=[1],i.set(o,c),c+=o.length,n.value.forEach(t=>{o=[].concat(e),i.set(o,c),c+=o.length,o=a(t[0].toString()),i.set(o,c),c+=o.length,o=[0,0].concat(e),i.set(o,c),c+=o.length,o=a(t[1].toString()),i.set(o,c),c+=o.length,o=[0,0],i.set(o,c),c+=o.length});break;case`SYLT`:o=[1].concat(n.language,n.timestampFormat,n.type),i.set(o,c),c+=o.length,o=[].concat(e),i.set(o,c),c+=o.length,o=a(n.description),i.set(o,c),c+=o.length,c+=2,n.value.forEach(t=>{o=[].concat(e),i.set(o,c),c+=o.length,o=a(t[0].toString()),i.set(o,c),c+=o.length,o=[0,0],i.set(o,c),c+=o.length,o=r(t[1]),i.set(o,c),c+=o.length})}}),c+=this.padding,i.set(new Uint8Array(this.arrayBuffer),c),this.arrayBuffer=s,s}getBlob(){return new Blob([this.arrayBuffer],{type:`audio/mpeg`})}getURL(){return this.url||=URL.createObjectURL(this.getBlob()),this.url}revokeURL(){URL.revokeObjectURL(this.url)}}},"./node_modules/chaimu/dist/index.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>Chaimu,GZ:()=>initAudioContext});let config={version:`1.0.6`,debug:!1,fetchFn:fetch.bind(window)},debug={log:(...text)=>{if(config.debug)return console.log(`%c✦ chaimu.js v${config.version} ✦`,`background: #000; color: #fff; padding: 0 8px`,...text)}},videoLipSyncEvents=[`playing`,`ratechange`,`play`,`waiting`,`pause`,`seeked`];function initAudioContext(){let audioContext=window.AudioContext||window.webkitAudioContext;return audioContext?new audioContext:void 0}class BasePlayer{static name=`BasePlayer`;chaimu;fetch;_src;fetchOpts;constructor(chaimu,src){this.chaimu=chaimu,this._src=src,this.fetch=this.chaimu.fetchFn,this.fetchOpts=this.chaimu.fetchOpts}async init(){return this}async clear(){return this}lipSync(_mode=!1){return this}handleVideoEvent=event=>(debug.log(`handle video ${event.type}`),this.lipSync(event.type),this);removeVideoEvents(){for(let e of videoLipSyncEvents)this.chaimu.video?.removeEventListener(e,this.handleVideoEvent);return this}addVideoEvents(){for(let e of videoLipSyncEvents)this.chaimu.video?.addEventListener(e,this.handleVideoEvent);return this}async play(){return this}async pause(){return this}get name(){return this.constructor.name}set src(url){this._src=url}get src(){return this._src}get currentSrc(){return this._src}set volume(_value){}get volume(){return 0}get playbackRate(){return 0}set playbackRate(_value){}get currentTime(){return 0}}class AudioPlayer extends BasePlayer{static name=`AudioPlayer`;audio;gainNode;audioSource;constructor(chaimu,src){super(chaimu,src),this.updateAudio()}initAudioBooster(){return this.chaimu.audioContext?(this.disconnectAudioNodes(),this.gainNode=this.chaimu.audioContext.createGain(),this.gainNode.connect(this.chaimu.audioContext.destination),this.audioSource=this.chaimu.audioContext.createMediaElementSource(this.audio),this.audioSource.connect(this.gainNode),this):this}disconnectAudioNodes(){this.audioSource&&(this.audioSource.disconnect(),this.audioSource=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0)}updateAudio(){return this.audio=new Audio(this.src),this.audio.crossOrigin=`anonymous`,this}async init(){return this.updateAudio(),this.initAudioBooster(),this}audioErrorHandle=e=>{console.error(`[AudioPlayer]`,e)};lipSync(mode=!1){if(debug.log(`[AudioPlayer] lipsync video`,this.chaimu.video),!this.chaimu.video)return this;if(this.audio.currentTime=this.chaimu.video.currentTime,this.audio.playbackRate=this.chaimu.video.playbackRate,!mode)return debug.log(`[AudioPlayer] lipsync mode isn't set`),this;switch(debug.log(`[AudioPlayer] lipsync mode is ${mode}`),mode){case`play`:case`playing`:case`seeked`:return this.chaimu.video.paused||this.syncPlay(),this;case`pause`:case`waiting`:return this.pause(),this;default:return this}}async clear(){return this.audio.pause(),this.audio.src=``,this.audio.removeAttribute(`src`),this.disconnectAudioNodes(),this}syncPlay(){return debug.log(`[AudioPlayer] sync play called`),this.audio&&this.audio.play().catch(this.audioErrorHandle),this}async play(){return debug.log(`[AudioPlayer] play called`),this.audio&&await this.audio.play().catch(this.audioErrorHandle),this}async pause(){return debug.log(`[AudioPlayer] pause called`),this.audio&&this.audio.pause(),this}set src(url){if(this._src=url,!url){this.clear();return}this.audio.src=url}get src(){return this._src}get currentSrc(){return this.audio.currentSrc}set volume(value){if(this.gainNode){this.gainNode.gain.value=value;return}this.audio.volume=value}get volume(){return this.gainNode?this.gainNode.gain.value:this.audio.volume}get playbackRate(){return this.audio.playbackRate}set playbackRate(value){this.audio.playbackRate=value}get currentTime(){return this.audio.currentTime}}class ChaimuPlayer extends BasePlayer{static name=`ChaimuPlayer`;audioBuffer;audioElement;mediaElementSource;gainNode;blobUrl;isClearing=!1;isInitializing=!1;clearingPromise;async fetchAudio(){if(!this._src)throw Error(`No audio source provided`);if(!this.chaimu.audioContext)throw Error(`No audio context available`);debug.log(`[ChaimuPlayer] Fetching audio from ${this._src}...`);let tempBlobUrl;try{let res=await this.fetch(this._src,this.fetchOpts);debug.log(`[ChaimuPlayer] Decoding fetched audio...`);let data=await res.arrayBuffer(),blob=new Blob([data]);tempBlobUrl=URL.createObjectURL(blob),this.audioBuffer=await this.chaimu.audioContext.decodeAudioData(data),this.blobUrl&&URL.revokeObjectURL(this.blobUrl),this.blobUrl=tempBlobUrl,tempBlobUrl=void 0}catch(err){throw tempBlobUrl&&URL.revokeObjectURL(tempBlobUrl),Error(`Failed to fetch audio file, because ${err.message}`)}return this}initAudioBooster(){return this.chaimu.audioContext?(this.disconnectAudioNodes(),this.gainNode=this.chaimu.audioContext.createGain(),this):this}disconnectAudioNodes(){this.mediaElementSource&&(this.mediaElementSource.disconnect(),this.mediaElementSource=void 0),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=void 0)}async init(){if(this.isInitializing)throw Error(`Initialization already in progress`);this.isInitializing=!0;try{return await this.fetchAudio(),this.initAudioBooster(),this.createAudioElement(),this}finally{this.isInitializing=!1}}createAudioElement(){if(!this.chaimu.audioContext)throw Error(`No audio context available`);if(!this.blobUrl)throw Error(`No blob URL available.`);let audio=new Audio(this.blobUrl);audio.crossOrigin=`anonymous`,`preservesPitch`in audio&&(audio.preservesPitch=!0,`mozPreservesPitch`in audio&&(audio.mozPreservesPitch=!0),`webkitPreservesPitch`in audio&&(audio.webkitPreservesPitch=!0)),this.audioElement=audio,this.mediaElementSource=this.chaimu.audioContext.createMediaElementSource(audio),this.mediaElementSource.connect(this.gainNode),this.gainNode.connect(this.chaimu.audioContext.destination)}lipSync(mode=!1){if(debug.log(`[ChaimuPlayer] lipsync video`,this.chaimu.video,this),!this.chaimu.video)return this;if(!mode)return debug.log(`[ChaimuPlayer] lipsync mode isn't set`),this;switch(debug.log(`[ChaimuPlayer] lipsync mode is ${mode}`),mode){case`play`:case`playing`:case`ratechange`:case`seeked`:return this.chaimu.video.paused||this.start(),this;case`pause`:case`waiting`:return this.pause(),this;default:return this}}async reopenCtx(){if(!this.chaimu.audioContext)throw Error(`No audio context available`);try{this.chaimu.audioContext.state!==`closed`&&await this.chaimu.audioContext.close()}catch(err){debug.log(`[ChaimuPlayer] Failed to close audio context:`,err)}return this.chaimu.audioContext=initAudioContext(),this}async clear(){if(this.isClearing&&this.clearingPromise)return this.clearingPromise;if(!this.chaimu.audioContext)throw Error(`No audio context available`);return debug.log(`clear audio context`),this.isClearing=!0,this.clearingPromise=(async()=>{try{await this.pause(),this.audioElement&&(this.audioElement.pause(),this.audioElement=void 0),this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0),this.disconnectAudioNodes();let oldVolume=this.gainNode?this.gainNode.gain.value:1;return await this.reopenCtx(),this.chaimu.audioContext&&(this.initAudioBooster(),this.volume=oldVolume),this}finally{this.isClearing=!1,this.clearingPromise=void 0}})(),this.clearingPromise}async start(){if(!this.chaimu.audioContext)throw Error(`No audio context available`);if(!this.audioElement)throw Error(`Audio element is missing`);return this.isClearing&&this.clearingPromise&&(debug.log(`The other cleaner is still running, waiting...`),await this.clearingPromise),debug.log(`starting audio via HTMLAudioElement`),await this.play(),this.chaimu.video&&(this.audioElement.currentTime=this.chaimu.video.currentTime,this.audioElement.playbackRate=this.chaimu.video.playbackRate),this.audioElement.play().catch(err=>debug.log(`[ChaimuPlayer] Play audioElement failed:`,err)),this}async pause(){if(!this.chaimu.audioContext)throw Error(`No audio context available`);return this.audioElement&&this.audioElement.pause(),this.chaimu.audioContext.state===`running`&&await this.chaimu.audioContext.suspend(),this}async play(){if(!this.chaimu.audioContext)throw Error(`No audio context available`);return await this.chaimu.audioContext.resume(),this}set src(url){this._src=url}get src(){return this._src}get currentSrc(){return this._src}set volume(value){this.gainNode&&(this.gainNode.gain.value=value)}get volume(){return this.gainNode?this.gainNode.gain.value:0}set playbackRate(value){this.audioElement&&(this.audioElement.playbackRate=value)}get playbackRate(){return this.audioElement?this.audioElement.playbackRate:this.chaimu.video?.playbackRate??1}get currentTime(){return this.chaimu.video?.currentTime??0}}class Chaimu{_debug=!1;audioContext;player;video;fetchFn;fetchOpts;constructor({url,video,debug=!1,fetchFn=config.fetchFn,fetchOpts={},preferAudio=!1}){this._debug=config.debug=debug,this.fetchFn=fetchFn,this.fetchOpts=fetchOpts,this.audioContext=initAudioContext(),this.player=this.audioContext&&!preferAudio?new ChaimuPlayer(this,url):new AudioPlayer(this,url),this.video=video}async init(){await this.player.init(),this.video&&!this.video.paused&&this.player.lipSync(`play`),this.player.addVideoEvents()}set debug(value){this._debug=config.debug=value}get debug(){return this._debug}}},"./node_modules/lit-html/lit-html.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{JW:()=>b,XX:()=>B,qy:()=>x});let t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(`lit-html`,{createHTML:t=>t}):void 0,e=`$lit$`,h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=`?`+h,n=`<${o}>`,r=document,l=()=>r.createComment(``),c=t=>t===null||typeof t!=`object`&&typeof t!=`function`,a=Array.isArray,u=t=>a(t)||typeof t?.[Symbol.iterator]==`function`,d=`[ 	
\f\r]`,f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,`g`),p=/'/g,g=/"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(`lit-noChange`),E=Symbol.for(`lit-nothing`),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(`raw`))throw Error(`invalid template strings array`);return s===void 0?i:s.createHTML(i)}let V=(t,i)=>{let s=t.length-1,o=[],r,l=i===2?`<svg>`:i===3?`<math>`:``,c=f;for(let i=0;i<s;i++){let s=t[i],a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),u!==null);)y=c.lastIndex,c===f?u[1]===`!--`?c=v:u[1]===void 0?u[2]===void 0?u[3]!==void 0&&(c=m):($.test(u[2])&&(r=RegExp(`</`+u[2],`g`)),c=m):c=_:c===m?u[0]===`>`?(c=r??f,d=-1):u[1]===void 0?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=u[3]===void 0?m:u[3]===`"`?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);let x=c===m&&t[i+1].startsWith(`/>`)?` `:``;l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(d===-2?i:x)}return[P(t,l+(t[s]||`<?>`)+(i===2?`</svg>`:i===3?`</math>`:``)),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0,u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,s===2||s===3){let t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;(r=C.nextNode())!==null&&d.length<u;){if(r.nodeType===1){if(r.hasAttributes())for(let t of r.getAttributeNames())if(t.endsWith(e)){let i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:e[1]===`.`?H:e[1]===`?`?I:e[1]===`@`?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){let t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:``;for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(r.nodeType===8)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;(t=r.data.indexOf(h,t+1))!==-1;)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){let s=r.createElement(`template`);return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=e===void 0?s._$Cl:s._$Co?.[e],o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),o===void 0?h=void 0:(h=new o(t),h._$AT(t,s,e)),e===void 0?s._$Cl=h:(s._$Co??=[])[e]=h),h!==void 0&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){let{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;l!==void 0;){if(o===l.index){let i;l.type===2?i=new R(h,h.nextSibling,this,t):l.type===1?i=new l.ctor(h,l.name,l.strings,this,t):l.type===6&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(let s of this._$AV)s!==void 0&&(s.strings===void 0?s._$AI(t[i]):(s._$AI(t,s,i),i+=s.strings.length-2)),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode,i=this._$AM;return i!==void 0&&t?.nodeType===11&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||t==null||t===``?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):t._$litType$===void 0?t.nodeType===void 0?u(t)?this.k(t):this._(t):this.T(t):this.$(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){let{values:i,_$litType$:s}=t,e=typeof s==`number`?this._$AC(t):(s.el===void 0&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{let t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return i===void 0&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());let i=this._$AH,s,e=0;for(let h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){let i=t.nextSibling;t.remove(),t=i}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||s[0]!==``||s[1]!==``?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){let h=this.strings,o=!1;if(h===void 0)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{let e=t,n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??``)+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??``)}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;let s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH==`function`?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}let Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(`3.3.0`);let B=(t,i,s)=>{let e=s?.renderBefore??i,h=e._$litPart$;if(h===void 0){let t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h}},"./node_modules/requestidlecallback-polyfill/index.js":()=>{window.requestIdleCallback=window.requestIdleCallback||function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)},window.cancelIdleCallback=window.cancelIdleCallback||function(id){clearTimeout(id)}},"./src/audioDownloader/iframe.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{q:()=>initAudioDownloaderIframe});var _vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/youtube.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/debug.ts`),_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/utils/iframeConnector.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/utils/utils.ts`),_shared__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/audioDownloader/shared.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__,_utils_utils__WEBPACK_IMPORTED_MODULE_3__]);[_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__,_utils_utils__WEBPACK_IMPORTED_MODULE_3__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;let lastMessageId=``,getAdaptiveFormats=()=>_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__.A.getPlayerResponse()?.streamingData?.adaptiveFormats;async function isEncodedRequest(url,request){if(!url.includes(`googlevideo.com/videoplayback`)||typeof request==`string`)return!1;try{let reader=request.clone().body?.getReader();if(!reader)return!1;let totalLength=0;for(;;){let{done,value}=await reader.read();if(done)break;if(totalLength+=value.length,totalLength>2)return!0}}catch{}return!1}function selectBestAudioFormat(){let allFormats=getAdaptiveFormats();if(!allFormats?.length){let reason=allFormats?`Empty adaptive formats`:`Cannot get adaptive formats`;throw Error(`Audio downloader. WEB API. ${reason}`)}let audioFormats=allFormats.filter(({audioQuality,mimeType})=>audioQuality||mimeType?.includes(`audio`));if(!audioFormats.length)throw Error(`Audio downloader. WEB API. No audio adaptive formats`);let itag251Sorted=audioFormats.filter(({itag})=>itag===251).sort(({contentLength:a},{contentLength:b})=>a&&b?Number.parseInt(a)-Number.parseInt(b):-1);return itag251Sorted.at(-1)??audioFormats[0]}let waitForPlayer=async()=>(await(0,_utils_utils__WEBPACK_IMPORTED_MODULE_3__.UV)(()=>!!_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__.A.getPlayer(),1e4),_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__.A.getPlayer());async function getDownloadAudioData(data){try{lastMessageId=data.messageId,_utils_debug__WEBPACK_IMPORTED_MODULE_1__.A.log(`getDownloadAudioData`,data);let originalFetch=unsafeWindow.fetch;unsafeWindow.fetch=async(input,init)=>{input instanceof URL&&(input=input.toString());let requestUrl=(0,_shared__WEBPACK_IMPORTED_MODULE_4__.rh)(input);if(await isEncodedRequest(requestUrl,input))return window.parent.postMessage({...data,messageDirection:`response`,error:`Audio downloader. Detected encoded request.`},`*`),unsafeWindow.fetch=originalFetch,originalFetch(input,init);let response=await originalFetch(input,init);return data.messageId===lastMessageId?(requestUrl.includes(`&itag=251&`)&&(unsafeWindow.fetch=originalFetch,window.parent.postMessage({...data,messageDirection:`response`,payload:{requestInfo:requestUrl,requestInit:init||(0,_shared__WEBPACK_IMPORTED_MODULE_4__.yA)(input),adaptiveFormat:selectBestAudioFormat(),itag:251}},`*`)),response):(unsafeWindow.fetch=originalFetch,response)};let player=await waitForPlayer();if(data.messageId!==lastMessageId)throw Error(`Audio downloader. Download started for another video while getting player`);if(!player?.loadVideoById)throw Error(`Audio downloader. There is no player.loadVideoById in iframe`);player.loadVideoById(data.payload.videoId),player.pauseVideo?.(),player.mute?.(),setTimeout(()=>{if(data.messageId!==lastMessageId){console.error(`Audio Downloader. Download started for another video while waiting to repause video`);return}if(!player){console.error(`[Critical] Audio Downloader. Player not found in iframe after timeout`);return}player.pauseVideo?.()},1e3)}catch(error){window.parent.postMessage({...data,messageDirection:`response`,error},`*`)}}let handleIframeMessage=async({data})=>{if(data?.messageDirection===`request`)try{switch(data.messageType){case`get-download-audio-data-in-iframe`:await getDownloadAudioData(data.payload);break;default:_utils_debug__WEBPACK_IMPORTED_MODULE_1__.A.log(`NOT IMPLEMENTED: ${data.messageType}`,data.payload)}}catch(error){console.error(`[VOT] Main world bridge`,{error})}};function initAudioDownloaderIframe(){return(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__.Io)(_shared__WEBPACK_IMPORTED_MODULE_4__.D5,handleIframeMessage)}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/audioDownloader/index.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{I:()=>AudioDownloader});var _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/core/eventImpl.ts`),_utils_debug__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/utils/debug.ts`),_strategies_webApiGetAllGeneratingUrlsData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/audioDownloader/strategies/webApiGetAllGeneratingUrlsData.ts`),_strategies_webApiSlow__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/audioDownloader/strategies/webApiSlow.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_strategies_webApiGetAllGeneratingUrlsData__WEBPACK_IMPORTED_MODULE_1__,_strategies_webApiSlow__WEBPACK_IMPORTED_MODULE_2__]);[_strategies_webApiGetAllGeneratingUrlsData__WEBPACK_IMPORTED_MODULE_1__,_strategies_webApiSlow__WEBPACK_IMPORTED_MODULE_2__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;async function handleCommonAudioDownloadRequest({audioDownloader,translationId,videoId,signal}){let audioData=await(0,_strategies_webApiGetAllGeneratingUrlsData__WEBPACK_IMPORTED_MODULE_1__.$)({videoId,returnByParts:!0,signal});if(!audioData)throw Error(`Audio downloader. Can not get audio data`);_utils_debug__WEBPACK_IMPORTED_MODULE_0__.A.log(`Audio downloader. Url found`,{audioDownloadType:`web_api_get_all_generating_urls_data_from_iframe`});let{getMediaBuffers,mediaPartsLength,fileId}=audioData;if(mediaPartsLength<2){let{value}=await getMediaBuffers().next();if(!value)throw Error(`Audio downloader. Empty audio`);audioDownloader.onDownloadedAudio.dispatch(translationId,{videoId,fileId,audioData:value});return}let index=0;for await(let audioChunk of getMediaBuffers()){if(!audioChunk)throw Error(`Audio downloader. Empty audio`);audioDownloader.onDownloadedPartialAudio.dispatch(translationId,{videoId,fileId,audioData:audioChunk,version:1,index,amount:mediaPartsLength}),index++}}async function mainWorldMessageHandler(event){try{let{data}=event;if(data?.messageDirection!==`request`)return;switch(data.messageType){case`get-video-id-from-player-on-main-page`:(0,_strategies_webApiSlow__WEBPACK_IMPORTED_MODULE_2__.RG)(event);break;case`get-adaptive-formats-on-video-page`:(0,_strategies_webApiSlow__WEBPACK_IMPORTED_MODULE_2__.m7)(event);break;case`decrypt-signature-in-main-world`:break;case`get-download-audio-data-in-main-world`:await(0,_strategies_webApiGetAllGeneratingUrlsData__WEBPACK_IMPORTED_MODULE_1__.Z)(data);break}}catch(error){console.error(`[VOT] Main world bridge`,{error})}}class AudioDownloader{onDownloadedAudio=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;onDownloadedPartialAudio=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;onDownloadAudioError=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;async runAudioDownload(videoId,translationId,signal){window.addEventListener(`message`,mainWorldMessageHandler);try{await handleCommonAudioDownloadRequest({audioDownloader:this,translationId,videoId,signal}),_utils_debug__WEBPACK_IMPORTED_MODULE_0__.A.log(`Audio downloader. Audio download finished`,{videoId})}catch(err){console.error(`Audio downloader. Failed to download audio`,err),this.onDownloadAudioError.dispatch(videoId)}window.removeEventListener(`message`,mainWorldMessageHandler)}addEventListener(type,listener){switch(type){case`downloadedAudio`:this.onDownloadedAudio.addListener(listener);break;case`downloadedPartialAudio`:this.onDownloadedPartialAudio.addListener(listener);break;case`downloadAudioError`:this.onDownloadAudioError.addListener(listener);break}return this}removeEventListener(type,listener){switch(type){case`downloadedAudio`:this.onDownloadedAudio.removeListener(listener);break;case`downloadedPartialAudio`:this.onDownloadedPartialAudio.removeListener(listener);break;case`downloadAudioError`:this.onDownloadAudioError.removeListener(listener);break}return this}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/audioDownloader/shared.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Aj:()=>MIN_CHUNK_RANGES_PART_SIZE,D5:()=>IFRAME_SERVICE,RZ:()=>deserializeRequestInit,SZ:()=>serializeResponse,cP:()=>ACCEPTABLE_LENGTH_DIFF,ds:()=>MIN_ARRAY_BUFFER_LENGTH,kV:()=>MIN_CONTENT_LENGTH_MULTIPLIER,ov:()=>IFRAME_HOST,pr:()=>IFRAME_ID,qk:()=>makeFileId,rh:()=>getRequestUrl,sU:()=>CHUNK_STEPS,yA:()=>serializeRequestInit});var _vot_js_shared__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/shared/dist/index.js`);let IFRAME_ID=`vot_iframe_player`,IFRAME_SERVICE=`service`,IFRAME_HOST=`www.youtube.com`,MIN_CHUNK_RANGES_PART_SIZE=_vot_js_shared__WEBPACK_IMPORTED_MODULE_0__.$W.minChunkSize,MIN_CONTENT_LENGTH_MULTIPLIER=.9,CHUNK_STEPS=[6e4,8e4,15e4,33e4,46e4],MIN_ARRAY_BUFFER_LENGTH=15e3,ACCEPTABLE_LENGTH_DIFF=.9,ANDROID_DESKTOP_AUDIO_ITAG=251,AUDIO_ITAGS=[ANDROID_DESKTOP_AUDIO_ITAG,140,141,250,249,139,256,258,325,327,328,338,171,172],PLAYER_MID_URL_PART=`/s/player/`,BASE_JS_FILE_NAME=`base.js`,getRequestUrl=request=>typeof request==`string`?request:request.url;function serializeRequestInit(request){let body=new Uint8Array([120,0]);if(typeof request==`string`)return{body,cache:`no-store`,credentials:`include`,method:`POST`};let{headers,cache,credentials,integrity,keepalive,method,mode,redirect,referrer,referrerPolicy}=request,headersEntries=[...headers.entries()];return{body,cache,credentials,headersEntries,integrity,keepalive,method,mode,redirect,referrer,referrerPolicy}}function deserializeRequestInit(request){let{headersEntries,...options}=request,headers=new Headers(headersEntries);return{...options,headers}}function serializeResponse(response){let{ok,redirected,status,statusText,type,url}=response;return{ok,redirected,status,statusText,type,url}}function makeFileId(downloadType,itag,fileSize){return JSON.stringify({downloadType,itag,minChunkSize:MIN_CHUNK_RANGES_PART_SIZE,fileSize})}let isFormatWithSignatureCipher=format=>format.signatureCipher!==void 0,isFormatWithUrl=format=>{let url=format.url;return typeof url==`string`&&url.length>0}},"./src/audioDownloader/strategies/webApiGetAllGeneratingUrlsData.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{$:()=>getAudioFromWebApiWithReplacedFetch,Z:()=>sendAudioDownloadRequestToIframe});var _vot_js_core_types_yandex__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/yandex.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/debug.ts`),_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/utils/iframeConnector.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/utils/utils.ts`),_shared__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/audioDownloader/shared.ts`),_utils_gm__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/gm.ts`),_webapi__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/audioDownloader/webapi.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__,_utils_utils__WEBPACK_IMPORTED_MODULE_3__,_utils_gm__WEBPACK_IMPORTED_MODULE_5__]);[_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__,_utils_utils__WEBPACK_IMPORTED_MODULE_3__,_utils_gm__WEBPACK_IMPORTED_MODULE_5__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;let serviceIframe=null,mediaQuaryIndex=1,textDecoder=new TextDecoder(`ascii`),SELECTED_STRATEGY=_vot_js_core_types_yandex__WEBPACK_IMPORTED_MODULE_0__.J.WEB_API_GET_ALL_GENERATING_URLS_DATA_FROM_IFRAME,GET_AUDIO_DATA_ERROR_MESSAGE=`Audio downloader. WEB API. Can not get getGeneratingAudioUrlsDataFromIframe due to timeout`,INCORRECT_FETCH_MEDIA_MESSAGE=`Audio downloader. WEB API. Incorrect response on fetch media url`,CANT_FETCH_MEDIA_MESSAGE=`Audio downloader. WEB API. Can not fetch media url`,CANT_GET_ARRAY_BUFFER_MESSAGE=`Audio downloader. WEB API. Can not get array buffer from media url`;async function sendAudioDownloadRequestToIframe(data){let{videoId}=data.payload,iframeUrl=`https://${_shared__WEBPACK_IMPORTED_MODULE_4__.ov}/embed/${videoId}?autoplay=0&mute=1`;try{let iframe=await(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__.IA)(serviceIframe,iframeUrl,_shared__WEBPACK_IMPORTED_MODULE_4__.pr,_shared__WEBPACK_IMPORTED_MODULE_4__.D5);if(!(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__.yB)(_shared__WEBPACK_IMPORTED_MODULE_4__.pr))throw Error(`Audio downloader. WEB API. Service iframe deleted`);iframe.contentWindow?.postMessage({messageId:(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__.Ok)(),messageType:`get-download-audio-data-in-iframe`,messageDirection:`request`,payload:data,error:data.error},`*`)}catch(err){data.error=err,data.messageDirection=`response`,window.postMessage(data,`*`)}}let getDownloadAudioDataInMainWorld=payload=>(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_2__.hG)(`get-download-audio-data-in-main-world`,payload);async function getGeneratingAudioUrlsDataFromIframe(videoId){try{return await Promise.race([getDownloadAudioDataInMainWorld({videoId}),(0,_utils_utils__WEBPACK_IMPORTED_MODULE_3__.wR)(2e4,GET_AUDIO_DATA_ERROR_MESSAGE)])}catch(err){let isTimeout=err instanceof Error&&err.message===GET_AUDIO_DATA_ERROR_MESSAGE;throw _utils_debug__WEBPACK_IMPORTED_MODULE_1__.A.log(`getGeneratingAudioUrlsDataFromIframe error`,err),Error(isTimeout?GET_AUDIO_DATA_ERROR_MESSAGE:`Audio downloader. WEB API. Failed to get audio data`)}}function patchMediaUrl(url,{start,end}){let modifiedUrl=new URL(url);return modifiedUrl.searchParams.set(`range`,`${start}-${end}`),modifiedUrl.searchParams.set(`rn`,String(mediaQuaryIndex++)),modifiedUrl.searchParams.delete(`ump`),modifiedUrl.toString()}function isChunkLengthAcceptable(buffer,{start,end}){let rangeLength=end-start;return rangeLength>_shared__WEBPACK_IMPORTED_MODULE_4__.ds&&buffer.byteLength<_shared__WEBPACK_IMPORTED_MODULE_4__.ds?!1:Math.min(rangeLength,buffer.byteLength)/Math.max(rangeLength,buffer.byteLength)>_shared__WEBPACK_IMPORTED_MODULE_4__.cP}let getUrlFromArrayBuffer=buffer=>{let match=textDecoder.decode(buffer).match(/https:\/\/.*$/);return match?.[0]??null};async function fetchMediaWithMeta({mediaUrl,chunkRange,requestInit,signal,isUrlChanged=!1}){let patchedUrl=patchMediaUrl(mediaUrl,chunkRange),response;try{if(response=await(0,_utils_gm__WEBPACK_IMPORTED_MODULE_5__.G3)(patchedUrl,{...requestInit,signal}),!response.ok){let errorDetails=(0,_shared__WEBPACK_IMPORTED_MODULE_4__.SZ)(response);throw console.error(INCORRECT_FETCH_MEDIA_MESSAGE,errorDetails),Error(INCORRECT_FETCH_MEDIA_MESSAGE)}}catch(err){throw err instanceof Error&&err.message===INCORRECT_FETCH_MEDIA_MESSAGE?err:(console.error(CANT_FETCH_MEDIA_MESSAGE,{mediaUrl:patchedUrl,error:err}),Error(CANT_FETCH_MEDIA_MESSAGE))}let arrayBuffer;try{arrayBuffer=await response.arrayBuffer()}catch(err){throw console.error(CANT_GET_ARRAY_BUFFER_MESSAGE,{mediaUrl:patchedUrl,error:err}),Error(CANT_GET_ARRAY_BUFFER_MESSAGE)}if(isChunkLengthAcceptable(arrayBuffer,chunkRange))return{media:arrayBuffer,url:isUrlChanged?mediaUrl:null,isAcceptableLast:!1};let redirectedUrl=getUrlFromArrayBuffer(arrayBuffer);if(redirectedUrl)return fetchMediaWithMeta({mediaUrl:redirectedUrl,chunkRange,requestInit,signal,isUrlChanged:!0});if(!chunkRange.mustExist)return{media:arrayBuffer,url:null,isAcceptableLast:!0};throw Error(`Audio downloader. WEB API. Can not get redirected media url ${patchedUrl}`)}async function fetchMediaWithMetaByChunkRanges(mediaUrl,requestInit,chunkRanges,signal){let currentUrl=mediaUrl,mediaBuffers=[],isAcceptableLast=!1;for(let chunkRange of chunkRanges){let result=await fetchMediaWithMeta({mediaUrl:currentUrl,chunkRange,requestInit,signal});if(result.url&&(currentUrl=result.url),mediaBuffers.push(result.media),isAcceptableLast=result.isAcceptableLast,isAcceptableLast)break}return{media:(0,_webapi__WEBPACK_IMPORTED_MODULE_6__.iz)(mediaBuffers),url:currentUrl,isAcceptableLast}}async function getAudioFromWebApiWithReplacedFetch({videoId,returnByParts=!1,signal}){let{requestInit,requestInfo,adaptiveFormat,itag}=await getGeneratingAudioUrlsDataFromIframe(videoId);if(!requestInfo)throw Error(`Audio downloader. WEB API. Can not get requestInfo`);let mediaUrl=(0,_shared__WEBPACK_IMPORTED_MODULE_4__.rh)(requestInfo),serializedInit=(0,_shared__WEBPACK_IMPORTED_MODULE_4__.yA)(requestInfo),fallbackInit=(0,_shared__WEBPACK_IMPORTED_MODULE_4__.RZ)(serializedInit),finalRequestInit=requestInit||fallbackInit;return{fileId:(0,_shared__WEBPACK_IMPORTED_MODULE_4__.qk)(SELECTED_STRATEGY,itag,adaptiveFormat.contentLength),mediaPartsLength:returnByParts?(0,_webapi__WEBPACK_IMPORTED_MODULE_6__.bB)(adaptiveFormat).length:1,async*getMediaBuffers(){if(returnByParts){let chunkParts=(0,_webapi__WEBPACK_IMPORTED_MODULE_6__.bB)(adaptiveFormat);for(let part of chunkParts){let{media,url,isAcceptableLast}=await fetchMediaWithMetaByChunkRanges(mediaUrl,finalRequestInit,part,signal);if(url&&(mediaUrl=url),yield media,isAcceptableLast)break}}else{let fullRange=(0,_webapi__WEBPACK_IMPORTED_MODULE_6__.Lm)(adaptiveFormat),{media}=await fetchMediaWithMetaByChunkRanges(mediaUrl,finalRequestInit,fullRange,signal);yield media}}}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/audioDownloader/strategies/webApiSlow.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{RG:()=>getVideoIdFromPlayerOnMainPage,m7:()=>getAdaptiveFormatsOnVideoPage});var _vot_js_core_types_yandex__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/yandex.js`),_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/iframeConnector.ts`),_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/youtube.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/utils/debug.ts`),_shared__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/audioDownloader/shared.ts`),_utils_gm__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/gm.ts`),_webapi__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/audioDownloader/webapi.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_1__,_utils_gm__WEBPACK_IMPORTED_MODULE_5__]);[_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_1__,_utils_gm__WEBPACK_IMPORTED_MODULE_5__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;let signatureCipherObjKeys=new Set([`sp`,`s`,`url`]),SELECTED_STRATEGY=_vot_js_core_types_yandex__WEBPACK_IMPORTED_MODULE_0__.J.WEB_API_SLOW,DESKTOP_YOUTUBE_LOCATION_ORIGIN=`https://www.youtube.com`,DECRYPT_SIGNATURE_FUNCTION_START=`a=a.split("")`,getVideoIdFromPlayerInMainWorld=()=>requestDataFromMainWorld(`get-video-id-from-player-on-main-page`),getAdaptiveFormatsOnVideoPageInMainWorld=()=>requestDataFromMainWorld(`get-adaptive-formats-on-video-page`);function getVideoIdFromPlayerOnMainPage(event){let playerResponse=_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__.A.getPlayerResponse(),videoId=playerResponse?.videoDetails?.videoId;return(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_1__.$2)(event,videoId)}function getAdaptiveFormatsOnVideoPage(event){let playerResponse=_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__.A.getPlayerResponse(),adaptiveFormats=playerResponse?.streamingData?.adaptiveFormats;return(0,_utils_iframeConnector__WEBPACK_IMPORTED_MODULE_1__.$2)(event,adaptiveFormats)}async function checkIsNativeVideoIdSameWithPlayer(videoId){let data=await getVideoIdFromPlayerInMainWorld();return data.videoId?data.videoId===videoId:!1}async function getAudioAdaptiveFormatsArrayOnVideoPage(){let adaptiveFormats=await getAdaptiveFormatsOnVideoPageInMainWorld();if(debug.log(`adaptive formats`,adaptiveFormats),!adaptiveFormats)throw Error(`Audio downloader. WEB API. Can not get adaptive formats`);if(!adaptiveFormats.length)throw Error(`Audio downloader. WEB API. Empty adaptive formats`);let audioFormats=adaptiveFormats.filter(({audioQuality,mimeType})=>audioQuality||mimeType?.includes(`audio`));if(!audioFormats.length)throw Error(`Audio downloader. WEB API. Empty audio adaptive formats`);return audioFormats}async function getAudioAdaptiveFormatOnVideoPageInMainWorld(){let audioFormats=await getAudioAdaptiveFormatsArrayOnVideoPage(),byItag={};for(let audioFormat of audioFormats)typeof audioFormat.itag==`number`&&(byItag[audioFormat.itag]=audioFormat);for(let itag of AUDIO_ITAGS)if(byItag[itag])return byItag[itag];return audioFormats[0]}let fetchLocationOriginText=async()=>{let response;try{response=await GM_fetch(location.origin)}catch{throw Error(`Audio downloader. WEB API. Can not fetch ${location.origin}`)}try{return await response.text()}catch{throw Error(`Audio downloader. WEB API. Can not get text from ${location.origin}`)}},getBaseJsUrlFromLocationOriginText=locationOriginText=>{if(!locationOriginText.includes(BASE_JS_FILE_NAME))throw Error(`Audio downloader. WEB API. Can not find: ${BASE_JS_FILE_NAME} in text from ${location.origin}`);let dynamicPath=locationOriginText.split(BASE_JS_FILE_NAME)[0].split(PLAYER_MID_URL_PART).pop();if(!dynamicPath)throw Error(`Audio downloader. WEB API. Can not find dynamic path to player in YouTube html from: ${location.origin}`);return DESKTOP_YOUTUBE_LOCATION_ORIGIN+PLAYER_MID_URL_PART+dynamicPath+BASE_JS_FILE_NAME},fetchBaseJsUrl=async()=>{let locationOriginText=await fetchLocationOriginText();if(!locationOriginText)throw Error(`Audio downloader. WEB API. Text from ${location.origin} is empty`);return getBaseJsUrlFromLocationOriginText(locationOriginText)},fetchBaseJsText=async url=>{if(!url)return;let response;try{response=await GM_fetch(url)}catch{throw Error(`Audio downloader. WEB API. Can not fetch base js url`)}try{return await response.text()}catch{throw Error(`Audio downloader. WEB API. Can not get text from base js url`)}};function getDecryptSignatureFunctionStringFromBaseJsText(baseJsText){if(!baseJsText.includes(DECRYPT_SIGNATURE_FUNCTION_START))throw Error(`Audio downloader. WEB API. Can not find decrypt signature function start: ${DECRYPT_SIGNATURE_FUNCTION_START} in base js url`);let functionContent=baseJsText.split(DECRYPT_SIGNATURE_FUNCTION_START).pop()?.split(`}`)[0];if(!functionContent)throw Error(`Audio downloader. WEB API. Can not find decrypt signature function content`);let contextName=functionContent.split(`.`)[0].split(`;`).pop();if(!contextName)throw Error(`Audio downloader. WEB API. Can not find context name inside decrypt signature function`);let functionCalls=functionContent.replace(RegExp(`${contextName}.`,`g`),``).split(`;`).map(str=>str.split(`(`)[0]);functionCalls.shift(),functionCalls.pop();let uniqueFnNames=[...new Set(functionCalls)],contextObjectCode=`{`;for(let fnName of uniqueFnNames){let searchToken=`${fnName}:function`;if(!baseJsText.includes(searchToken))throw Error(`Audio downloader. WEB API. Can not find context function start in base js text`);let fnBody=baseJsText.split(searchToken).pop()?.split(`}`)[0];if(!fnBody)throw Error(`Audio downloader. WEB API. Can not find context function content`);contextObjectCode+=`${fnName}: (() => function${fnBody}})(),`}return contextObjectCode+=`};`,`(() => (a) => { const ${contextName} = ${contextObjectCode} ${DECRYPT_SIGNATURE_FUNCTION_START}${functionContent}})();`}let getDecryptSignature=async()=>{try{let baseJsUrl=await fetchBaseJsUrl();if(!baseJsUrl)return;let baseJsText=await fetchBaseJsText(baseJsUrl);if(!baseJsText)return;let decryptSignatureFunctionString=getDecryptSignatureFunctionStringFromBaseJsText(baseJsText);if(!decryptSignatureFunctionString)return;try{return eval(decryptSignatureFunctionString)}catch(error){console.error(`Audio downloader. WEB API. Can not eval decrypt signature function string`,{decryptSignatureFunctionString,error})}}catch(error){console.error(error)}},convertSignatureCipherToObject=signatureCipher=>{let parts=signatureCipher.split(`&`),obj={};for(let part of parts){let[key,value]=part.split(`=`);signatureCipherObjKeys.has(key)&&(obj[key]=value)}if(!obj.s||!obj.sp||!obj.url)throw Error(`Audio downloader. WEB API. Signature cipher is not correct`);return{signatureName:obj.sp,signature:decodeURIComponent(obj.s),url:decodeURIComponent(obj.url)}},decryptSignatureCipher=async signatureCipher=>{let decryptSignature=await getDecryptSignature();if(!decryptSignature)return;let{signatureName,signature,url}=convertSignatureCipherToObject(signatureCipher);return`${url}&${signatureName}=${decryptSignature(signature)}`},getUrlFromAdaptiveFormat=audioFormat=>isFormatWithUrl(audioFormat)?audioFormat.url:isFormatWithSignatureCipher(audioFormat)&&typeof audioFormat.signatureCipher==`string`?decryptSignatureCipher(audioFormat.signatureCipher):void 0;async function getAudioFromWebApi({videoId}){if(!await checkIsNativeVideoIdSameWithPlayer(videoId))return;let audioFormat=await getAudioAdaptiveFormatOnVideoPageInMainWorld(),audioUrl=await getUrlFromAdaptiveFormat(audioFormat);if(!audioUrl)throw Error(`Audio downloader. WEB API. Can not get audio url`);let chunkRanges=getChunkRangesFromAdaptiveFormat(audioFormat),buffers=[];for(let chunkRange of chunkRanges){let chunkUrl=`${audioUrl}&range=${chunkRange.start}-${chunkRange.end}`,response;try{response=await GM_fetch(chunkUrl,{method:`POST`})}catch(error){throw debug.log(`Audio downloader. WEB API. Can not fetch audio url`,{audioUrl,error}),Error(`Audio downloader. WEB API. Can not fetch audio url`)}try{buffers.push(await response.arrayBuffer())}catch(error){throw debug.log(`Audio downloader. WEB API. Can not get array buffer from audio url`,{audioUrl,error}),Error(`Audio downloader. WEB API. Can not get array buffer from audio url`)}}return{mediaPartsLength:1,fileId:`${SELECTED_STRATEGY}_itag_${audioFormat.itag}`,async*getMediaBuffers(){yield mergeBuffers(buffers)}}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/audioDownloader/webapi.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Lm:()=>getChunkRangesFromAdaptiveFormat,bB:()=>getChunkRangesPartsFromAdaptiveFormat,iz:()=>mergeBuffers});var _shared__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/audioDownloader/shared.ts`);function getChunkRangesPartsFromContentLength(contentLength){if(contentLength<1)throw Error(`Audio downloader. WEB API. contentLength must be at least 1`);let minChunkSize=Math.round(contentLength*_shared__WEBPACK_IMPORTED_MODULE_0__.kV),parts=[],currentPart=[],currentPartSize=0,stepIndex=0,start=0,end=Math.min(_shared__WEBPACK_IMPORTED_MODULE_0__.sU[stepIndex],contentLength);for(;end<contentLength;){let mustExist=end<minChunkSize;currentPart.push({start,end,mustExist}),currentPartSize+=end-start,currentPartSize>=_shared__WEBPACK_IMPORTED_MODULE_0__.Aj&&(parts.push(currentPart),currentPart=[],currentPartSize=0),stepIndex<_shared__WEBPACK_IMPORTED_MODULE_0__.sU.length-1&&stepIndex++,start=end+1,end+=_shared__WEBPACK_IMPORTED_MODULE_0__.sU[stepIndex]}return end=contentLength,currentPart.push({start,end,mustExist:!1}),parts.push(currentPart),parts}function parseContentLength({contentLength}){if(typeof contentLength!=`string`)throw Error(`Audio downloader. WEB API. Content length (${contentLength}) is not a string`);let parsed=Number.parseInt(contentLength);if(!Number.isFinite(parsed))throw Error(`Audio downloader. WEB API. Parsed content length is not finite (${parsed})`);return parsed}function getChunkRangesPartsFromAdaptiveFormat(format){let contentLength=parseContentLength(format),chunkParts=getChunkRangesPartsFromContentLength(contentLength);if(!chunkParts.length)throw Error(`Audio downloader. WEB API. No chunk parts generated`);return chunkParts}function getChunkRangesFromContentLength(contentLength){if(contentLength<1)throw Error(`Audio downloader. WEB API. contentLength cannot be less than 1`);let minChunkSize=Math.round(contentLength*_shared__WEBPACK_IMPORTED_MODULE_0__.kV),chunkRanges=[],stepIndex=0,start=0,end=Math.min(_shared__WEBPACK_IMPORTED_MODULE_0__.sU[stepIndex],contentLength);for(;end<contentLength;){let mustExist=end<minChunkSize;chunkRanges.push({start,end,mustExist}),stepIndex!==_shared__WEBPACK_IMPORTED_MODULE_0__.sU.length-1&&stepIndex++,start=end+1,end+=_shared__WEBPACK_IMPORTED_MODULE_0__.sU[stepIndex]}return chunkRanges.push({start,end:contentLength,mustExist:!1}),chunkRanges}function getChunkRangesFromAdaptiveFormat(adaptiveFormat){let contentLength=parseContentLength(adaptiveFormat),chunkRanges=getChunkRangesFromContentLength(contentLength);if(!chunkRanges.length)throw Error(`Audio downloader. WEB API. Empty chunk ranges`);return chunkRanges}function mergeBuffers(buffers){let totalLength=buffers.reduce((total,buffer)=>total+buffer.byteLength,0),merged=new Uint8Array(totalLength),offset=0;for(let buffer of buffers)merged.set(new Uint8Array(buffer),offset),offset+=buffer.byteLength;return merged}},"./src/config/config.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ek:()=>repositoryUrl,JD:()=>defaultAutoVolume,K2:()=>defaultDetectService,Pm:()=>proxyWorkerHost,T8:()=>maxAudioVolume,Wl:()=>nonProxyExtensions,cL:()=>avatarServerUrl,hx:()=>contentUrl,k$:()=>foswlyTranslateUrl,mE:()=>defaultTranslationService,px:()=>minLongWaitingCount,qU:()=>defaultAutoHideDelay,r4:()=>actualCompatVersion,rl:()=>workerHost,se:()=>m3u8ProxyHost,sl:()=>detectRustServerUrl,tZ:()=>votBackendUrl,vZ:()=>proxyOnlyCountries,xW:()=>authServerUrl});let workerHost=`api.browser.yandex.ru`,m3u8ProxyHost=`media-proxy.toil.cc/v1/proxy/m3u8`,proxyWorkerHost=`vot-worker.toil.cc`,votBackendUrl=`https://vot.toil.cc/v1`,foswlyTranslateUrl=`https://translate.toil.cc/v2`,detectRustServerUrl=`https://rust-server-531j.onrender.com/detect`,authServerUrl=`https://t2mc.toil.cc`,avatarServerUrl=`https://avatars.mds.yandex.net/get-yapic`,repoPath=`ilyhalight/voice-over-translation`,contentUrl=`https://raw.githubusercontent.com/${repoPath}`,repositoryUrl=`https://github.com/${repoPath}`,defaultAutoVolume=15,maxAudioVolume=900,minLongWaitingCount=5,defaultTranslationService=`yandexbrowser`,defaultDetectService=`yandexbrowser`,nonProxyExtensions=[`Tampermonkey`,`Violentmonkey`],proxyOnlyCountries=[`UA`,`LV`,`LT`],defaultAutoHideDelay=1e3,actualCompatVersion=`2025-05-09`},"./src/core/auth.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{L:()=>initAuth});var _utils_storage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/utils/storage.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils_storage__WEBPACK_IMPORTED_MODULE_0__]);_utils_storage__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];async function handleAuthCallbackPage(){let{access_token:token,expires_in:expiresIn}=Object.fromEntries(new URLSearchParams(window.location.hash.slice(1)));if(!token||!expiresIn)throw Error(`[VOT] Invalid token response`);let numExpiresIn=parseInt(expiresIn);if(Number.isNaN(numExpiresIn))throw Error(`[VOT] Invalid expires_in value`);await _utils_storage__WEBPACK_IMPORTED_MODULE_0__.d.set(`account`,{token,expires:Date.now()+numExpiresIn*1e3,username:void 0,avatarId:void 0})}async function handleProfilePage(){let{avatar_id:avatarId,username}=_userData;if(!avatarId||!username)throw Error(`[VOT] Invalid user data`);let data=await _utils_storage__WEBPACK_IMPORTED_MODULE_0__.d.get(`account`);if(!data)throw Error(`[VOT] No account data found`);await _utils_storage__WEBPACK_IMPORTED_MODULE_0__.d.set(`account`,{...data,username,avatarId})}async function initAuth(){if(window.location.pathname===`/auth/callback`)return await handleAuthCallbackPage();if(window.location.pathname===`/my/profile`)return await handleProfilePage()}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/core/cacheManager.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{G:()=>CacheManager});class CacheManager{cache;constructor(){this.cache=new Map}get(key){return this.cache.get(key)}set(key,value){return this.cache.set(key,value),this}delete(key){return this.cache.delete(key),this}getTranslation(key){let entry=this.get(key);return entry?entry.translation:void 0}setTranslation(key,translation){let entry=this.get(key)||{};entry.translation=translation,this.set(key,entry)}getSubtitles(key){let entry=this.get(key);return entry?entry.subtitles:void 0}setSubtitles(key,subtitles){let entry=this.get(key)||{};entry.subtitles=subtitles,this.set(key,entry)}deleteSubtitles(key){let entry=this.get(key);entry&&(entry.subtitles=void 0,this.set(key,entry))}}},"./src/core/eventImpl.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>EventImpl});class EventImpl{listeners;constructor(){this.listeners=new Set}addListener(handler){if(this.listeners.has(handler))throw Error(`[VOT] The listener has already been added.`);this.listeners.add(handler)}removeListener(handler){this.listeners.delete(handler)}dispatch(...args){for(let handler of this.listeners)try{handler(...args)}catch(exception){console.error(`[VOT]`,exception)}}clear(){this.listeners.clear()}}},"./src/core/translationHandler.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{F:()=>VOTTranslationHandler});var _vot_js_core_types_yandex__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/core/dist/types/yandex.js`),_audioDownloader__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/audioDownloader/index.ts`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/localization/localizationProvider.ts`),_utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/utils/VOTLocalizedError.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/utils/debug.ts`),_utils_localization__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/localization.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_audioDownloader__WEBPACK_IMPORTED_MODULE_1__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_2__,_utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_3__,_utils_localization__WEBPACK_IMPORTED_MODULE_5__,_utils_utils__WEBPACK_IMPORTED_MODULE_6__]);[_audioDownloader__WEBPACK_IMPORTED_MODULE_1__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_2__,_utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_3__,_utils_localization__WEBPACK_IMPORTED_MODULE_5__,_utils_utils__WEBPACK_IMPORTED_MODULE_6__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class VOTTranslationHandler{videoHandler;audioDownloader;downloading;constructor(videoHandler){this.videoHandler=videoHandler,this.audioDownloader=new _audioDownloader__WEBPACK_IMPORTED_MODULE_1__.I,this.downloading=!1,this.audioDownloader.addEventListener(`downloadedAudio`,async(translationId,data)=>{if(_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`downloadedAudio`,data),!this.downloading){_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`skip downloadedAudio`);return}let{videoId,fileId,audioData}=data,videoUrl=this.getCanonicalUrl(videoId);try{await this.videoHandler.votClient.requestVtransAudio(videoUrl,translationId,{audioFile:audioData,fileId})}catch{}this.downloading=!1}).addEventListener(`downloadedPartialAudio`,async(translationId,data)=>{if(_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`downloadedPartialAudio`,data),!this.downloading){_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`skip downloadedPartialAudio`);return}let{audioData,fileId,videoId,amount,version,index}=data,videoUrl=this.getCanonicalUrl(videoId);try{await this.videoHandler.votClient.requestVtransAudio(videoUrl,translationId,{audioFile:audioData,chunkId:index},{audioPartsLength:amount,fileId,version})}catch{this.downloading=!1}index===amount-1&&(this.downloading=!1)}).addEventListener(`downloadAudioError`,async videoId=>{if(!this.downloading){_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`skip downloadAudioError`);return}_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Failed to download audio ${videoId}`);let videoUrl=this.getCanonicalUrl(videoId);await this.videoHandler.votClient.requestVtransFailAudio(videoUrl),this.downloading=!1})}getCanonicalUrl(videoId){return`https://youtu.be/${videoId}`}isWaitingStreamRes(data){return!!data.message}async translateVideoImpl(videoData,requestLang,responseLang,translationHelp=null,shouldSendFailedAudio=!1,signal=new AbortController().signal){clearTimeout(this.videoHandler.autoRetry),this.downloading=!1,_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(videoData,`Translate video (requestLang: ${requestLang}, responseLang: ${responseLang})`);try{if(signal.aborted)throw Error(`AbortError`);let useLivelyVoice=this.videoHandler.isLivelyVoiceAllowed()&&this.videoHandler.data?.useLivelyVoice,res=await this.videoHandler.votClient.translateVideo({videoData,requestLang,responseLang,translationHelp,extraOpts:{useLivelyVoice,videoTitle:this.videoHandler.videoData?.title},shouldSendFailedAudio});if(_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Translate video result`,res),signal.aborted)throw Error(`AbortError`);if(res.translated&&res.remainingTime<1)return _utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Video translation finished with this data: `,res),res;let message=res.message??_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_2__.j.get(`translationTakeFewMinutes`);if(await this.videoHandler.updateTranslationErrorMsg(res.remainingTime>0?(0,_utils_localization__WEBPACK_IMPORTED_MODULE_5__.o)(res.remainingTime):message),res.status===_vot_js_core_types_yandex__WEBPACK_IMPORTED_MODULE_0__.v.AUDIO_REQUESTED&&this.videoHandler.isYouTubeHosts()){if(_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Start audio download`),this.downloading=!0,await this.audioDownloader.runAudioDownload(videoData.videoId,res.translationId,signal),_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`waiting downloading finish`),await(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.UV)(()=>!this.downloading||signal.aborted,15e3),signal.aborted)throw _utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`aborted after audio downloader vtrans`),Error(`AbortError`);return await this.translateVideoImpl(videoData,requestLang,responseLang,translationHelp,!0,signal)}}catch(err){if(err.message===`AbortError`)return _utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`aborted video translation`),null;await this.videoHandler.updateTranslationErrorMsg(err.data?.message??err),console.error(`[VOT]`,err);let cacheKey=`${videoData.videoId}_${requestLang}_${responseLang}_${this.videoHandler.data?.useLivelyVoice}`;return this.videoHandler.cacheManager.setTranslation(cacheKey,{error:err}),null}return new Promise(resolve=>{this.videoHandler.autoRetry=setTimeout(async()=>{resolve(await this.translateVideoImpl(videoData,requestLang,responseLang,translationHelp,!0,signal))},2e4)})}async translateStreamImpl(videoData,requestLang,responseLang,signal=new AbortController().signal){clearTimeout(this.videoHandler.autoRetry),_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(videoData,`Translate stream (requestLang: ${requestLang}, responseLang: ${responseLang})`);try{if(signal.aborted)throw Error(`AbortError`);let res=await this.videoHandler.votClient.translateStream({videoData,requestLang,responseLang});if(signal.aborted)throw Error(`AbortError`);if(_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Translate stream result`,res),!res.translated&&res.interval===10)return await this.videoHandler.updateTranslationErrorMsg(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_2__.j.get(`translationTakeFewMinutes`)),new Promise(resolve=>{this.videoHandler.autoRetry=setTimeout(async()=>{resolve(await this.translateStreamImpl(videoData,requestLang,responseLang,signal))},res.interval*1e3)});if(this.isWaitingStreamRes(res))throw _utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Stream translation aborted! Message: ${res.message}`),new _utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_3__.n(`streamNoConnectionToServer`);if(!res.result)throw _utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Failed to find translation result! Data:`,res),new _utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_3__.n(`audioNotReceived`);return _utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Stream translated successfully. Running...`,res),this.videoHandler.streamPing=setInterval(async()=>{_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`Ping stream translation`,res.pingId),this.videoHandler.votClient.pingStream({pingId:res.pingId})},res.interval*1e3),res}catch(err){return err.message===`AbortError`?(_utils_debug__WEBPACK_IMPORTED_MODULE_4__.A.log(`aborted stream translation`),null):(console.error(`[VOT] Failed to translate stream`,err),await this.videoHandler.updateTranslationErrorMsg(err.data?.message??err),null)}}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/core/videoManager.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{k:()=>VOTVideoManager});var _vot_js_ext_utils_videoData__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/utils/videoData.js`),_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/config.js`),_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/consts.js`),_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/youtube.js`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/localization/localizationProvider.ts`),_utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/utils/VOTLocalizedError.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/debug.ts`),_utils_gm__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/utils/gm.ts`),_utils_translateApis__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./src/utils/translateApis.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_3__,_utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__,_utils_gm__WEBPACK_IMPORTED_MODULE_6__,_utils_translateApis__WEBPACK_IMPORTED_MODULE_7__,_utils_utils__WEBPACK_IMPORTED_MODULE_8__]);[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_3__,_utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__,_utils_gm__WEBPACK_IMPORTED_MODULE_6__,_utils_translateApis__WEBPACK_IMPORTED_MODULE_7__,_utils_utils__WEBPACK_IMPORTED_MODULE_8__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class VOTVideoManager{videoHandler;constructor(videoHandler){this.videoHandler=videoHandler}async getVideoData(){let{duration,url,videoId,host,title,translationHelp=null,localizedTitle,description,detectedLanguage:possibleLanguage,subtitles,isStream=!1}=await(0,_vot_js_ext_utils_videoData__WEBPACK_IMPORTED_MODULE_0__.o4)(this.videoHandler.site,{fetchFn:_utils_gm__WEBPACK_IMPORTED_MODULE_6__.G3,video:this.videoHandler.video,language:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_3__.j.lang}),detectedLanguage=possibleLanguage??this.videoHandler.translateFromLang;if(!possibleLanguage&&title){let text=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_8__.X5)(title,description);_utils_debug__WEBPACK_IMPORTED_MODULE_5__.A.log(`Detecting language text: ${text}`);let language=await(0,_utils_translateApis__WEBPACK_IMPORTED_MODULE_7__.o0)(text);_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_9__.xm.includes(language)&&(detectedLanguage=language)}let videoData={translationHelp,isStream,duration:duration||this.videoHandler.video?.duration||_vot_js_shared_config__WEBPACK_IMPORTED_MODULE_1__.A.defaultDuration,videoId,url,host,detectedLanguage,responseLanguage:this.videoHandler.translateToLang,subtitles,title,localizedTitle,downloadTitle:localizedTitle??title??videoId};if(console.log(`[VOT] Detected language:`,detectedLanguage),[`rutube`,`ok.ru`,`mail_ru`].includes(this.videoHandler.site.host))videoData.detectedLanguage=`ru`;else if(this.videoHandler.site.host===`youku`)videoData.detectedLanguage=`zh`;else if(this.videoHandler.site.host===`vk`){let trackLang=document.getElementsByTagName(`track`)?.[0]?.srclang;videoData.detectedLanguage=trackLang||`auto`}else this.videoHandler.site.host===`weverse`&&(videoData.detectedLanguage=`ko`);return videoData}videoValidator(){if(!this.videoHandler.videoData||!this.videoHandler.data)throw new _utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__.n(`VOTNoVideoIDFound`);if(_utils_debug__WEBPACK_IMPORTED_MODULE_5__.A.log(`VideoValidator videoData: `,this.videoHandler.videoData),this.videoHandler.data.enabledDontTranslateLanguages&&this.videoHandler.data.dontTranslateLanguages?.includes(this.videoHandler.videoData.detectedLanguage))throw new _utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__.n(`VOTDisableFromYourLang`);if(this.videoHandler.site.host===`twitch`&&this.videoHandler.videoData.isStream)throw new _utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__.n(`VOTStreamNotAvailable`);if(!this.videoHandler.videoData.isStream&&this.videoHandler.videoData.duration>14400)throw new _utils_VOTLocalizedError__WEBPACK_IMPORTED_MODULE_4__.n(`VOTVideoIsTooLong`);return!0}getVideoVolume(){let videoVolume=this.videoHandler.video?.volume;return[`youtube`,`googledrive`].includes(this.videoHandler.site.host)&&(videoVolume=_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__.A.getVolume()??videoVolume),videoVolume}setVideoVolume(volume){if(![`youtube`,`googledrive`].includes(this.videoHandler.site.host))return this.videoHandler.video.volume=volume,this;let videoVolume=_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__.A.setVolume(volume);return videoVolume||(this.videoHandler.video.volume=volume),this}isMuted(){return[`youtube`,`googledrive`].includes(this.videoHandler.site.host)?_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_2__.A.isMuted():this.videoHandler.video?.muted}syncVideoVolumeSlider(){let videoVolume=this.isMuted()?0:this.getVideoVolume()*100,newSlidersVolume=Math.round(videoVolume);return this.videoHandler.data?.syncVolume&&(this.videoHandler.tempOriginalVolume=Number(newSlidersVolume)),this.videoHandler.uiManager.votOverlayView?.isInitialized()&&(this.videoHandler.uiManager.votOverlayView.videoVolumeSlider.value=newSlidersVolume),this}setSelectMenuValues(from,to){if(!this.videoHandler.uiManager.votOverlayView?.isInitialized()||!this.videoHandler.videoData)return this;console.log(`[VOT] Set translation from ${from} to ${to}`),this.videoHandler.uiManager.votOverlayView.languagePairSelect.fromSelect.selectTitle=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_3__.j.get(`langs.${from}`),this.videoHandler.uiManager.votOverlayView.languagePairSelect.toSelect.selectTitle=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_3__.j.get(`langs.${to}`),this.videoHandler.uiManager.votOverlayView.languagePairSelect.fromSelect.setSelectedValue(from),this.videoHandler.uiManager.votOverlayView.languagePairSelect.toSelect.setSelectedValue(to),this.videoHandler.videoData.detectedLanguage=from,this.videoHandler.videoData.responseLanguage=to}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/index.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{k:()=>countryCode});var _vot_js_ext__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/index.js`),_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/youtube.js`),_vot_js_ext_utils_videoData__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/ext/dist/utils/videoData.js`),chaimu__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/chaimu/dist/index.js`),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/utils/debug.ts`),_audioDownloader_iframe_ts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/audioDownloader/iframe.ts`),_config_config_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(`./src/config/config.js`),_core_auth_ts__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/core/auth.ts`),_core_cacheManager_ts__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(`./src/core/cacheManager.ts`),_core_translationHandler_ts__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./src/core/translationHandler.ts`),_core_videoManager_ts__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/core/videoManager.ts`),_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(`./src/localization/localizationProvider.ts`),_subtitles_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(`./src/subtitles.js`),_ui_components_hotkeyButton_ts__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(`./src/ui/components/hotkeyButton.ts`),_ui_manager_ts__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(`./src/ui/manager.ts`),_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(`./src/utils/VOTLocalizedError.js`),_utils_VideoObserver_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(`./src/utils/VideoObserver.js`),_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(`./src/utils/gm.ts`),_utils_iframeConnector_ts__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(`./src/utils/iframeConnector.ts`),_utils_storage_ts__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(`./src/utils/storage.ts`),_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(`./src/utils/translateApis.ts`),_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(`./src/utils/utils.ts`),_utils_volume_ts__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(`./src/utils/volume.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_vot_js_ext__WEBPACK_IMPORTED_MODULE_0__,_audioDownloader_iframe_ts__WEBPACK_IMPORTED_MODULE_5__,_core_auth_ts__WEBPACK_IMPORTED_MODULE_6__,_core_translationHandler_ts__WEBPACK_IMPORTED_MODULE_7__,_core_videoManager_ts__WEBPACK_IMPORTED_MODULE_8__,_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__,_subtitles_js__WEBPACK_IMPORTED_MODULE_10__,_ui_components_hotkeyButton_ts__WEBPACK_IMPORTED_MODULE_11__,_ui_manager_ts__WEBPACK_IMPORTED_MODULE_12__,_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_13__,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__,_utils_iframeConnector_ts__WEBPACK_IMPORTED_MODULE_16__,_utils_storage_ts__WEBPACK_IMPORTED_MODULE_17__,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_18__,_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__]);[_vot_js_ext__WEBPACK_IMPORTED_MODULE_0__,_audioDownloader_iframe_ts__WEBPACK_IMPORTED_MODULE_5__,_core_auth_ts__WEBPACK_IMPORTED_MODULE_6__,_core_translationHandler_ts__WEBPACK_IMPORTED_MODULE_7__,_core_videoManager_ts__WEBPACK_IMPORTED_MODULE_8__,_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__,_subtitles_js__WEBPACK_IMPORTED_MODULE_10__,_ui_components_hotkeyButton_ts__WEBPACK_IMPORTED_MODULE_11__,_ui_manager_ts__WEBPACK_IMPORTED_MODULE_12__,_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_13__,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__,_utils_iframeConnector_ts__WEBPACK_IMPORTED_MODULE_16__,_utils_storage_ts__WEBPACK_IMPORTED_MODULE_17__,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_18__,_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;let countryCode;class VideoHandler{translateFromLang=`auto`;translateToLang=_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.HD;timer;data;videoData;firstPlay=!0;audioContext=(0,chaimu__WEBPACK_IMPORTED_MODULE_3__.GZ)();hls;votClient;audioPlayer;abortController;actionsAbortController;cacheManager;downloadTranslationUrl=null;autoRetry;streamPing;votOpts;volumeOnStart;tempOriginalVolume;tempVolume;firstSyncVolume=!0;longWaitingResCount=0;subtitles=[];constructor(video,container,site){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[VideoHandler] add video:`,video,`container:`,container,this),this.video=video,this.container=container,this.site=site,this.abortController=new AbortController,this.actionsAbortController=new AbortController,this.uiManager=new _ui_manager_ts__WEBPACK_IMPORTED_MODULE_12__.o({root:this.container,portalContainer:this.getPortalContainer(),tooltipLayoutRoot:this.getTooltipLayoutRoot(),data:this.data,videoHandler:this}),this.translationHandler=new _core_translationHandler_ts__WEBPACK_IMPORTED_MODULE_7__.F(this),this.videoManager=new _core_videoManager_ts__WEBPACK_IMPORTED_MODULE_8__.k(this),this.cacheManager=new _core_cacheManager_ts__WEBPACK_IMPORTED_MODULE_20__.G}getPortalContainer(){return this.site.host===`youtube`&&this.site.additionalData!==`mobile`?this.container.parentElement:this.container}getTooltipLayoutRoot(){switch(this.site.host){case`kickstarter`:return document.getElementById(`react-project-header`);case`custom`:return;default:return this.container}}getEventContainer(){return this.site.eventSelector?this.site.host===`twitter`?this.container.closest(this.site.eventSelector):document.querySelector(this.site.eventSelector):this.container}async autoTranslate(){if(this.firstPlay&&this.data.autoTranslate&&this.videoData.videoId){this.firstPlay=!1;try{this.videoManager.videoValidator(),await this.uiManager.handleTranslationBtnClick()}catch(err){console.error(`[VOT]`,err);return}}}getPreferAudio(){return!this.audioContext||!this.data.newAudioPlayer||this.videoData.isStream?!0:this.data.newAudioPlayer&&!this.data.onlyBypassMediaCSP?!1:!this.site.needBypassCSP}createPlayer(){let preferAudio=this.getPreferAudio();return _utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`preferAudio:`,preferAudio),this.audioPlayer=new chaimu__WEBPACK_IMPORTED_MODULE_3__.Ay({video:this.video,debug:!1,fetchFn:_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.G3,fetchOpts:{timeout:0},preferAudio}),this}async init(){if(!this.initialized){if(this.data=await _utils_storage_ts__WEBPACK_IMPORTED_MODULE_17__.d.getValues({autoTranslate:!1,dontTranslateLanguages:[_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.HD],enabledDontTranslateLanguages:!0,enabledAutoVolume:!0,autoVolume:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.JD,buttonPos:`default`,showVideoSlider:!0,syncVolume:!1,downloadWithName:_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.yx,sendNotifyOnComplete:!1,subtitlesMaxLength:300,highlightWords:!1,subtitlesFontSize:20,subtitlesOpacity:20,subtitlesDownloadFormat:`srt`,responseLanguage:_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.HD,defaultVolume:100,onlyBypassMediaCSP:Number(!!this.audioContext),newAudioPlayer:Number(!!this.audioContext),showPiPButton:!1,translateAPIErrors:!0,translationService:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.mE,detectService:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.K2,translationHotkey:null,m3u8ProxyHost:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.se,proxyWorkerHost:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.Pm,translateProxyEnabled:0,translateProxyEnabledDefault:!0,audioBooster:!1,useLivelyVoice:!1,autoHideButtonDelay:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.qU,useAudioDownload:_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.B0,compatVersion:``,account:{},localeHash:``,localeUpdatedAt:0}),this.data.compatVersion!==_config_config_js__WEBPACK_IMPORTED_MODULE_21__.r4&&(this.data=await(0,_utils_storage_ts__WEBPACK_IMPORTED_MODULE_17__._)(this.data),await _utils_storage_ts__WEBPACK_IMPORTED_MODULE_17__.d.set(`compatVersion`,_config_config_js__WEBPACK_IMPORTED_MODULE_21__.r4)),this.uiManager.data=this.data,this.tempVolume=this.data.defaultVolume,console.log(`[VOT] data from db: `,this.data),!this.data.translateProxyEnabled&&_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.up&&(this.data.translateProxyEnabled=1),!countryCode)try{let response=await(0,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.G3)(`https://speed.cloudflare.com/meta`,{timeout:7e3});({country:countryCode}=await response.json())}catch(err){console.error(`[VOT] Error getting country:`,err)}_config_config_js__WEBPACK_IMPORTED_MODULE_21__.vZ.includes(countryCode)&&this.data.translateProxyEnabledDefault&&(this.data.translateProxyEnabled=2),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`translateProxyEnabled`,this.data.translateProxyEnabled,this.data.translateProxyEnabledDefault),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Extension compatibility passed...`),this.initVOTClient(),this.uiManager.initUI(),this.uiManager.initUIEvents(),this.subtitlesWidget=new _subtitles_js__WEBPACK_IMPORTED_MODULE_10__.o(this.video,this.getPortalContainer(),this.site,this.uiManager.votOverlayView.votOverlayPortal,this.getTooltipLayoutRoot()),this.subtitlesWidget.setMaxLength(this.data.subtitlesMaxLength),this.subtitlesWidget.setHighlightWords(this.data.highlightWords),this.subtitlesWidget.setFontSize(this.data.subtitlesFontSize),this.subtitlesWidget.setOpacity(this.data.subtitlesOpacity),this.createPlayer(),this.setSelectMenuValues(this.videoData.detectedLanguage,this.data.responseLanguage??`ru`),this.translateToLang=this.data.responseLanguage??`ru`,this.initExtraEvents(),await this.autoTranslate(),this.initialized=!0}}initVOTClient(){return this.votOpts={fetchFn:_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.G3,fetchOpts:{signal:this.actionsAbortController.signal},apiToken:this.data.account?.token,hostVOT:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.tZ,host:this.data.translateProxyEnabled?this.data.proxyWorkerHost:_config_config_js__WEBPACK_IMPORTED_MODULE_21__.rl},this.votClient=new(this.data.translateProxyEnabled?_vot_js_ext__WEBPACK_IMPORTED_MODULE_0__.Pu:_vot_js_ext__WEBPACK_IMPORTED_MODULE_0__.Ay)(this.votOpts),this}transformBtn(status,text){return this.uiManager.transformBtn(status,text),this}hasActiveSource(){return!!(this.audioPlayer.player.src||this.hls?.url)}initExtraEvents(){let{signal}=this.abortController,addExtraEventListener=(element,event,handler)=>{element.addEventListener(event,handler,{signal})},addExtraEventListeners=(element,events,handler)=>{for(let event of events)addExtraEventListener(element,event,handler)};if(this.resizeObserver=new ResizeObserver(entries=>{for(let e of entries)this.uiManager.votOverlayView.votMenu.container.style.setProperty(`--vot-container-height`,`${e.contentRect.height}px`);let{position,direction}=this.uiManager.votOverlayView.calcButtonLayout(this.data?.buttonPos);this.uiManager.votOverlayView.updateButtonLayout(position,direction)}),this.resizeObserver.observe(this.video),this.uiManager.votOverlayView.votMenu.container.style.setProperty(`--vot-container-height`,`${this.video.getBoundingClientRect().height}px`),[`youtube`,`googledrive`].includes(this.site.host)&&this.site.additionalData!==`mobile`){this.syncVolumeObserver=new MutationObserver(mutations=>{if(!(!this.audioPlayer.player.src||!this.data.syncVolume)){for(let mutation of mutations)if(mutation.type===`attributes`&&mutation.attributeName===`aria-valuenow`){if(this.firstSyncVolume){this.firstSyncVolume=!1;return}let videoVolume=this.isMuted()?0:this.getVideoVolume()*100,finalVolume=Math.round(videoVolume);this.data.defaultVolume=finalVolume,this.audioPlayer.player.volume=this.data.defaultVolume/100,this.syncVolumeWrapper(`video`,finalVolume)}}});let ytpVolumePanel=document.querySelector(`.ytp-volume-panel`);ytpVolumePanel&&this.syncVolumeObserver.observe(ytpVolumePanel,{attributes:!0,subtree:!0})}document.addEventListener(`click`,event=>{let e=event.target,button=this.uiManager.votOverlayView.votButton.container,menu=this.uiManager.votOverlayView.votMenu.container,container=this.container,settings=this.uiManager.votSettingsView.dialog.container,tempDialog=document.querySelector(`.vot-dialog-temp`),isButton=button.contains(e),isMenu=menu.contains(e),isVideo=container.contains(e),isSettings=settings.contains(e),isTempDialog=tempDialog?.contains(e)??!1;_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[document click] ${isButton} ${isMenu} ${isVideo} ${isSettings} ${isTempDialog}`),!isButton&&!isMenu&&!isSettings&&!isTempDialog&&(isVideo||this.uiManager.votOverlayView.updateButtonOpacity(0),this.uiManager.votOverlayView.votMenu.hidden=!0)},{signal});let userPressedKeys=new Set;document.addEventListener(`keydown`,async event=>{if(event.repeat)return;userPressedKeys.add(event.code);let activeElement=document.activeElement,isInputElement=[`input`,`textarea`].includes(activeElement.tagName.toLowerCase())||activeElement.isContentEditable;if(isInputElement)return;let combo=(0,_ui_components_hotkeyButton_ts__WEBPACK_IMPORTED_MODULE_11__._)(userPressedKeys);_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`combo: ${combo}`),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`this.data.translationHotkey: ${this.data.translationHotkey}`),combo===this.data.translationHotkey&&await this.uiManager.handleTranslationBtnClick()},{signal}),document.addEventListener(`blur`,()=>{userPressedKeys.clear()}),document.addEventListener(`keyup`,event=>{userPressedKeys.delete(event.code)},{signal});let eventContainer=this.getEventContainer();eventContainer&&addExtraEventListeners(eventContainer,[`pointermove`,`pointerout`],this.resetTimer),addExtraEventListener(this.uiManager.votOverlayView.votButton.container,`pointermove`,this.changeOpacityOnEvent),addExtraEventListener(this.uiManager.votOverlayView.votMenu.container,`pointermove`,this.changeOpacityOnEvent),this.site.host!==`xvideos`&&addExtraEventListener(document,`touchmove`,this.resetTimer),this.site.host===`youtube`&&(this.container.draggable=!1),addExtraEventListener(this.video,`canplay`,async()=>{this.site.host===`rutube`&&this.video.src||await this.setCanPlay()}),addExtraEventListener(this.video,`emptied`,async()=>{let videoId=await(0,_vot_js_ext_utils_videoData__WEBPACK_IMPORTED_MODULE_2__.jY)(this.site,{fetchFn:_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.G3,video:this.video});this.video.src&&this.videoData&&videoId===this.videoData.videoId||(_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`lipsync mode is emptied`),this.videoData=void 0,this.stopTranslation())}),[`rutube`,`ok`].includes(this.site.host)||addExtraEventListener(this.video,`volumechange`,()=>{this.syncVideoVolumeSlider()}),this.site.host===`youtube`&&!this.site.additionalData&&addExtraEventListener(document,`yt-page-data-updated`,async()=>{_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`yt-page-data-updated`),window.location.pathname.includes(`/shorts/`)&&await this.setCanPlay()})}async setCanPlay(){let videoId=await(0,_vot_js_ext_utils_videoData__WEBPACK_IMPORTED_MODULE_2__.jY)(this.site,{fetchFn:_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.G3,video:this.video});this.videoData&&videoId===this.videoData.videoId||(await this.handleSrcChanged(),await this.autoTranslate(),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`lipsync mode is canplay`))}resetTimer=()=>{clearTimeout(this.timer),this.uiManager.votOverlayView.updateButtonOpacity(1),this.timer=setTimeout(()=>{this.uiManager.votOverlayView.updateButtonOpacity(0)},this.data.autoHideButtonDelay)};changeOpacityOnEvent=event=>{clearTimeout(this.timer),this.uiManager.votOverlayView.updateButtonOpacity(1),event.stopPropagation()};async changeSubtitlesLang(subs){if(_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[onchange] subtitles`,subs),this.uiManager.votOverlayView.subtitlesSelect.setSelectedValue(subs),subs===`disabled`)this.subtitlesWidget.setContent(null),this.uiManager.votOverlayView.downloadSubtitlesButton.hidden=!0,this.yandexSubtitles=null;else{let subtitlesObj=this.subtitles.at(Number.parseInt(subs));if(this.data.translateProxyEnabled===2&&subtitlesObj.url.startsWith(`https://brosubs.s3-private.mds.yandex.net/vtrans/`)){let subsPath=subtitlesObj.url.replace(`https://brosubs.s3-private.mds.yandex.net/vtrans/`,``);subtitlesObj.url=`https://${this.data.proxyWorkerHost}/video-subtitles/subtitles-proxy/${subsPath}`,console.log(`[VOT] Subs proxied via ${subtitlesObj.url}`)}this.yandexSubtitles=await _subtitles_js__WEBPACK_IMPORTED_MODULE_10__.I.fetchSubtitles(subtitlesObj),this.subtitlesWidget.setContent(this.yandexSubtitles,subtitlesObj.language),this.uiManager.votOverlayView.downloadSubtitlesButton.hidden=!1}}async updateSubtitlesLangSelect(){if(!this.subtitles||this.subtitles.length===0){let updatedOptions=[{label:_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSubtitlesDisabled`),value:`disabled`,selected:!0,disabled:!1}];this.uiManager.votOverlayView.subtitlesSelect.updateItems(updatedOptions),await this.changeSubtitlesLang(updatedOptions[0].value);return}let updatedOptions=[{label:_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSubtitlesDisabled`),value:`disabled`,selected:!0,disabled:!1},...this.subtitles.map((s,idx)=>({label:(_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`langs.${s.language}`)??s.language.toUpperCase())+(s.translatedFromLanguage?` ${_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTTranslatedFrom`)} ${_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`langs.${s.translatedFromLanguage}`)??s.translatedFromLanguage.toUpperCase()}`:``)+(s.source===`yandex`?``:`, ${window.location.hostname}`)+(s.isAutoGenerated?` (${_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTAutogenerated`)})`:``),value:idx,selected:!1,disabled:!1}))];this.uiManager.votOverlayView.subtitlesSelect.updateItems(updatedOptions),await this.changeSubtitlesLang(updatedOptions[0].value)}async loadSubtitles(){if(!this.videoData?.videoId){console.error(`[VOT] ${_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.getDefault(`VOTNoVideoIDFound`)}`),this.subtitles=[];return}let cacheKey=`${this.videoData.videoId}_${this.videoData.detectedLanguage}_${this.videoData.responseLanguage}_${this.data.useLivelyVoice}`;try{let cachedSubs=this.cacheManager.getSubtitles(cacheKey);cachedSubs||(cachedSubs=await _subtitles_js__WEBPACK_IMPORTED_MODULE_10__.I.getSubtitles(this.votClient,this.videoData),this.cacheManager.setSubtitles(cacheKey,cachedSubs)),this.subtitles=cachedSubs}catch(error){console.error(`[VOT] Failed to load subtitles:`,error),this.subtitles=[]}await this.updateSubtitlesLangSelect()}isLivelyVoiceAllowed(){return!(this.videoData.detectedLanguage!==`en`||this.videoData.responseLanguage!==`ru`||!this.data.account?.token)}getVideoVolume(){return this.videoManager.getVideoVolume()}setVideoVolume(volume){return this.videoManager.setVideoVolume(volume),this}isMuted(){return this.videoManager.isMuted()}syncVideoVolumeSlider(){this.videoManager.syncVideoVolumeSlider()}setSelectMenuValues(from,to){this.videoManager.setSelectMenuValues(from,to)}syncVolumeWrapper(fromType,newVolume){let slider=fromType===`translation`?this.uiManager.votOverlayView.videoVolumeSlider:this.uiManager.votOverlayView.translationVolumeSlider,finalValue=(0,_utils_volume_ts__WEBPACK_IMPORTED_MODULE_22__.q)(fromType===`translation`?this.video:this.audioPlayer.player,newVolume,slider.value,fromType===`translation`?this.tempVolume:this.tempOriginalVolume);slider.value=finalValue,this.tempOriginalVolume=fromType===`translation`?finalValue:newVolume,this.tempVolume=fromType===`translation`?newVolume:finalValue}async getVideoData(){return await this.videoManager.getVideoData()}videoValidator(){return this.videoManager.videoValidator()}stopTranslate(){this.audioPlayer.player.removeVideoEvents(),this.audioPlayer.player.clear(),this.audioPlayer.player.src=void 0,_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`audioPlayer after stopTranslate`,this.audioPlayer),this.uiManager.votOverlayView.videoVolumeSlider.hidden=!0,this.uiManager.votOverlayView.translationVolumeSlider.hidden=!0,this.uiManager.votOverlayView.downloadTranslationButton.hidden=!0,this.downloadTranslationUrl=null,this.longWaitingResCount=0,this.transformBtn(`none`,_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`translateVideo`)),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Volume on start: ${this.volumeOnStart}`),this.volumeOnStart&&this.setVideoVolume(this.volumeOnStart),clearInterval(this.streamPing),clearTimeout(this.autoRetry),this.hls?.destroy(),this.firstSyncVolume=!0,this.actionsAbortController=new AbortController}async updateTranslationErrorMsg(errorMessage){let translationTake=_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`translationTake`),lang=_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.lang;if(this.longWaitingResCount=errorMessage===_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`translationTakeAboutMinute`)?this.longWaitingResCount+1:0,_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`longWaitingResCount`,this.longWaitingResCount),this.longWaitingResCount>_config_config_js__WEBPACK_IMPORTED_MODULE_21__.px&&(errorMessage=new _utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_13__.n(`TranslationDelayed`)),errorMessage?.name===`VOTLocalizedError`)this.transformBtn(`error`,errorMessage.localizedMessage);else if(errorMessage instanceof Error)this.transformBtn(`error`,errorMessage?.message);else if(this.data.translateAPIErrors&&lang!==`ru`&&!errorMessage.includes(translationTake)){this.uiManager.votOverlayView.votButton.loading=!0;let translatedMessage=await(0,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_18__.Tl)(errorMessage,`ru`,lang);this.transformBtn(`error`,translatedMessage)}else this.transformBtn(`error`,errorMessage);[`Подготавливаем перевод`,`Видео передано в обработку`,`Ожидаем перевод видео`,`Загружаем переведенное аудио`].includes(errorMessage)&&(this.uiManager.votOverlayView.votButton.loading=!0)}afterUpdateTranslation(audioUrl){let isSuccess=this.uiManager.votOverlayView.votButton.container.dataset.status===`success`;this.uiManager.votOverlayView.videoVolumeSlider.hidden=!this.data.showVideoSlider||!isSuccess,this.uiManager.votOverlayView.translationVolumeSlider.hidden=!isSuccess,this.data.enabledAutoVolume&&(this.uiManager.votOverlayView.videoVolumeSlider.value=this.data.autoVolume),this.videoData.isStream||(this.uiManager.votOverlayView.downloadTranslationButton.hidden=!1,this.downloadTranslationUrl=audioUrl),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`afterUpdateTranslation downloadTranslationUrl`,this.downloadTranslationUrl),this.data.sendNotifyOnComplete&&this.longWaitingResCount&&isSuccess&&GM_notification({text:_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTTranslationCompletedNotify`).replace(`{0}`,window.location.hostname),title:GM_info.script.name,timeout:5e3,silent:!0,tag:`VOTTranslationCompleted`,onclick:()=>{window.focus()}})}async validateAudioUrl(audioUrl){try{let fetchOpts=this.isMultiMethodS3(audioUrl)?{method:`HEAD`}:{headers:{range:`bytes=0-0`}},response=await(0,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_15__.G3)(audioUrl,fetchOpts);if(_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Test audio response`,response),response.ok)return _utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Valid audioUrl`,audioUrl),audioUrl;_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Yandex returned not valid audio, trying to fix...`),this.videoData.detectedLanguage=`auto`;let translateRes=await this.translationHandler.translateVideoImpl(this.videoData,this.videoData.detectedLanguage,this.videoData.responseLanguage,this.videoData.translationHelp,!this.data.useAudioDownload,this.actionsAbortController.signal);this.setSelectMenuValues(this.videoData.detectedLanguage,this.videoData.responseLanguage),audioUrl=translateRes.url,_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Fixed audio audioUrl`,audioUrl)}catch(err){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Test audio error:`,err)}return audioUrl}proxifyAudio(audioUrl){return this.data.translateProxyEnabled===2&&audioUrl.startsWith(`https://vtrans.s3-private.mds.yandex.net/tts/prod/`)&&(audioUrl=audioUrl.replace(`https://vtrans.s3-private.mds.yandex.net/tts/prod/`,`https://${this.data.proxyWorkerHost}/video-translation/audio-proxy/`),console.log(`[VOT] Audio proxied via ${audioUrl}`)),audioUrl}isMultiMethodS3(url){return url.startsWith(`https://vtrans.s3-private.mds.yandex.net/tts/prod/`)||url.startsWith(`https://${this.data.proxyWorkerHost}/video-translation/audio-proxy/`)}async updateTranslation(audioUrl){audioUrl!==this.audioPlayer.player.currentSrc&&(audioUrl=await this.validateAudioUrl(this.proxifyAudio(audioUrl))),this.audioPlayer.player.src!==audioUrl&&(this.audioPlayer.player.src=audioUrl);try{this.audioPlayer.init()}catch(err){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`this.audioPlayer.init() error`,err),this.transformBtn(`error`,err.message)}this.setupAudioSettings(),this.site.host===`twitter`&&document.querySelector(`button[data-testid="app-bar-back"][role="button"]`).addEventListener(`click`,this.stopTranslation),this.transformBtn(`success`,_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`disableTranslate`)),this.afterUpdateTranslation(audioUrl)}async translateFunc(VIDEO_ID,isStream,requestLang,responseLang,translationHelp){console.log(`[VOT] Video Data: `,this.videoData),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Run videoValidator`),this.videoValidator(),this.uiManager.votOverlayView.votButton.loading=!0,this.volumeOnStart=this.getVideoVolume();let cacheKey=`${VIDEO_ID}_${requestLang}_${responseLang}_${this.data.useLivelyVoice}`,cachedEntry=this.cacheManager.getTranslation(cacheKey);if(cachedEntry?.url){await this.updateTranslation(cachedEntry.url),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[translateFunc] Cached translation was received`);return}if(cachedEntry?.error){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Skip translation - previous attempt failed`),await this.updateTranslationErrorMsg(cachedEntry.error.data?.message);return}if(isStream){let translateRes=await this.translationHandler.translateStreamImpl(this.videoData,requestLang,responseLang,this.actionsAbortController.signal);if(!translateRes){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Skip translation`);return}this.transformBtn(`success`,_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.get(`disableTranslate`));try{this.hls=(0,_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.CK)(),this.audioPlayer.init()}catch(err){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`this.audioPlayer.init() error`,err),this.transformBtn(`error`,err.message)}let streamURL=this.setHLSSource(translateRes.result.url);return this.site.host===`youtube`&&_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_1__.A.videoSeek(this.video,10),this.setupAudioSettings(),!this.video.src&&!this.video.currentSrc&&!this.video.srcObject?this.stopTranslation():this.afterUpdateTranslation(streamURL)}let translateRes=await this.translationHandler.translateVideoImpl(this.videoData,requestLang,responseLang,translationHelp,!this.data.useAudioDownload,this.actionsAbortController.signal);if(_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[translateRes]`,translateRes),!translateRes){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Skip translation`);return}await this.updateTranslation(translateRes.url);let cachedSubs=this.cacheManager.getSubtitles(cacheKey);cachedSubs?.some(item=>item.source===`yandex`&&item.translatedFromLanguage===this.videoData.detectedLanguage&&item.language===this.videoData.responseLanguage)||(this.cacheManager.deleteSubtitles(cacheKey),this.subtitles=[]),this.cacheManager.setTranslation(cacheKey,{videoId:VIDEO_ID,from:requestLang,to:responseLang,url:this.downloadTranslationUrl,useLivelyVoice:this.data?.useLivelyVoice})}isYouTubeHosts(){return[`youtube`,`invidious`,`piped`,`poketube`,`ricktube`].includes(this.site.host)}setupHLS(streamURL){this.hls.on(Hls.Events.MEDIA_ATTACHED,function(){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`audio and hls.js are now bound together !`)}),this.hls.on(Hls.Events.MANIFEST_PARSED,function(data){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`manifest loaded, found ${data?.levels?.length} quality level`)}),this.hls.loadSource(streamURL),this.hls.attachMedia(this.audioPlayer.player.audio),this.hls.on(Hls.Events.ERROR,function(data){if(data.fatal)switch(data.type){case Hls.ErrorTypes.MEDIA_ERROR:console.log(`fatal media error encountered, try to recover`),this.hls.recoverMediaError();break;case Hls.ErrorTypes.NETWORK_ERROR:console.error(`fatal network error encountered`,data);break;default:this.hls.destroy();break}}),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(this.hls)}setHLSSource(url){let streamURL=`https://${this.data.m3u8ProxyHost}/?all=yes&origin=${encodeURIComponent(`https://strm.yandex.ru`)}&referer=${encodeURIComponent(`https://strm.yandex.ru`)}&url=${encodeURIComponent(url)}`;if(this.hls)this.setupHLS(streamURL);else if(this.audioPlayer.player.audio.canPlayType(`application/vnd.apple.mpegurl`))this.audioPlayer.player.src=streamURL;else throw new _utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_13__.n(`audioFormatNotSupported`);return streamURL}setupAudioSettings(){typeof this.data.defaultVolume==`number`&&(this.audioPlayer.player.volume=this.data.defaultVolume/100),this.data.enabledAutoVolume&&this.setVideoVolume((this.data.autoVolume/100).toFixed(2))}stopTranslation=()=>{this.stopTranslate(),this.syncVideoVolumeSlider()};async handleSrcChanged(){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[VideoHandler] src changed`,this),this.firstPlay=!0,this.stopTranslation();let hide=!this.video.src&&!this.video.currentSrc&&!this.video.srcObject;this.uiManager.votOverlayView.votButton.container.hidden=hide,hide&&(this.uiManager.votOverlayView.votMenu.hidden=hide),this.site.selector||(this.container=this.video.parentElement),this.container.contains(this.uiManager.votOverlayView.votButton.container)||this.container.append(this.uiManager.votOverlayView.votButton.container,this.uiManager.votOverlayView.votMenu.container),this.videoData=await this.getVideoData();let cacheKey=`${this.videoData.videoId}_${this.videoData.detectedLanguage}_${this.videoData.responseLanguage}_${this.data.useLivelyVoice}`;this.subtitles=this.cacheManager.getSubtitles(cacheKey),await this.updateSubtitlesLangSelect(),this.translateToLang=this.data.responseLanguage??`ru`,this.setSelectMenuValues(this.videoData.detectedLanguage,this.videoData.responseLanguage),this.actionsAbortController=new AbortController}async release(){_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`[VideoHandler] release`),this.initialized=!1,this.releaseExtraEvents(),this.subtitlesWidget.release(),this.uiManager.release()}collectReportInfo(){let os=`${_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.R5.os.name} ${_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.R5.os.version}`,additionalInfo=`<details>
<summary>Autogenerated by VOT:</summary>
<ul>
  <li>OS: ${os}</li>
  <li>Browser: ${_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.R5.browser.name} ${_utils_utils_ts__WEBPACK_IMPORTED_MODULE_19__.R5.browser.version}</li>
  <li>Loader: ${GM_info.scriptHandler} v${GM_info.version}</li>
  <li>Script version: ${GM_info.script.version}</li>
  <li>URL: <code>${window.location.href}</code></li>
  <li>Lang: <code>${this.videoData.detectedLanguage}</code> -> <code>${this.videoData.responseLanguage}</code> (Lively voice: ${this.data.useLivelyVoice} | Audio download: ${this.data.useAudioDownload})</li>
  <li>Player: ${this.data.newAudioPlayer?`New`:`Old`} (CSP only: ${this.data.onlyBypassMediaCSP})</li>
  <li>Proxying mode: ${this.data.translateProxyEnabled}</li>
</ul>
</details>`,template=`1-bug-report-${_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.lang===`ru`?`ru`:`en`}.yml`;return{assignees:`ilyhalight`,template,os,"script-version":GM_info.script.version,"additional-info":additionalInfo}}releaseExtraEvents(){this.abortController.abort(),this.resizeObserver?.disconnect(),[`youtube`,`googledrive`].includes(this.site.host)&&this.site.additionalData!==`mobile`&&this.syncVolumeObserver?.disconnect()}}let videoObserver=new _utils_VideoObserver_js__WEBPACK_IMPORTED_MODULE_14__.c,videosWrappers=new WeakMap;function climb(el,selector){if(!el||!selector)return null;if(el instanceof Document)return el.querySelector(selector);let foundEl=el.closest(selector);if(foundEl)return foundEl;let root=el.getRootNode();return climb(root instanceof ShadowRoot?root.host:root,selector)}function findContainer(site,video){if(_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`findContainer`,site,video),site.shadowRoot){let container=climb(video,site.selector);return _utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`findContainer with site.shadowRoot`,container),container??video.parentElement}if(_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`findContainer without shadowRoot`),!site.selector)return video.parentElement;let elements=document.querySelectorAll(site.selector);return Array.from(elements).find(e=>e.contains(video))??video.parentElement}function initIframeInteractor(){let configs={"https://dev.epicgames.com":{targetOrigin:`https://dev.epicgames.com`,dataFilter:data=>typeof data==`string`&&data.startsWith(`getVideoId:`),extractVideoId:url=>url.pathname.split(`/`).slice(-2,-1)[0],iframeSelector:src=>`electra-player > iframe[src="${src}"]`,responseFormatter:(videoId,data)=>`${data}:${videoId}`,processRequest:data=>{let reqId=data.replace(`getVideoId:`,``);return atob(reqId)}}},currentConfig=Object.entries(configs).find(([origin])=>window.location.origin===origin&&(origin!==`https://dev.epicgames.com`||window.location.pathname.includes(`/community/learning/`)))?.[1];currentConfig&&window.addEventListener(`message`,event=>{try{if(event.origin!==currentConfig.targetOrigin||!currentConfig.dataFilter(event.data))return;let url=new URL(window.location.href),videoId=currentConfig.extractVideoId(url);if(!videoId)return;let iframeSrc=currentConfig.processRequest?.(event.data)||url.href,selector=typeof currentConfig.iframeSelector==`function`?currentConfig.iframeSelector(iframeSrc):currentConfig.iframeSelector,iframe=document.querySelector(selector);if(!iframe?.contentWindow)return;let response=currentConfig.responseFormatter(videoId,event.data);iframe.contentWindow.postMessage(response,currentConfig.targetOrigin)}catch(error){console.error(`Iframe communication error:`,error)}})}async function main(){if(console.log(`[VOT] Loading extension...`),(0,_utils_iframeConnector_ts__WEBPACK_IMPORTED_MODULE_16__.d4)()&&window.location.hash.includes(_utils_iframeConnector_ts__WEBPACK_IMPORTED_MODULE_16__.WF))return(0,_audioDownloader_iframe_ts__WEBPACK_IMPORTED_MODULE_5__.q)();if(window.location.origin===_config_config_js__WEBPACK_IMPORTED_MODULE_21__.xW)return await(0,_core_auth_ts__WEBPACK_IMPORTED_MODULE_6__.L)();await _localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.update(),_utils_debug_ts__WEBPACK_IMPORTED_MODULE_4__.A.log(`Selected menu language: ${_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_9__.j.lang}`),initIframeInteractor(),videoObserver.onVideoAdded.addListener(async video=>{if(videosWrappers.has(video))return;let container,site=(0,_vot_js_ext_utils_videoData__WEBPACK_IMPORTED_MODULE_2__.cQ)().find(site=>(container=findContainer(site,video),!!container));if(site){[`peertube`,`directlink`].includes(site.host)&&(site.url=window.location.origin);try{let videoHandler=new VideoHandler(video,container,site);videoHandler.videoData=await videoHandler.getVideoData(),await videoHandler.init(),videosWrappers.set(video,videoHandler)}catch(err){console.error(`[VOT] Failed to initialize videoHandler`,err)}}}),videoObserver.onVideoRemoved.addListener(async video=>{videosWrappers.has(video)&&(await videosWrappers.get(video).release(),videosWrappers.delete(video))}),videoObserver.enable()}main().catch(e=>{console.error(`[VOT]`,e)}),__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/localization/locales/en.json":module=>{"use strict";module.exports=JSON.parse(`{"recommended":"recommended","translateVideo":"Translate video","disableTranslate":"Turn off","translationSettings":"Translation settings","subtitlesSettings":"Subtitles settings","resetSettings":"Reset settings","videoBeingTranslated":"The video is being translated","videoLanguage":"Video language","translationLanguage":"Translation language","translationTake":"The translation will take","translationTakeMoreThanHour":"The translation will take more than an hour","translationTakeAboutMinute":"The translation will take about a minute","translationTakeFewMinutes":"The translation will take a few minutes","translationTakeApproximatelyMinutes":"The translation will take approximately {0} minutes","translationTakeApproximatelyMinute":"The translation will take approximately {0} minutes","requestTranslationFailed":"Failed to request video translation","audioNotReceived":"Audio link not received","audioFormatNotSupported":"The audio format is not supported","VOTAutoTranslate":"Translate on open","VOTDontTranslateYourLang":"Don't translate from my language","VOTVolume":"Video volume:","VOTVolumeTranslation":"Translation volume:","VOTAutoSetVolume":"Reduce video volume to","VOTShowVideoSlider":"Video volume slider","VOTSyncVolume":"Link translation and video volume","VOTDisableFromYourLang":"You have disabled the translation of the video in your language","VOTVideoIsTooLong":"Video is too long","VOTNoVideoIDFound":"No video ID found","VOTSubtitles":"Subtitles","VOTSubtitlesDisabled":"Disabled","VOTSubtitlesMaxLength":"Subtitles max length","VOTHighlightWords":"Highlight words","VOTTranslatedFrom":"translated from","VOTAutogenerated":"autogenerated","VOTSettings":"VOT Settings","VOTMenuLanguage":"Menu language","VOTAuthors":"Authors","VOTVersion":"Version","VOTLoader":"Loader","VOTBrowser":"Browser","VOTShowPiPButton":"Show PiP button","langs":{"auto":"Auto","af":"Afrikaans","ak":"Akan","sq":"Albanian","am":"Amharic","ar":"Arabic","hy":"Armenian","as":"Assamese","ay":"Aymara","az":"Azerbaijani","bn":"Bangla","eu":"Basque","be":"Belarusian","bho":"Bhojpuri","bs":"Bosnian","bg":"Bulgarian","my":"Burmese","ca":"Catalan","ceb":"Cebuano","zh":"Chinese","zh-Hans":"Chinese (Simplified)","zh-Hant":"Chinese (Traditional)","co":"Corsican","hr":"Croatian","cs":"Czech","da":"Danish","dv":"Divehi","nl":"Dutch","en":"English","eo":"Esperanto","et":"Estonian","ee":"Ewe","fil":"Filipino","fi":"Finnish","fr":"French","gl":"Galician","lg":"Ganda","ka":"Georgian","de":"German","el":"Greek","gn":"Guarani","gu":"Gujarati","ht":"Haitian Creole","ha":"Hausa","haw":"Hawaiian","iw":"Hebrew","hi":"Hindi","hmn":"Hmong","hu":"Hungarian","is":"Icelandic","ig":"Igbo","id":"Indonesian","ga":"Irish","it":"Italian","ja":"Japanese","jv":"Javanese","kn":"Kannada","kk":"Kazakh","km":"Khmer","rw":"Kinyarwanda","ko":"Korean","kri":"Krio","ku":"Kurdish","ky":"Kyrgyz","lo":"Lao","la":"Latin","lv":"Latvian","ln":"Lingala","lt":"Lithuanian","lb":"Luxembourgish","mk":"Macedonian","mg":"Malagasy","ms":"Malay","ml":"Malayalam","mt":"Maltese","mi":"Māori","mr":"Marathi","mn":"Mongolian","ne":"Nepali","nso":"Northern Sotho","no":"Norwegian","ny":"Nyanja","or":"Odia","om":"Oromo","ps":"Pashto","fa":"Persian","pl":"Polish","pt":"Portuguese","pa":"Punjabi","qu":"Quechua","ro":"Romanian","ru":"Russian","sm":"Samoan","sa":"Sanskrit","gd":"Scottish Gaelic","sr":"Serbian","sn":"Shona","sd":"Sindhi","si":"Sinhala","sk":"Slovak","sl":"Slovenian","so":"Somali","st":"Southern Sotho","es":"Spanish","su":"Sundanese","sw":"Swahili","sv":"Swedish","tg":"Tajik","ta":"Tamil","tt":"Tatar","te":"Telugu","th":"Thai","ti":"Tigrinya","ts":"Tsonga","tr":"Turkish","tk":"Turkmen","uk":"Ukrainian","ur":"Urdu","ug":"Uyghur","uz":"Uzbek","vi":"Vietnamese","cy":"Welsh","fy":"Western Frisian","xh":"Xhosa","yi":"Yiddish","yo":"Yoruba","zu":"Zulu"},"streamNoConnectionToServer":"There is no connection to the server","searchField":"Search...","VOTTranslateAPIErrors":"Translate errors from the API","VOTDetectService":"Language detection service","VOTProxyWorkerHost":"Enter the proxy worker address","VOTM3u8ProxyHost":"Enter the address of the m3u8 proxy worker","proxySettings":"Proxy Settings","translationTakeApproximatelyMinute2":"The translation will take approximately {0} minutes","VOTAudioBooster":"Extended translation volume increase","VOTSubtitlesDesign":"Subtitles design","VOTSubtitlesFontSize":"Font size of subtitles","VOTSubtitlesOpacity":"Transparency of the subtitle background","VOTSubtitlesDownloadFormat":"The format for downloading subtitles","VOTDownloadWithName":"Download files with the video name","VOTUpdateLocaleFiles":"Update localization files","VOTLocaleHash":"Locale hash","VOTUpdatedAt":"Updated at","VOTNeedWebAudioAPI":"To enable this, you must have a Web Audio API","VOTMediaCSPEnabledOnSite":"Media CSP is enabled on this site","VOTOnlyBypassMediaCSP":"Use it only for bypassing Media CSP","VOTNewAudioPlayer":"Use the new audio player","VOTUseNewModel":"Use an experimental variation of Yandex voices for some videos","TranslationDelayed":"The translation is slightly delayed","VOTTranslationCompletedNotify":"The translation on the {0} has been completed!","VOTSendNotifyOnComplete":"Send a notification that the video has been translated","VOTBugReport":"Report a bug","VOTTranslateProxyDisabled":"Disabled","VOTTranslateProxyEnabled":"Enabled","VOTTranslateProxyEverything":"Proxy everything","VOTTranslateProxyStatus":"Proxying mode","VOTTranslatedBy":"Translated by {0}","VOTStreamNotAvailable":"Translate stream isn't available","VOTTranslationTextService":"Text translation service","VOTNotAffectToVoice":"Doesn't affect the translation of text in voice over","DontTranslateSelectedLanguages":"Don't translate from selected languages","showVideoVolumeSlider":"Display the video volume slider","hotkeysSettings":"Hotkeys settings","None":"None","VOTUseLivelyVoice":"Use lively voices. Speakers sound like native Russians.","miscSettings":"Misc settings","services":{"yandexbrowser":"Yandex Browser","msedge":"Microsoft Edge","rust-server":"Rust Server"},"aboutExtension":"About extension","appearance":"Appearance","buttonPositionInWidePlayer":"Button position in wide player","position":{"left":"Left","right":"Right","top":"Top","default":"Default"},"secs":"secs","autoHideButtonDelay":"Delay before hiding the translate button","notFound":"not found","minButtonPositionContainer":"The button position only changes in players larger than 600 pixels.","VOTTranslateProxyStatusDefault":"Completely disabling proxying in your country may break the extension","PressTheKeyCombination":"Press the key combination...","VOTUseAudioDownload":"Use audio download","VOTUseAudioDownloadWarning":"Disabling audio downloads may affect the functionality of the extension","VOTAccountRequired":"You need to log in to use this feature","VOTMyAccount":"My account","VOTLogin":"Login","VOTLogout":"Logout","VOTRefresh":"Refresh","VOTYandexToken":"Enter the Yandex OAuth Token","VOTYandexTokenInfo":"You can manually set the account token in this field. Please note that we don't check its validity before sending a translate request","VOTLoginViaToken":"Login via token"}`)},"./src/localization/localizationProvider.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{j:()=>localizationProvider});var _locales_en_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/localization/locales/en.json`),_config_config_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/config/config.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/debug.ts`),_utils_gm__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/utils/gm.ts`),_utils_localization__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/utils/localization.ts`),_utils_storage__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/utils/storage.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils_gm__WEBPACK_IMPORTED_MODULE_2__,_utils_localization__WEBPACK_IMPORTED_MODULE_3__,_utils_storage__WEBPACK_IMPORTED_MODULE_4__,_utils_utils__WEBPACK_IMPORTED_MODULE_5__]);[_utils_gm__WEBPACK_IMPORTED_MODULE_2__,_utils_localization__WEBPACK_IMPORTED_MODULE_3__,_utils_storage__WEBPACK_IMPORTED_MODULE_4__,_utils_utils__WEBPACK_IMPORTED_MODULE_5__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class LocalizationProvider{storageKeys=[`localePhrases`,`localeLang`,`localeHash`,`localeUpdatedAt`,`localeLangOverride`];lang;locale;defaultLocale=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_5__.GW)(_locales_en_json__WEBPACK_IMPORTED_MODULE_0__);cacheTTL=7200;localizationUrl=`${_config_config_js__WEBPACK_IMPORTED_MODULE_6__.hx}/master/src/localization`;_langOverride=`auto`;constructor(){this.lang=this.getLang(),this.locale={}}async init(){this._langOverride=await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.get(`localeLangOverride`,`auto`),this.lang=this.getLang();let phrases=await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.get(`localePhrases`,``);return this.setLocaleFromJsonString(phrases),this}get langOverride(){return this._langOverride}getLang(){return this.langOverride===`auto`?_utils_localization__WEBPACK_IMPORTED_MODULE_3__.v:this.langOverride}getAvailableLangs(){return`auto.en.ru.af.am.ar.az.bg.bn.bs.ca.cs.cy.da.de.el.es.et.eu.fa.fi.fr.gl.hi.hr.hu.hy.id.it.ja.jv.kk.km.kn.ko.lo.mk.ml.mn.ms.mt.my.ne.nl.pa.pl.pt.ro.si.sk.sl.sq.sr.su.sv.sw.tr.uk.ur.uz.vi.zh.zu`.split(`.`)}async reset(){for(let key of this.storageKeys)await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.delete(key);return this}buildUrl(path,force=!1){let query=force?`?timestamp=${(0,_utils_utils__WEBPACK_IMPORTED_MODULE_5__.lg)()}`:``;return`${this.localizationUrl}${path}${query}`}async changeLang(newLang){let oldLang=this.langOverride;return oldLang===newLang?!1:(await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.set(`localeLangOverride`,newLang),this._langOverride=newLang,this.lang=this.getLang(),await this.update(!0),!0)}async checkUpdates(force=!1){_utils_debug__WEBPACK_IMPORTED_MODULE_1__.A.log(`Check locale updates...`);try{let res=await(0,_utils_gm__WEBPACK_IMPORTED_MODULE_2__.G3)(this.buildUrl(`/hashes.json`,force));if(!res.ok)throw res.status;let hashes=await res.json();return await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.get(`localeHash`)===hashes[this.lang]?!1:hashes[this.lang]}catch(err){return console.error(`[VOT] [localizationProvider] Failed to get locales hash:`,err),!1}}async update(force=!1){let localeUpdatedAt=await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.get(`localeUpdatedAt`,0);if(!force&&localeUpdatedAt+this.cacheTTL>(0,_utils_utils__WEBPACK_IMPORTED_MODULE_5__.lg)()&&await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.get(`localeLang`)===this.lang)return this;let hash=await this.checkUpdates(force);if(await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.set(`localeUpdatedAt`,(0,_utils_utils__WEBPACK_IMPORTED_MODULE_5__.lg)()),!hash)return this;_utils_debug__WEBPACK_IMPORTED_MODULE_1__.A.log(`Updating locale...`);try{let res=await(0,_utils_gm__WEBPACK_IMPORTED_MODULE_2__.G3)(this.buildUrl(`/locales/${this.lang}.json`,force));if(!res.ok)throw res.status;let text=await res.text();await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.set(`localePhrases`,text),await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.set(`localeHash`,hash),await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.set(`localeLang`,this.lang),this.setLocaleFromJsonString(text)}catch(err){console.error(`[VOT] [localizationProvider] Failed to get locale:`,err),this.setLocaleFromJsonString(await _utils_storage__WEBPACK_IMPORTED_MODULE_4__.d.get(`localePhrases`,``))}return this}setLocaleFromJsonString(json){try{let locale=JSON.parse(json)||{};this.locale=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_5__.GW)(locale)}catch(err){console.error(`[VOT] [localizationProvider]`,err),this.locale={}}return this}getFromLocale(locale,key){return locale?.[key]??this.warnMissingKey(locale,key)}warnMissingKey(locale,key){console.warn(`[VOT] [localizationProvider] locale`,locale,`doesn't contain key`,key)}getDefault(key){return this.getFromLocale(this.defaultLocale,key)??key}get(key){return this.getFromLocale(this.locale,key)??this.getDefault(key)}}let localizationProvider=new LocalizationProvider;await localizationProvider.init(),__webpack_async_result__()}catch(e){__webpack_async_result__(e)}},1)},"./src/styles/main.scss":()=>{GM_addStyle(`.vot-button{--vot-helper-theme:var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243));--vot-helper-ontheme:var(--vot-ontheme-rgb,var(--vot-onprimary-rgb,255,255,255));box-sizing:border-box;vertical-align:middle;text-align:center;text-overflow:ellipsis;min-width:64px;height:36px;color:rgb(var(--vot-helper-ontheme));background-color:rgb(var(--vot-helper-theme));font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:pointer;outline:none;font-size:14px;font-weight:500;line-height:36px;transition:box-shadow .2s;display:inline-block;position:relative;box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f;border:none!important;border-radius:4px!important;padding:0 16px!important}.vot-button[hidden]{display:none!important}.vot-button::-moz-focus-inner{border:none!important}.vot-button:before,.vot-button:after{content:"";opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit!important}.vot-button:before{background-color:rgb(var(--vot-helper-ontheme));transition:opacity .2s}.vot-button:after{background:radial-gradient(circle,currentColor 1%,#0000 1%) 50%/10000% 10000% no-repeat;transition:opacity 1s,background-size .5s}.vot-button:hover{box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}.vot-button:hover:before{opacity:.08}.vot-button:active{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.vot-button:active:after{opacity:.32;background-size:100% 100%;transition:background-size}.vot-button[disabled=true]{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.12);color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);box-shadow:none;cursor:initial}.vot-button[disabled=true]:before,.vot-button[disabled=true]:after{opacity:0}.vot-outlined-button{--vot-helper-theme:var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243));box-sizing:border-box;vertical-align:middle;text-align:center;text-overflow:ellipsis;min-width:64px;height:36px;color:rgb(var(--vot-helper-theme));font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:pointer;background-color:#0000;outline:none;font-size:14px;font-weight:500;line-height:34px;display:inline-block;position:relative;border:solid 1px rgba(var(--vot-onsurface-rgb,0,0,0),.24)!important;border-radius:4px!important;margin:0!important;padding:0 16px!important}.vot-outlined-button[hidden]{display:none!important}.vot-outlined-button::-moz-focus-inner{border:none!important}.vot-outlined-button:before,.vot-outlined-button:after{content:"";opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;border-radius:3px!important}.vot-outlined-button:before{background-color:rgb(var(--vot-helper-theme));transition:opacity .2s}.vot-outlined-button:after{background:radial-gradient(circle,currentColor 1%,#0000 1%) 50%/10000% 10000% no-repeat;transition:opacity 1s,background-size .5s}.vot-outlined-button:hover:before{opacity:.04}.vot-outlined-button:active:after{opacity:.16;background-size:100% 100%;transition:background-size}.vot-outlined-button[disabled=true]{color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);cursor:initial;background-color:#0000}.vot-outlined-button[disabled=true]:before,.vot-outlined-button[disabled=true]:after{opacity:0}.vot-text-button{--vot-helper-theme:var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243));box-sizing:border-box;vertical-align:middle;text-align:center;text-overflow:ellipsis;min-width:64px;height:36px;color:rgb(var(--vot-helper-theme));font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:pointer;background-color:#0000;outline:none;font-size:14px;font-weight:500;line-height:36px;display:inline-block;position:relative;border:none!important;border-radius:4px!important;margin:0!important;padding:0 8px!important}.vot-text-button[hidden]{display:none!important}.vot-text-button::-moz-focus-inner{border:none!important}.vot-text-button:before,.vot-text-button:after{content:"";opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit!important}.vot-text-button:before{background-color:rgb(var(--vot-helper-theme));transition:opacity .2s}.vot-text-button:after{background:radial-gradient(circle,currentColor 1%,#0000 1%) 50%/10000% 10000% no-repeat;transition:opacity 1s,background-size .5s}.vot-text-button:hover:before{opacity:.04}.vot-text-button:active:after{opacity:.16;background-size:100% 100%;transition:background-size}.vot-text-button[disabled=true]{color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);cursor:initial;background-color:#0000}.vot-text-button[disabled=true]:before,.vot-text-button[disabled=true]:after{opacity:0}.vot-icon-button{--vot-helper-onsurface:rgba(var(--vot-onsurface-rgb,0,0,0),.87);box-sizing:border-box;vertical-align:middle;text-align:center;text-overflow:ellipsis;width:36px;height:36px;fill:var(--vot-helper-onsurface);color:var(--vot-helper-onsurface);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:pointer;background-color:#0000;outline:none;font-size:14px;font-weight:500;line-height:36px;display:inline-block;position:relative;border:none!important;border-radius:50%!important;margin:0!important;padding:0!important}.vot-icon-button[hidden]{display:none!important}.vot-icon-button::-moz-focus-inner{border:none!important}.vot-icon-button:before,.vot-icon-button:after{content:"";opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit!important}.vot-icon-button:before{background-color:var(--vot-helper-onsurface);transition:opacity .2s}.vot-icon-button:after{background:radial-gradient(circle,currentColor 1%,#0000 1%) 50%/10000% 10000% no-repeat;transition:opacity .3s,background-size .4s}.vot-icon-button:hover:before{opacity:.04}.vot-icon-button:active:after{opacity:.32;background-size:100% 100%;transition:background-size,opacity}.vot-icon-button[disabled=true]{color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);fill:rgba(var(--vot-onsurface-rgb,0,0,0),.38);cursor:initial;background-color:#0000}.vot-icon-button[disabled=true]:before,.vot-icon-button[disabled=true]:after{opacity:0}.vot-icon-button svg{fill:inherit;stroke:inherit;width:24px;height:36px}.vot-hotkey{justify-content:space-between;align-items:start;display:flex}.vot-hotkey-label{word-break:break-word;max-width:80%}.vot-hotkey-button{--vot-helper-surface:rgba(var(--vot-onsurface-rgb),.2);--vot-helper-theme:var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243));box-sizing:border-box;vertical-align:middle;text-align:center;width:fit-content;min-width:32px;height:fit-content;font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:pointer;background-color:#0000;outline:none;font-size:15px;line-height:1.5;display:inline-block;position:relative;border:solid 1px rgba(var(--vot-onsurface-rgb,0,0,0),.24)!important;border-radius:4px!important;margin:0!important;padding:0 8px!important}.vot-hotkey-button[hidden]{display:none!important}.vot-hotkey-button::-moz-focus-inner{border:none!important}.vot-hotkey-button:before,.vot-hotkey-button:after{content:"";opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;border-radius:3px!important}.vot-hotkey-button:before{background-color:rgb(var(--vot-helper-theme));transition:opacity .2s}.vot-hotkey-button:after{background:radial-gradient(circle,currentColor 1%,#0000 1%) 50%/10000% 10000% no-repeat;transition:opacity 1s,background-size .5s}.vot-hotkey-button:hover:before{opacity:.04}.vot-hotkey-button:active:after{opacity:.16;background-size:100% 100%;transition:background-size}.vot-hotkey-button[data-status=active]{color:rgb(var(--vot-helper-theme))}.vot-hotkey-button[data-status=active]:before{opacity:.04}.vot-hotkey-button[disabled=true]{color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);cursor:initial;background-color:#0000}.vot-hotkey-button[disabled=true]:before,.vot-hotkey-button[disabled=true]:after{opacity:0}.vot-textfield{display:inline-block;--vot-helper-theme:rgb(var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243)))!important;--vot-helper-safari1:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important;--vot-helper-safari2:rgba(var(--vot-onsurface-rgb,0,0,0),.6)!important;--vot-helper-safari3:rgba(var(--vot-onsurface-rgb,0,0,0),.87)!important;font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif)!important;text-align:start!important;padding-top:6px!important;font-size:16px!important;line-height:1.5!important;position:relative!important}.vot-textfield[hidden]{display:none!important}.vot-textfield>input,.vot-textfield>textarea{box-sizing:border-box!important;border-style:solid!important;border-width:1px!important;border-color:transparent var(--vot-helper-safari2)var(--vot-helper-safari2)!important;width:100%!important;height:inherit!important;color:rgba(var(--vot-onsurface-rgb,0,0,0),.87)!important;-webkit-text-fill-color:currentColor!important;font-family:inherit!important;font-size:inherit!important;line-height:inherit!important;caret-color:var(--vot-helper-theme)!important;background-color:#0000!important;border-radius:4px!important;margin:0!important;padding:15px 13px!important;transition:border .2s,box-shadow .2s!important;box-shadow:inset 1px 0 #0000,inset -1px 0 #0000,inset 0 -1px #0000!important}.vot-textfield>input:not(:focus):not(.vot-show-placeholer)::-moz-placeholder{color:#0000!important}.vot-textfield>textarea:not(:focus):not(.vot-show-placeholer)::-moz-placeholder{color:#0000!important}.vot-textfield>input:not(:focus):not(.vot-show-placeholer)::-moz-placeholder{color:#0000!important}.vot-textfield>textarea:not(:focus):not(.vot-show-placeholer)::-moz-placeholder{color:#0000!important}.vot-textfield>input:not(:focus):not(.vot-show-placeholer)::-webkit-input-placeholder{color:#0000!important}.vot-textfield>textarea:not(:focus):not(.vot-show-placeholer)::-webkit-input-placeholder{color:#0000!important}.vot-textfield>input:not(:focus):placeholder-shown,.vot-textfield>textarea:not(:focus):placeholder-shown{border-top-color:var(--vot-helper-safari2)!important}.vot-textfield>input+span,.vot-textfield>textarea+span{font-family:inherit;width:100%!important;max-height:100%!important;color:rgba(var(--vot-onsurface-rgb,0,0,0),.6)!important;cursor:text!important;pointer-events:none!important;font-size:75%!important;line-height:15px!important;transition:color .2s,font-size .2s,line-height .2s!important;display:flex!important;position:absolute!important;top:0!important;left:0!important}.vot-textfield>input:not(:focus):placeholder-shown+span,.vot-textfield>textarea:not(:focus):placeholder-shown+span{font-size:inherit!important;line-height:68px!important}.vot-textfield>input+span:before,.vot-textfield>input+span:after,.vot-textfield>textarea+span:before,.vot-textfield>textarea+span:after{content:""!important;box-sizing:border-box!important;border-top:solid 1px var(--vot-helper-safari2)!important;pointer-events:none!important;min-width:10px!important;height:8px!important;margin-top:6px!important;transition:border .2s,box-shadow .2s!important;display:block!important;box-shadow:inset 0 1px #0000!important}.vot-textfield>input+span:before,.vot-textfield>textarea+span:before{border-left:1px solid #0000!important;border-radius:4px 0!important;margin-right:4px!important}.vot-textfield>input+span:after,.vot-textfield>textarea+span:after{border-right:1px solid #0000!important;border-radius:0 4px!important;flex-grow:1!important;margin-left:4px!important}.vot-textfield>input.vot-show-placeholer+span:before,.vot-textfield>textarea.vot-show-placeholer+span:before{margin-right:0!important}.vot-textfield>input.vot-show-placeholer+span:after,.vot-textfield>textarea.vot-show-placeholer+span:after{margin-left:0!important}.vot-textfield>input:not(:focus):placeholder-shown+span:before,.vot-textfield>input:not(:focus):placeholder-shown+span:after,.vot-textfield>textarea:not(:focus):placeholder-shown+span:before,.vot-textfield>textarea:not(:focus):placeholder-shown+span:after{border-top-color:#0000!important}.vot-textfield:hover>input:not(:disabled),.vot-textfield:hover>textarea:not(:disabled){border-color:transparent var(--vot-helper-safari3)var(--vot-helper-safari3)!important}.vot-textfield:hover>input:not(:disabled)+span:before,.vot-textfield:hover>input:not(:disabled)+span:after,.vot-textfield:hover>textarea:not(:disabled)+span:before,.vot-textfield:hover>textarea:not(:disabled)+span:after{border-top-color:var(--vot-helper-safari3)!important}.vot-textfield:hover>input:not(:disabled):not(:focus):placeholder-shown,.vot-textfield:hover>textarea:not(:disabled):not(:focus):placeholder-shown{border-color:var(--vot-helper-safari3)!important}.vot-textfield>input:focus,.vot-textfield>textarea:focus{border-color:transparent var(--vot-helper-theme)var(--vot-helper-theme)!important;box-shadow:inset 1px 0 var(--vot-helper-theme),inset -1px 0 var(--vot-helper-theme),inset 0 -1px var(--vot-helper-theme)!important;outline:none!important}.vot-textfield>input:focus+span,.vot-textfield>textarea:focus+span{color:var(--vot-helper-theme)!important}.vot-textfield>input:focus+span:before,.vot-textfield>input:focus+span:after,.vot-textfield>textarea:focus+span:before,.vot-textfield>textarea:focus+span:after{border-top-color:var(--vot-helper-theme)!important;box-shadow:inset 0 1px var(--vot-helper-theme)!important}.vot-textfield>input:disabled,.vot-textfield>input:disabled+span,.vot-textfield>textarea:disabled,.vot-textfield>textarea:disabled+span{border-color:transparent var(--vot-helper-safari1)var(--vot-helper-safari1)!important;color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important;pointer-events:none!important}.vot-textfield>input:disabled+span:before,.vot-textfield>input:disabled+span:after,.vot-textfield>textarea:disabled+span:before,.vot-textfield>textarea:disabled+span:after,.vot-textfield>input:disabled:placeholder-shown,.vot-textfield>input:disabled:placeholder-shown+span,.vot-textfield>textarea:disabled:placeholder-shown,.vot-textfield>textarea:disabled:placeholder-shown+span{border-top-color:var(--vot-helper-safari1)!important}.vot-textfield>input:disabled:placeholder-shown+span:before,.vot-textfield>input:disabled:placeholder-shown+span:after,.vot-textfield>textarea:disabled:placeholder-shown+span:before,.vot-textfield>textarea:disabled:placeholder-shown+span:after{border-top-color:#0000!important}@media not all and (-webkit-min-device-pixel-ratio:.0000264583),not all and (min-resolution:.001dpcm){@supports ((-webkit-appearance:none)){.vot-textfield>input,.vot-textfield>input+span,.vot-textfield>textarea,.vot-textfield>textarea+span,.vot-textfield>input+span:before,.vot-textfield>input+span:after,.vot-textfield>textarea+span:before,.vot-textfield>textarea+span:after{transition-duration:.1s!important}}}.vot-checkbox{--vot-helper-theme:var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243));--vot-helper-ontheme:var(--vot-ontheme-rgb,var(--vot-onprimary-rgb,255,255,255));z-index:0;color:rgba(var(--vot-onsurface-rgb,0,0,0),.87);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);text-align:start;font-size:16px;line-height:1.5;display:inline-block;position:relative}.vot-checkbox-sub{padding-left:28px!important}.vot-checkbox[hidden]{display:none!important}.vot-checkbox>input{-webkit-appearance:none;appearance:none;z-index:10000;box-sizing:border-box;opacity:1;cursor:pointer;background:0 0;outline:none;width:18px;height:18px;transition:border-color .2s,background-color .2s;display:block;position:absolute;border:2px solid!important;border-color:rgba(var(--vot-onsurface-rgb,0,0,0),.6)!important;border-radius:2px!important;margin:3px 1px!important;padding:0!important}.vot-checkbox>input+span{box-sizing:border-box;width:inherit;cursor:pointer;font-family:inherit;font-weight:400;display:inline-block;position:relative;padding-left:30px!important}.vot-checkbox>input+span:before{content:"";background-color:rgb(var(--vot-onsurface-rgb,0,0,0));opacity:0;pointer-events:none;width:40px;height:40px;transition:opacity .3s,transform .2s;display:block;position:absolute;top:-8px;left:-10px;transform:scale(1);border-radius:50%!important}.vot-checkbox>input+span:after{content:"";z-index:10000;pointer-events:none;width:10px;height:5px;transition:border-color .2s;display:block;position:absolute;top:3px;left:1px;transform:translate(3px,4px)rotate(-45deg);box-sizing:content-box!important;border:0 solid #0000!important;border-width:0 0 2px 2px!important}.vot-checkbox>input:checked,.vot-checkbox>input:indeterminate{background-color:rgb(var(--vot-helper-theme));border-color:rgb(var(--vot-helper-theme))!important}.vot-checkbox>input:checked+span:before,.vot-checkbox>input:indeterminate+span:before{background-color:rgb(var(--vot-helper-theme))}.vot-checkbox>input:checked+span:after,.vot-checkbox>input:indeterminate+span:after{border-color:rgb(var(--vot-helper-ontheme,255,255,255))!important}.vot-checkbox>input:hover{box-shadow:none!important}.vot-checkbox>input:indeterminate+span:after{transform:translate(4px,3px);border-left-width:0!important}.vot-checkbox:hover>input+span:before{opacity:.04}.vot-checkbox:active>input,.vot-checkbox:active:hover>input:not(:disabled){border-color:rgb(var(--vot-helper-theme))!important}.vot-checkbox:active>input:checked{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.6);border-color:#0000!important}.vot-checkbox:active>input+span:before{opacity:1;transition:transform,opacity;transform:scale(0)}.vot-checkbox>input:disabled{cursor:initial;border-color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important}.vot-checkbox>input:disabled:checked,.vot-checkbox>input:disabled:indeterminate{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);border-color:#0000!important}.vot-checkbox>input:disabled+span{color:rgba(var(--vot-onsurface-rgb,0,0,0),.38);cursor:initial}.vot-checkbox>input:disabled+span:before{opacity:0;transform:scale(0)}.vot-slider{display:inline-block;--vot-safari-helper1:rgba(var(--vot-primary-rgb,33,150,243),.04)!important;--vot-safari-helper2:rgba(var(--vot-primary-rgb,33,150,243),.12)!important;--vot-safari-helper3:rgba(var(--vot-primary-rgb,33,150,243),.16)!important;--vot-safari-helper4:rgba(var(--vot-primary-rgb,33,150,243),.24)!important;width:100%!important;color:rgba(var(--vot-onsurface-rgb,0,0,0),.87)!important;font-family:var(--vot-font,"Roboto","Segoe UI",BlinkMacSystemFont,system-ui,-apple-system)!important;text-align:start!important;font-size:16px!important;line-height:1.5!important}.vot-slider[hidden]{display:none!important}.vot-slider>input{-webkit-appearance:none!important;appearance:none!important;cursor:pointer!important;background-color:#0000!important;border:none!important;width:100%!important;height:36px!important;margin:0 0 -36px!important;padding:0!important;display:block!important;position:relative!important;top:24px!important}.vot-slider>input:hover{box-shadow:none!important}.vot-slider>input:last-child{margin:0!important;position:static!important}.vot-slider>input:before{content:""!important;width:calc(100%*var(--vot-progress,0))!important;background:rgb(var(--vot-primary-rgb,33,150,243))!important;height:2px!important;display:block!important;position:absolute!important;top:calc(50% - 1px)!important}.vot-slider>input:disabled{cursor:default!important;opacity:.38!important}.vot-slider>input:disabled+span{color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important}.vot-slider>input:disabled::-webkit-slider-runnable-track{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important}.vot-slider>input:disabled::-moz-range-track{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important}.vot-slider>input:disabled::-ms-fill-lower{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important}.vot-slider>input:disabled::-ms-fill-upper{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)!important}.vot-slider>input:disabled::-moz-range-thumb{background-color:rgb(var(--vot-onsurface-rgb,0,0,0))!important;box-shadow:0 0 0 1px rgb(var(--vot-surface-rgb,255,255,255))!important;transform:scale(4)!important}.vot-slider>input:disabled::-ms-thumb{background-color:rgb(var(--vot-onsurface-rgb,0,0,0))!important;box-shadow:0 0 0 1px rgb(var(--vot-surface-rgb,255,255,255))!important;transform:scale(4)!important}.vot-slider>input:disabled::-webkit-slider-thumb{background-color:rgb(var(--vot-onsurface-rgb,0,0,0))!important;box-shadow:0 0 0 1px rgb(var(--vot-surface-rgb,255,255,255))!important;transform:scale(4)!important}.vot-slider>input:disabled::-ms-fill-upper{opacity:.38!important}.vot-slider>input:disabled::-moz-range-progress{background-color:rgba(var(--vot-onsurface-rgb,0,0,0),.87)!important}.vot-slider>input:disabled:-webkit-slider-thumb{color:rgb(var(--vot-surface-rgb,255,255,255))!important}.vot-slider>input:active::-webkit-slider-thumb{box-shadow:0 0 0 2px var(--vot-safari-helper4)!important}.vot-slider>input:active::-moz-range-thumb{box-shadow:0 0 0 2px rgba(var(--vot-primary-rgb,33,150,243),.24)!important}.vot-slider>input:active::-ms-thumb{box-shadow:0 0 0 2px rgba(var(--vot-primary-rgb,33,150,243),.24)!important}.vot-slider>input:focus{outline:none!important}.vot-slider>input::-webkit-slider-runnable-track{background-color:rgba(var(--vot-primary-rgb,33,150,243),.24)!important;border-radius:1px!important;width:100%!important;height:2px!important;margin:17px 0!important}.vot-slider>input::-moz-range-track{background-color:rgba(var(--vot-primary-rgb,33,150,243),.24)!important;border-radius:1px!important;width:100%!important;height:2px!important;margin:17px 0!important}.vot-slider>input::-ms-track{box-sizing:border-box!important;background-color:#0000!important;border:none!important;border-radius:1px!important;width:100%!important;height:2px!important;margin:17px 0!important;padding:0 17px!important}.vot-slider>input::-webkit-slider-thumb{-webkit-appearance:none!important;appearance:none!important;background-color:rgb(var(--vot-primary-rgb,33,150,243))!important;border:none!important;border-radius:50%!important;width:2px!important;height:2px!important;transition:box-shadow .2s!important;transform:scale(6)!important}.vot-slider>input::-moz-range-thumb{-webkit-appearance:none!important;appearance:none!important;background-color:rgb(var(--vot-primary-rgb,33,150,243))!important;border:none!important;border-radius:50%!important;width:2px!important;height:2px!important;transition:box-shadow .2s!important;transform:scale(6)!important}.vot-slider>input::-ms-thumb{-webkit-appearance:none!important;appearance:none!important;background-color:rgb(var(--vot-primary-rgb,33,150,243))!important;border:none!important;border-radius:50%!important;width:2px!important;height:2px!important;transition:box-shadow .2s!important;transform:scale(6)!important}.vot-slider>input::-webkit-slider-thumb{-webkit-appearance:none!important;margin:0!important}.vot-slider>input::-moz-range-thumb{-moz-appearance:none!important}.vot-slider>input::-ms-thumb{margin:0 17px!important}.vot-slider>input::-moz-range-progress{background-color:rgb(var(--vot-primary-rgb,33,150,243))!important;border-radius:1px!important;height:2px!important}.vot-slider>input::-ms-fill-lower{background-color:rgb(var(--vot-primary-rgb,33,150,243))!important;border-radius:1px!important;height:2px!important}.vot-slider>input::-ms-fill-upper{background-color:rgb(var(--vot-primary-rgb,33,150,243))!important;border-radius:1px!important;height:2px!important}.vot-slider>input::-moz-focus-outer{border:none!important}.vot-slider>span{margin-bottom:36px!important;display:inline-block!important}.vot-slider:hover>input::-webkit-slider-thumb{box-shadow:0 0 0 2px var(--vot-safari-helper1)!important}.vot-slider:hover>input::-ms-thumb{box-shadow:0 0 0 2px rgba(var(--vot-primary-rgb,33,150,243),.04)!important}.vot-slider:hover>input:hover::-moz-range-thumb{box-shadow:0 0 0 2px rgba(var(--vot-primary-rgb,33,150,243),.04)!important}.vot-slider-label-value{margin-left:4px!important}.vot-select{font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);text-align:start;color:var(--vot-helper-theme);fill:var(--vot-helper-theme);justify-content:space-between;align-items:center;font-size:14px;font-weight:400;line-height:1.5;display:flex;--vot-helper-theme-rgb:var(--vot-onsurface-rgb,0,0,0)!important;--vot-helper-theme:rgba(var(--vot-helper-theme-rgb),.87)!important;--vot-helper-safari1:rgba(var(--vot-onsurface-rgb,0,0,0),.6)!important;--vot-helper-safari2:rgba(var(--vot-onsurface-rgb,0,0,0),.87)!important}.vot-select[hidden]{display:none!important}.vot-select-outer{cursor:pointer;justify-content:space-between;align-items:center;width:120px;max-width:120px;display:flex;border:1px solid var(--vot-helper-safari1)!important;border-radius:4px!important;padding:0 5px!important;transition:border .2s!important}.vot-select-outer:hover{border-color:var(--vot-helper-safari2)!important}.vot-select-title{text-overflow:ellipsis;white-space:nowrap;font-family:inherit;overflow:hidden}.vot-select-arrow-icon{justify-content:center;align-items:center;width:20px;height:32px;display:flex}.vot-select-arrow-icon svg{fill:inherit;stroke:inherit}.vot-select-content-list{flex-direction:column;display:flex}.vot-select-content-list .vot-select-content-item{cursor:pointer;border-radius:8px!important;padding:5px 10px!important}.vot-select-content-list .vot-select-content-item:not([inert]):hover{background-color:#2a2c31}.vot-select-content-list .vot-select-content-item[data-vot-selected=true]{color:rgb(var(--vot-primary-rgb,33,150,243));background-color:rgba(var(--vot-primary-rgb,33,150,243),.2)}.vot-select-content-list .vot-select-content-item[data-vot-selected=true]:hover{background-color:rgba(var(--vot-primary-rgb,33,150,243),.1)!important}.vot-select-content-list .vot-select-content-item[inert]{cursor:default;color:rgba(var(--vot-onsurface-rgb,0,0,0),.38)}.vot-select-content-list .vot-select-content-item[hidden]{display:none!important}.vot-header{color:rgba(var(--vot-helper-onsurface-rgb),.87);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);text-align:start;font-weight:700;line-height:1.5}.vot-header[hidden]{display:none!important}.vot-header:not(:first-child){padding-top:8px}.vot-header-level-1{font-size:2em}.vot-header-level-2{font-size:1.5em}.vot-header-level-3{font-size:1.17em}.vot-header-level-4{font-size:1em}.vot-header-level-5{font-size:.83em}.vot-header-level-6{font-size:.67em}.vot-info{color:rgba(var(--vot-helper-onsurface-rgb),.87);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);text-align:start;-webkit-user-select:text;user-select:text;font-size:16px;line-height:1.5;display:flex}.vot-info[hidden]{display:none!important}.vot-info>:not(:first-child){color:rgba(var(--vot-helper-onsurface-rgb),.5);flex:1;margin-left:8px!important}.vot-details{color:rgba(var(--vot-helper-onsurface-rgb),.87);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);text-align:start;cursor:pointer;justify-content:space-between;align-items:center;font-size:16px;line-height:1.5;transition:background .5s;display:flex;border-radius:.5em!important;margin:-.5em!important;padding:.5em!important}.vot-details[hidden]{display:none!important}.vot-details-arrow-icon{width:20px;height:32px;fill:rgba(var(--vot-helper-onsurface-rgb),.87);justify-content:center;align-items:center;display:flex;transform:scale(1.25)rotate(-90deg)}.vot-details:hover{background:rgba(var(--vot-onsurface-rgb,0,0,0),.04)}.vot-lang-select{--vot-helper-theme-rgb:var(--vot-onsurface-rgb,0,0,0);--vot-helper-theme:rgba(var(--vot-helper-theme-rgb),.87);color:var(--vot-helper-theme);fill:var(--vot-helper-theme);justify-content:space-between;align-items:center;display:flex}.vot-lang-select[hidden]{display:none!important}.vot-lang-select-icon{justify-content:center;align-items:center;width:32px;height:32px;display:flex}.vot-lang-select-icon svg{fill:inherit;stroke:inherit}.vot-segmented-button{--vot-helper-theme-rgb:var(--vot-onsurface-rgb,0,0,0);--vot-helper-theme:rgba(var(--vot-helper-theme-rgb),.87);-webkit-user-select:none;user-select:none;background:rgb(var(--vot-surface-rgb,255,255,255));max-width:100vw;height:32px;color:var(--vot-helper-theme);fill:var(--vot-helper-theme);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:default;z-index:2147483647;align-items:center;font-size:16px;line-height:1.5;transition:opacity .5s;display:flex;position:absolute;top:5rem;left:50%;overflow:hidden;transform:translate(-50%);border-radius:4px!important}.vot-segmented-button[hidden]{display:none!important}.vot-segmented-button *{box-sizing:border-box!important}.vot-segmented-button .vot-separator{background:rgba(var(--vot-helper-theme-rgb),.1);width:1px;height:50%}.vot-segmented-button .vot-separator[hidden]{display:none!important}.vot-segmented-button .vot-segment,.vot-segmented-button .vot-segment-only-icon{height:100%;color:inherit;background-color:#0000;justify-content:center;align-items:center;transition:background-color .1s ease-in-out;display:flex;position:relative;overflow:hidden;border:none!important;padding:0 8px!important}.vot-segmented-button .vot-segment[hidden],.vot-segmented-button [hidden].vot-segment-only-icon{display:none!important}.vot-segmented-button .vot-segment:before,.vot-segmented-button .vot-segment-only-icon:before,.vot-segmented-button .vot-segment:after,.vot-segmented-button .vot-segment-only-icon:after{content:"";opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;border-radius:inherit!important}.vot-segmented-button .vot-segment:before,.vot-segmented-button .vot-segment-only-icon:before{background-color:rgb(var(--vot-helper-theme-rgb));transition:opacity .2s}.vot-segmented-button .vot-segment:after,.vot-segmented-button .vot-segment-only-icon:after{background:radial-gradient(circle,currentColor 1%,#0000 1%) 50%/10000% 10000% no-repeat;transition:opacity 1s,background-size .5s}.vot-segmented-button .vot-segment:hover:before,.vot-segmented-button .vot-segment-only-icon:hover:before{opacity:.04}.vot-segmented-button .vot-segment:active:after,.vot-segmented-button .vot-segment-only-icon:active:after{opacity:.16;background-size:100% 100%;transition:background-size}.vot-segmented-button .vot-segment-only-icon{min-width:32px;padding:0!important}.vot-segmented-button .vot-segment-label{white-space:nowrap;color:inherit;font-weight:400;margin-left:8px!important}.vot-segmented-button[data-status=success] .vot-translate-button{color:rgb(var(--vot-primary-rgb,33,150,243));fill:rgb(var(--vot-primary-rgb,33,150,243))}.vot-segmented-button[data-status=error] .vot-translate-button{color:#f28b82;fill:#f28b82}.vot-segmented-button[data-loading=true] #vot-loading-icon{display:block!important}.vot-segmented-button[data-loading=true] #vot-translate-icon{display:none!important}.vot-segmented-button[data-direction=column]{flex-direction:column;height:fit-content}.vot-segmented-button[data-direction=column] .vot-segment-label{display:none}.vot-segmented-button[data-direction=column]>.vot-segment-only-icon,.vot-segmented-button[data-direction=column]>.vot-segment{padding:8px!important}.vot-segmented-button[data-direction=column] .vot-separator{width:50%;height:1px}.vot-segmented-button[data-position=left]{top:12.5vh;left:50px}.vot-segmented-button[data-position=right]{top:12.5vh;left:auto;right:0}.vot-segmented-button svg{width:24px;fill:inherit;stroke:inherit}.vot-tooltip{--vot-helper-theme-rgb:var(--vot-onsurface-rgb,0,0,0);--vot-helper-theme:rgba(var(--vot-helper-theme-rgb),.87);--vot-helper-ondialog:rgb(var(--vot-ondialog-rgb,37,38,40));--vot-helper-border:rgb(var(--vot-tooltip-border,69,69,69));-webkit-user-select:none;user-select:none;background:rgb(var(--vot-surface-rgb,255,255,255));color:var(--vot-helper-theme);fill:var(--vot-helper-theme);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:default;z-index:2147483647;opacity:0;align-items:center;width:max-content;max-width:calc(100vw - 10px);height:max-content;font-size:14px;line-height:1.5;transition:opacity .5s;display:flex;position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden;box-shadow:0 1px 3px #0000001f;border-radius:4px!important;padding:4px 8px!important}.vot-tooltip[hidden]{display:none!important}.vot-tooltip[data-trigger=click]{-webkit-user-select:text;user-select:text}.vot-tooltip.vot-tooltip-bordered{border:1px solid var(--vot-helper-border)}.vot-tooltip *{box-sizing:border-box!important}.vot-menu{--vot-helper-surface-rgb:var(--vot-surface-rgb,255,255,255);--vot-helper-surface:rgb(var(--vot-helper-surface-rgb));--vot-helper-onsurface-rgb:var(--vot-onsurface-rgb,0,0,0);--vot-helper-onsurface:rgba(var(--vot-helper-onsurface-rgb),.87);-webkit-user-select:none;user-select:none;background-color:var(--vot-helper-surface);color:var(--vot-helper-onsurface);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);cursor:default;z-index:2147483647;visibility:visible;opacity:1;transform-origin:top;min-width:300px;font-size:16px;line-height:1.5;transition:opacity .3s,transform .1s;position:absolute;top:calc(5rem + 48px);left:50%;overflow:hidden;transform:translate(-50%)scale(1);border-radius:8px!important}.vot-menu *{box-sizing:border-box!important}.vot-menu[hidden]{pointer-events:none;visibility:hidden;opacity:0;transform:translate(-50%)scale(0);display:block!important}.vot-menu-content-wrapper{min-height:100px;max-height:calc(var(--vot-container-height,75vh) - (5rem + 32px + 16px)*2);flex-direction:column;display:flex;overflow:auto}.vot-menu-header-container{flex-shrink:0;align-items:flex-start;min-height:31px;display:flex}.vot-menu-header-container:empty{padding:0 0 16px!important}.vot-menu-header-container>.vot-icon-button{margin-inline-end:4px!important;margin-top:4px!important}.vot-menu-title-container{font-size:inherit;font-weight:inherit;text-align:start;outline:0;flex:1;display:flex;margin:0!important}.vot-menu-title{flex:1;font-size:16px;font-weight:400;line-height:1;padding:16px!important}.vot-menu-body-container{box-sizing:border-box;overscroll-behavior:contain;flex-direction:column;gap:8px;min-height:1.375rem;display:flex;overflow:auto;scrollbar-color:rgba(var(--vot-helper-onsurface-rgb),.1)var(--vot-helper-surface)!important;padding:0 16px!important}.vot-menu-body-container::-webkit-scrollbar{background:var(--vot-helper-surface)!important;width:12px!important;height:12px!important}.vot-menu-body-container::-webkit-scrollbar-track{background:var(--vot-helper-surface)!important;width:12px!important;height:12px!important}.vot-menu-body-container::-webkit-scrollbar-thumb{background:rgba(var(--vot-helper-onsurface-rgb),.1)!important;border:5px solid var(--vot-helper-surface)!important;-webkit-border-radius:1ex!important}.vot-menu-body-container::-webkit-scrollbar-thumb:hover{border:3px solid var(--vot-helper-surface)!important}.vot-menu-body-container::-webkit-scrollbar-corner{background:var(--vot-helper-surface)!important}.vot-menu-footer-container{flex-shrink:0;justify-content:flex-end;display:flex;padding:16px!important}.vot-menu-footer-container:empty{padding:16px 0 0!important}.vot-menu[data-position=left]{transform-origin:0;top:12.5vh;left:240px}.vot-menu[data-position=right]{transform-origin:100%;top:12.5vh;left:auto;right:-80px}.vot-dialog{--vot-helper-surface-rgb:var(--vot-surface-rgb,255,255,255);--vot-helper-surface:rgb(var(--vot-helper-surface-rgb));--vot-helper-onsurface-rgb:var(--vot-onsurface-rgb,0,0,0);--vot-helper-onsurface:rgba(var(--vot-helper-onsurface-rgb),.87);max-width:initial;max-height:initial;width:min(var(--vot-dialog-width,512px),100%);top:50%;bottom:50%;background-color:var(--vot-helper-surface);height:fit-content;color:var(--vot-helper-onsurface);font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);-webkit-user-select:none;user-select:none;visibility:visible;opacity:1;transform-origin:50%;border-radius:8px;font-size:16px;line-height:1.5;transition:opacity .3s,transform .1s;display:block;position:fixed;top:0;bottom:0;left:0;right:0;overflow-x:auto;overflow-y:hidden;transform:scale(1);box-shadow:0 0 16px #0000001f,0 16px 16px #0000003d;margin:auto!important;padding:0!important}[hidden]>.vot-dialog{pointer-events:none;opacity:0;transition:opacity .1s,transform .2s;transform:scale(.5)}.vot-dialog-container{visibility:visible;z-index:2147483647;position:absolute}.vot-dialog-container[hidden]{pointer-events:none;visibility:hidden;display:block!important}.vot-dialog-container *{box-sizing:border-box!important}.vot-dialog-backdrop{opacity:1;background-color:#0009;transition:opacity .3s;position:fixed;top:0;bottom:0;left:0;right:0}[hidden]>.vot-dialog-backdrop{pointer-events:none;opacity:0}.vot-dialog-content-wrapper{flex-direction:column;max-height:75vh;display:flex;overflow:auto}.vot-dialog-header-container{flex-shrink:0;align-items:flex-start;min-height:31px;display:flex}.vot-dialog-header-container:empty{padding:0 0 20px}.vot-dialog-header-container>.vot-icon-button{margin-inline-end:4px!important;margin-top:4px!important}.vot-dialog-title-container{font-size:inherit;font-weight:inherit;outline:0;flex:1;display:flex;margin:0!important}.vot-dialog-title{flex:1;font-size:115.385%;font-weight:700;line-height:1;padding:20px 20px 16px!important}.vot-dialog-body-container{box-sizing:border-box;overscroll-behavior:contain;flex-direction:column;gap:16px;min-height:1.375rem;display:flex;overflow:auto;scrollbar-color:rgba(var(--vot-helper-onsurface-rgb),.1)var(--vot-helper-surface)!important;padding:0 20px!important}.vot-dialog-body-container::-webkit-scrollbar{background:var(--vot-helper-surface)!important;width:12px!important;height:12px!important}.vot-dialog-body-container::-webkit-scrollbar-track{background:var(--vot-helper-surface)!important;width:12px!important;height:12px!important}.vot-dialog-body-container::-webkit-scrollbar-thumb{background:rgba(var(--vot-helper-onsurface-rgb),.1)!important;border:5px solid var(--vot-helper-surface)!important;-webkit-border-radius:1ex!important}.vot-dialog-body-container::-webkit-scrollbar-thumb:hover{border:3px solid var(--vot-helper-surface)!important}.vot-dialog-body-container::-webkit-scrollbar-corner{background:var(--vot-helper-surface)!important}.vot-dialog-footer-container{flex-shrink:0;justify-content:flex-end;display:flex;padding:16px!important}.vot-dialog-footer-container:empty{padding:20px 0 0!important}.vot-inline-loader{aspect-ratio:5;--vot-loader-bg:no-repeat radial-gradient(farthest-side,rgba(var(--vot-onsurface-rgb,0,0,0),.38)94%,transparent);background:var(--vot-loader-bg),var(--vot-loader-bg),var(--vot-loader-bg),var(--vot-loader-bg);background-size:20% 100%;height:8px;animation:.75s infinite alternate dotsSlide,1.5s infinite alternate dotsFlip}.vot-loader-text{--vot-helper-theme:var(--vot-theme-rgb,var(--vot-primary-rgb,33,150,243));fill:rgb(var(--vot-helper-theme));font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);font-size:12px;font-weight:500}@keyframes dotsSlide{0%,10%{background-position:0 0,0 0,0 0,0 0}33%{background-position:0 0,33.3333% 0,33.3333% 0,33.3333% 0}66%{background-position:0 0,33.3333% 0,66.6667% 0,66.6667% 0}90%,to{background-position:0 0,33.3333% 0,66.6667% 0,100% 0}}@keyframes dotsFlip{0%,49.99%{transform:scale(1)}50%,to{transform:scale(-1)}}.vot-label{align-items:center;gap:4px;font-family:inherit;font-size:16px;display:flex}.vot-label-icon{width:20px;height:20px;margin-top:2px}.vot-label-icon>svg{width:20px;height:20px}.vot-account{justify-content:space-between;align-items:center;gap:1rem;display:flex}.vot-account-container,.vot-account-wrapper,.vot-account-buttons{align-items:center;gap:1rem;display:flex}.vot-account-avatar{min-width:36px;max-width:36px;min-height:36px;max-height:36px;overflow:hidden}.vot-account-avatar-img{object-fit:cover;border-radius:50%;width:36px;height:36px}.vot-account [hidden]{display:none!important}.vot-subtitles{--vot-subtitles-background:rgba(var(--vot-surface-rgb,46,47,52),var(--vot-subtitles-opacity,.8));background:var(--vot-subtitles-background,#2e2f34cc);width:max-content;max-width:100%;max-height:100%;color:var(--vot-subtitles-color,#e3e3e3);pointer-events:all;font-size:20px;font-family:var(--vot-font-family,"Roboto","Segoe UI",system-ui,sans-serif);box-sizing:border-box;-webkit-user-select:none;user-select:none;flex-wrap:wrap;gap:0 3px;line-height:normal;display:flex;position:relative;border-radius:.5em!important;padding:.5em!important}.vot-subtitles-widget{z-index:2147483647;pointer-events:none;justify-content:center;align-items:center;width:50%;min-height:20%;max-height:100%;display:flex;position:absolute;top:75%;left:25%}.vot-subtitles-info{flex-direction:column;gap:2px;display:flex;padding:6px!important}.vot-subtitles-info-service{color:var(--vot-subtitles-context-color,#86919b);margin-bottom:8px!important;font-size:10px!important;line-height:1!important}.vot-subtitles-info-header{color:var(--vot-subtitles-header-color,#fff);margin-bottom:6px!important;font-size:20px!important;font-weight:500!important;line-height:1!important}.vot-subtitles-info-context{color:var(--vot-subtitles-context-color,#86919b);font-size:12px!important;line-height:1.2!important}.vot-subtitles span{cursor:pointer;position:relative;font-size:inherit!important;font-family:inherit!important;line-height:normal!important}.vot-subtitles span.passed{color:var(--vot-subtitles-passed-color,#2196f3)}.vot-subtitles span:before{content:"";z-index:-1;width:100%;height:100%;position:absolute;top:2px;bottom:2px;left:-2px;right:-2px;border-radius:4px!important;padding:0 2px!important}.vot-subtitles span:hover:before{background:var(--vot-subtitles-hover-color,#ffffff8c)}.vot-subtitles span.selected:before{background:var(--vot-subtitles-passed-color,#2196f3)}#vot-subtitles-info.vot-subtitles-info *{-webkit-user-select:text!important;user-select:text!important}:root{--vot-font-family:"Roboto","Segoe UI",system-ui,sans-serif;--vot-primary-rgb:139,180,245;--vot-onprimary-rgb:32,33,36;--vot-surface-rgb:32,33,36;--vot-onsurface-rgb:227,227,227;--vot-subtitles-color:rgb(var(--vot-onsurface-rgb,227,227,227));--vot-subtitles-passed-color:rgb(var(--vot-primary-rgb,33,150,243))}vot-block{font-family:inherit;display:block;visibility:visible!important}.vot-portal{display:inline}.vot-portal-local{z-index:2147483647;position:fixed;top:0;left:0}`)},"./src/subtitles.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{I:()=>SubtitlesProcessor,o:()=>SubtitlesWidget});var _vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/@vot.js/ext/dist/helpers/youtube.js`),_vot_js_shared_utils_subs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/subs.js`),lit_html__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_config_config_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(`./src/config/config.js`),_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/localization/localizationProvider.ts`),_ui_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/ui.js`),_ui_components_tooltip_ts__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/ui/components/tooltip.ts`),_utils_gm_ts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/gm.ts`),_utils_localization_ts__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/utils/localization.ts`),_utils_storage_ts__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./src/utils/storage.ts`),_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/utils/translateApis.ts`),_utils_utils_ts__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__,_ui_js__WEBPACK_IMPORTED_MODULE_3__,_ui_components_tooltip_ts__WEBPACK_IMPORTED_MODULE_4__,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_5__,_utils_localization_ts__WEBPACK_IMPORTED_MODULE_6__,_utils_storage_ts__WEBPACK_IMPORTED_MODULE_7__,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_8__,_utils_utils_ts__WEBPACK_IMPORTED_MODULE_9__]);[_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__,_ui_js__WEBPACK_IMPORTED_MODULE_3__,_ui_components_tooltip_ts__WEBPACK_IMPORTED_MODULE_4__,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_5__,_utils_localization_ts__WEBPACK_IMPORTED_MODULE_6__,_utils_storage_ts__WEBPACK_IMPORTED_MODULE_7__,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_8__,_utils_utils_ts__WEBPACK_IMPORTED_MODULE_9__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class SubtitlesProcessor{static formatYandexTokens(line){let lineEndMs=line.startMs+line.durationMs;return line.tokens.reduce((result,token,index)=>{let nextToken=line.tokens[index+1],lastToken=result[result.length-1],alignRangeEnd=lastToken?.alignRange?.end??0,newAlignRangeEnd=alignRangeEnd+token.text.length;if(token.alignRange={start:alignRangeEnd,end:newAlignRangeEnd},result.push(token),nextToken){let endMs=token.startMs+token.durationMs,durationMs=nextToken.startMs?nextToken.startMs-endMs:lineEndMs-endMs;result.push({text:` `,startMs:endMs,durationMs,alignRange:{start:newAlignRangeEnd,end:newAlignRangeEnd+1}})}return result},[])}static createTokens(line,previousLineLastToken){let tokens=line.text.split(/([\n \t])/).reduce((result,tokenText)=>{if(!tokenText.length)return result;let lastToken=result[result.length-1]??previousLineLastToken,alignRangeStart=lastToken?.alignRange?.end??0,alignRangeEnd=alignRangeStart+tokenText.length;return result.push({text:tokenText,alignRange:{start:alignRangeStart,end:alignRangeEnd}}),result},[]),tokenDurationMs=Math.floor(line.durationMs/tokens.length),lineEndMs=line.startMs+line.durationMs;return tokens.map((token,index)=>{let isLastToken=index===tokens.length-1,startMs=line.startMs+tokenDurationMs*index,durationMs=isLastToken?lineEndMs-startMs:tokenDurationMs;return{...token,startMs,durationMs}})}static processTokens(subtitles,subtitlesObject){let result=[],lastToken,{source,isAutoGenerated}=subtitlesObject;for(let line of subtitles.subtitles){let hasTokens=line?.tokens?.length,tokens=hasTokens&&(source===`yandex`||source===`youtube`&&isAutoGenerated)?SubtitlesProcessor.formatYandexTokens(line):SubtitlesProcessor.createTokens(line,lastToken);lastToken=tokens[tokens.length-1],result.push({...line,tokens})}return subtitles.containsTokens=!0,result}static formatYoutubeSubtitles(subtitles,isAsr=!1){if(!subtitles?.events?.length)return console.error(`[VOT] Invalid YouTube subtitles format:`,subtitles),{containsTokens:isAsr,subtitles:[]};let result={containsTokens:isAsr,subtitles:[]};for(let i=0;i<subtitles.events.length;i++){let subtitle=subtitles.events[i];if(!subtitle.segs)continue;let durationMs=subtitle.dDurationMs;subtitles.events[i+1]&&subtitle.tStartMs+subtitle.dDurationMs>subtitles.events[i+1].tStartMs&&(durationMs=subtitles.events[i+1].tStartMs-subtitle.tStartMs);let tokens=[],lastSegDuration=durationMs;for(let j=0;j<subtitle.segs.length;j++){let seg=subtitle.segs[j],text=seg.utf8.trim();if(text===`
`)continue;let offset=seg.tOffsetMs??0,segDuration=durationMs,nextSeg=subtitle.segs[j+1];nextSeg?.tOffsetMs&&(segDuration=nextSeg.tOffsetMs-offset,lastSegDuration-=segDuration),tokens.push({text,startMs:subtitle.tStartMs+offset,durationMs:nextSeg?segDuration:lastSegDuration})}let text=tokens.map(e=>e.text).join(` `);text&&result.subtitles.push({text,startMs:subtitle.tStartMs,durationMs,...isAsr?{tokens}:{}})}return result}static cleanJsonSubtitles(subtitles){let{containsTokens,subtitles:subtitlesList}=subtitles;return{containsTokens,subtitles:subtitlesList.map(item=>({...item,text:item.text.replace(/(<([^>]+)>)/gi,``)}))}}static async fetchSubtitles(subtitlesObject){let{source,isAutoGenerated,format}=subtitlesObject,{url}=subtitlesObject;if(source===`youtube`){let poToken=_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__.A.getPoToken();if(poToken){let deviceParams=_vot_js_ext_helpers_youtube__WEBPACK_IMPORTED_MODULE_0__.A.getDeviceParams();url+=`&potc=1&pot=${poToken}&${deviceParams}`}}try{let response=await(0,_utils_gm_ts__WEBPACK_IMPORTED_MODULE_5__.G3)(url,{timeout:7e3}),subtitles;if([`vtt`,`srt`].includes(format)){let text=await response.text();subtitles=(0,_vot_js_shared_utils_subs__WEBPACK_IMPORTED_MODULE_10__.vk)(text,`json`)}else subtitles=await response.json();return source===`youtube`?subtitles=SubtitlesProcessor.formatYoutubeSubtitles(subtitles,isAutoGenerated):source===`vk`&&(subtitles=SubtitlesProcessor.cleanJsonSubtitles(subtitles)),subtitles.subtitles=SubtitlesProcessor.processTokens(subtitles,subtitlesObject),console.log(`[VOT] Processed subtitles:`,subtitles),subtitles}catch(error){return console.error(`[VOT] Failed to process subtitles:`,error),{containsTokens:!1,subtitles:[]}}}static async getSubtitles(client,videoData){let{host,url,detectedLanguage:requestLang,videoId,duration,subtitles:extraSubtitles=[]}=videoData;try{let res=await Promise.race([client.getSubtitles({videoData:{host,url,videoId,duration},requestLang}),(0,_utils_utils_ts__WEBPACK_IMPORTED_MODULE_9__.wR)(5e3,`Timeout`)]);console.log(`[VOT] Subtitles response:`,res),res.waiting&&console.error(`[VOT] Failed to get Yandex subtitles`);let yandexSubs=(res.subtitles??[]).reduce((result,sub)=>(sub.language&&!result.find(e=>e.source===`yandex`&&e.language===sub.language&&!e.translatedFromLanguage)&&result.push({source:`yandex`,format:`json`,language:sub.language,url:sub.url}),sub.translatedLanguage&&result.push({source:`yandex`,format:`json`,language:sub.translatedLanguage,translatedFromLanguage:sub.language,url:sub.translatedUrl}),result),[]);return[...yandexSubs,...extraSubtitles].sort((a,b)=>{if(a.source!==b.source)return a.source===`yandex`?-1:1;if(a.language!==b.language&&(a.language===_utils_localization_ts__WEBPACK_IMPORTED_MODULE_6__.v||b.language===_utils_localization_ts__WEBPACK_IMPORTED_MODULE_6__.v))return a.language===_utils_localization_ts__WEBPACK_IMPORTED_MODULE_6__.v?-1:1;if(a.source===`yandex`){if(a.translatedFromLanguage!==b.translatedFromLanguage)return!a.translatedFromLanguage||!b.translatedFromLanguage?a.language===b.language?a.translatedFromLanguage?1:-1:a.translatedFromLanguage?-1:1:a.translatedFromLanguage===requestLang?-1:1;if(!a.translatedFromLanguage)return a.language===requestLang?-1:1}return a.source!==`yandex`&&a.isAutoGenerated!==b.isAutoGenerated?a.isAutoGenerated?1:-1:0})}catch(error){let message=error.message===`Timeout`?`Failed to get Yandex subtitles: timeout`:`Error in getSubtitles function`;throw console.error(`[VOT] ${message}`,error),error}}}class SubtitlesWidget{constructor(video,container,site,portal,tooltipLayoutRoot=void 0){this.video=video,this.container=container,this.site=site,this.tooltipLayoutRoot=tooltipLayoutRoot,this.portal=portal,this.subtitlesContainer=this.createSubtitlesContainer(),this.position={left:25,top:75},this.dragging={active:!1,offset:{x:0,y:0}},this.subtitles=null,this.subtitleLang=void 0,this.lastContent=null,this.highlightWords=!1,this.fontSize=20,this.opacity=.2,this.maxLength=300,this.abortController=new AbortController,this.bindEvents(),this.updateContainerRect()}createSubtitlesContainer(){return this.subtitlesContainer=document.createElement(`vot-block`),this.subtitlesContainer.classList.add(`vot-subtitles-widget`),this.container.appendChild(this.subtitlesContainer),this.subtitlesContainer}bindEvents(){let{signal}=this.abortController;this.onPointerDownBound=e=>this.onPointerDown(e),this.onPointerUpBound=()=>this.onPointerUp(),this.onPointerMoveBound=e=>this.onPointerMove(e),this.onTimeUpdateBound=()=>this.update(),document.addEventListener(`pointerdown`,this.onPointerDownBound,{signal}),document.addEventListener(`pointerup`,this.onPointerUpBound,{signal}),document.addEventListener(`pointermove`,this.onPointerMoveBound,{signal}),this.video?.addEventListener(`timeupdate`,this.onTimeUpdateBound,{signal}),this.resizeObserver=new ResizeObserver(()=>this.onResize()),this.resizeObserver.observe(this.container)}onPointerDown(e){if(!this.subtitlesContainer.contains(e.target))return;let rect=this.subtitlesContainer.getBoundingClientRect(),containerRect=this.container.getBoundingClientRect();this.dragging={active:!0,offset:{x:e.clientX-rect.left,y:e.clientY-rect.top},containerOffset:{x:containerRect.left,y:containerRect.top}}}onPointerUp(){this.dragging.active=!1}onPointerMove(e){if(!this.dragging.active)return;e.preventDefault();let{width,height}=this.container.getBoundingClientRect(),{containerOffset,offset}=this.dragging;this.position={left:(e.clientX-offset.x-containerOffset.x)/width*100,top:(e.clientY-offset.y-containerOffset.y)/height*100},this.applySubtitlePosition()}onResize(){this.updateContainerRect()}updateContainerRect(){this.containerRect=this.container.getBoundingClientRect(),this.applySubtitlePosition()}applySubtitlePosition(){let{width,height}=this.containerRect,{offsetWidth,offsetHeight}=this.subtitlesContainer,maxLeft=(width-offsetWidth)/width*100,maxTop=(height-offsetHeight)/height*100;this.position.left=Math.max(0,Math.min(this.position.left,maxLeft)),this.position.top=Math.max(0,Math.min(this.position.top,maxTop)),this.subtitlesContainer.style.left=`${this.position.left}%`,this.subtitlesContainer.style.top=`${this.position.top}%`,this.tokenTooltip?.updatePos()}processTokens(tokens){if(tokens.at(-1).alignRange.end<=this.maxLength)return tokens;let chunks=[],chunkTokens=[],length=0;for(let token of tokens)length+=token.text.length,chunkTokens.push(token),length>this.maxLength&&(chunks.push(this.trimChunk(chunkTokens)),chunkTokens=[],length=0);chunkTokens.length&&chunks.push(this.trimChunk(chunkTokens));let time=this.video.currentTime*1e3;return chunks.find(chunk=>chunk[0].startMs<time&&time<chunk.at(-1).startMs+chunk.at(-1).durationMs)||chunks[0]}trimChunk(tokens){return tokens[0]?.text===` `&&tokens.shift(),tokens.at(-1)?.text===` `&&tokens.pop(),tokens}async translateStrTokens(text){let fromLang=this.subtitleLang,toLang=_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__.j.lang;if(this.strTranslatedTokens){let translated=await(0,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_8__.Tl)(text,fromLang,toLang);return[this.strTranslatedTokens,translated]}let translated=await(0,_utils_translateApis_ts__WEBPACK_IMPORTED_MODULE_8__.Tl)([this.strTokens,text],fromLang,toLang);return this.strTranslatedTokens=translated[0],translated}releaseTooltip(){return this.tokenTooltip&&(this.tokenTooltip.target.classList.remove(`selected`),this.tokenTooltip.release(),this.tokenTooltip=void 0),this}onClick=async e=>{if(this.tokenTooltip?.target===e.target&&this.tokenTooltip?.container){this.tokenTooltip.showed?e.target.classList.add(`selected`):e.target.classList.remove(`selected`);return}this.releaseTooltip(),e.target.classList.add(`selected`);let text=e.target.textContent.trim().replace(/[.|,]/,``),service=await _utils_storage_ts__WEBPACK_IMPORTED_MODULE_7__.d.get(`translationService`,_config_config_js__WEBPACK_IMPORTED_MODULE_11__.mE),subtitlesInfo=_ui_js__WEBPACK_IMPORTED_MODULE_3__.A.createSubtitleInfo(text,this.strTranslatedTokens||this.strTokens,service);this.tokenTooltip=new _ui_components_tooltip_ts__WEBPACK_IMPORTED_MODULE_4__.A({target:e.target,anchor:this.subtitlesBlock,layoutRoot:this.tooltipLayoutRoot,content:subtitlesInfo.container,parentElement:this.portal,maxWidth:this.subtitlesContainer.offsetWidth,borderRadius:12,bordered:!1,position:`top`,trigger:`click`}),this.tokenTooltip.create();let strTokens=this.strTokens,translated=await this.translateStrTokens(text);strTokens!==this.strTokens||!this.tokenTooltip?.showed||(subtitlesInfo.header.textContent=translated[1],subtitlesInfo.context.textContent=translated[0],this.tokenTooltip.setContent(subtitlesInfo.container),this.tokenTooltip.create())};renderTokens(tokens,time){return tokens.map(token=>{let passed=this.highlightWords&&(time>token.startMs+token.durationMs/2||time>token.startMs-100&&token.startMs+token.durationMs/2-time<275);return(0,lit_html__WEBPACK_IMPORTED_MODULE_1__.qy)`<span
        @click="${this.onClick}"
        class="${passed?`passed`:``}"
      >
        ${token.text.replace(`\\n`,`<br>`)}
      </span>`})}setContent(subtitles,lang=void 0){if(this.releaseTooltip(),this.subtitleLang=lang,!subtitles||!this.video){this.subtitles=null,(0,lit_html__WEBPACK_IMPORTED_MODULE_1__.XX)(null,this.subtitlesContainer);return}this.subtitles=subtitles,this.update()}setMaxLength(len){typeof len==`number`&&len>0&&(this.maxLength=len,this.update())}setHighlightWords(value){this.highlightWords=!!value,this.update()}setFontSize(size){this.fontSize=size,this.subtitlesBlock&&(this.subtitlesBlock.style.fontSize=`${size}px`)}setOpacity(rate){this.opacity=((100-rate)/100).toFixed(2),this.subtitlesBlock&&this.subtitlesBlock.style.setProperty(`--vot-subtitles-opacity`,this.opacity)}stringifyTokens(tokens){return tokens.map(token=>token.text).join(``)}update(){if(!this.video||!this.subtitles)return;let time=this.video.currentTime*1e3,line=this.subtitles.subtitles.findLast(e=>e.startMs<time&&time<e.startMs+e.durationMs);if(!line){(0,lit_html__WEBPACK_IMPORTED_MODULE_1__.XX)(null,this.subtitlesContainer),this.subtitlesBlock=null,this.releaseTooltip();return}let tokens=this.processTokens(line.tokens),content=this.renderTokens(tokens,time),stringContent=JSON.stringify(content);if(stringContent!==this.lastContent){this.lastContent=stringContent;let strTokens=this.stringifyTokens(tokens);strTokens!==this.strTokens&&(this.releaseTooltip(),this.strTokens=strTokens,this.strTranslatedTokens=``),(0,lit_html__WEBPACK_IMPORTED_MODULE_1__.XX)((0,lit_html__WEBPACK_IMPORTED_MODULE_1__.qy)`<vot-block
          class="vot-subtitles"
          style="font-size: ${this.fontSize}px; --vot-subtitles-opacity: ${this.opacity}"
          >${content}</vot-block
        >`,this.subtitlesContainer),this.subtitlesBlock=this.subtitlesContainer.querySelector(`.vot-subtitles`)}}release(){this.abortController.abort(),this.resizeObserver.disconnect(),this.releaseTooltip(),this.subtitlesContainer.remove()}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/types/components/tooltip.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{G:()=>triggers,X:()=>positions});let positions=[`left`,`top`,`right`,`bottom`],triggers=[`hover`,`click`]},"./src/types/components/votButton.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>positions});let positions=[`default`,`top`,`left`,`right`],directions=null},"./src/types/storage.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>storageKeys});let storageKeys=`autoTranslate.dontTranslateLanguages.enabledDontTranslateLanguages.enabledAutoVolume.autoVolume.buttonPos.showVideoSlider.syncVolume.downloadWithName.sendNotifyOnComplete.subtitlesMaxLength.highlightWords.subtitlesFontSize.subtitlesOpacity.subtitlesDownloadFormat.responseLanguage.defaultVolume.onlyBypassMediaCSP.newAudioPlayer.showPiPButton.translateAPIErrors.translationService.detectService.translationHotkey.m3u8ProxyHost.proxyWorkerHost.translateProxyEnabled.translateProxyEnabledDefault.audioBooster.useLivelyVoice.autoHideButtonDelay.useAudioDownload.compatVersion.localePhrases.localeLang.localeHash.localeUpdatedAt.localeLangOverride.account`.split(`.`)},"./src/ui.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>UI});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_styles_main_scss__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/styles/main.scss`),_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/localization/localizationProvider.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__]);_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class UI{static createEl(tag,classes=[],content=null){let el=document.createElement(tag);return classes.length&&el.classList.add(...classes),content!==null&&el.append(content),el}static createHeader(html,level=4){let header=UI.createEl(`vot-block`,[`vot-header`,`vot-header-level-${level}`]);return header.append(html),header}static createInformation(labelHtml,valueHtml){let container=UI.createEl(`vot-block`,[`vot-info`]),header=UI.createEl(`vot-block`);(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(labelHtml,header);let value=UI.createEl(`vot-block`);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(valueHtml,value),container.append(header,value),{container,header,value}}static createButton(html){let button=UI.createEl(`vot-block`,[`vot-button`]);return button.append(html),button}static createTextButton(html){let button=UI.createEl(`vot-block`,[`vot-text-button`]);return button.append(html),button}static createOutlinedButton(html){let button=UI.createEl(`vot-block`,[`vot-outlined-button`]);return button.append(html),button}static createIconButton(templateHtml){let button=UI.createEl(`vot-block`,[`vot-icon-button`]);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(templateHtml,button),button}static createInlineLoader(){return UI.createEl(`vot-block`,[`vot-inline-loader`])}static createPortal(local=!1){return UI.createEl(`vot-block`,[`vot-portal${local?`-local`:``}`])}static createSubtitleInfo(word,desc,translationService){let container=UI.createEl(`vot-block`,[`vot-subtitles-info`]);container.id=`vot-subtitles-info`;let translatedWith=UI.createEl(`vot-block`,[`vot-subtitles-info-service`],_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_2__.j.get(`VOTTranslatedBy`).replace(`{0}`,translationService)),header=UI.createEl(`vot-block`,[`vot-subtitles-info-header`],word),context=UI.createEl(`vot-block`,[`vot-subtitles-info-context`],desc);return container.append(translatedWith,header,context),{container,translatedWith,header,context}}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/accountButton.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>AccountButton});var _config_config__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/config/config.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/core/eventImpl.ts`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/localization/localizationProvider.ts`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui/icons.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__,_ui__WEBPACK_IMPORTED_MODULE_1__]);[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__,_ui__WEBPACK_IMPORTED_MODULE_1__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class AccountButton{container;accountWrapper;buttons;usernameEl;avatarEl;avatarImg;actionButton;refreshButton;tokenButton;onClick=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;onRefresh=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;onClickSecret=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;_loggedIn;_username;_avatarId;constructor({loggedIn=!1,username=`unnamed`,avatarId=`0/0-0`}={}){this._loggedIn=loggedIn,this._username=username,this._avatarId=avatarId;let elements=this.createElements();this.container=elements.container,this.accountWrapper=elements.accountWrapper,this.buttons=elements.buttons,this.usernameEl=elements.usernameEl,this.avatarEl=elements.avatarEl,this.avatarImg=elements.avatarImg,this.actionButton=elements.actionButton,this.refreshButton=elements.refreshButton,this.tokenButton=elements.tokenButton}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-account`]),accountWrapper=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-account-wrapper`]);accountWrapper.hidden=!this._loggedIn;let avatarImg=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`img`,[`vot-account-avatar-img`]);avatarImg.src=`${_config_config__WEBPACK_IMPORTED_MODULE_4__.cL}/${this._avatarId}/islands-retina-middle`,avatarImg.loading=`lazy`,avatarImg.alt=`user avatar`;let avatarEl=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-account-avatar`],avatarImg),usernameEl=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-account-username`]);usernameEl.textContent=this._username,accountWrapper.append(avatarEl,usernameEl);let buttons=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-account-buttons`]),actionButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createOutlinedButton(this.buttonText);actionButton.addEventListener(`click`,()=>{this.onClick.dispatch()});let tokenButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createIconButton(_icons__WEBPACK_IMPORTED_MODULE_2__.GA);tokenButton.hidden=this._loggedIn,tokenButton.addEventListener(`click`,()=>{this.onClickSecret.dispatch()});let refreshButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createIconButton(_icons__WEBPACK_IMPORTED_MODULE_2__.M9);return refreshButton.addEventListener(`click`,()=>{this.onRefresh.dispatch()}),buttons.append(actionButton,tokenButton,refreshButton),container.append(accountWrapper,buttons),{container,accountWrapper,buttons,usernameEl,avatarImg,avatarEl,actionButton,refreshButton,tokenButton}}addEventListener(type,listener){switch(type){case`click`:this.onClick.addListener(listener);break;case`click:secret`:this.onClickSecret.addListener(listener);break;case`refresh`:this.onRefresh.addListener(listener);break}return this}removeEventListener(type,listener){switch(type){case`click`:this.onClick.removeListener(listener);break;case`click:secret`:this.onClickSecret.removeListener(listener);break;case`refresh`:this.onRefresh.removeListener(listener);break}return this}get buttonText(){return this._loggedIn?_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`VOTLogout`):_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`VOTLogin`)}get loggedIn(){return this._loggedIn}set loggedIn(isLoggedIn){this._loggedIn=isLoggedIn,this.accountWrapper.hidden=!this._loggedIn,this.actionButton.textContent=this.buttonText,this.tokenButton.hidden=this._loggedIn}get avatarId(){return this._avatarId}set avatarId(avatarId){this._avatarId=avatarId??`0/0-0`,this.avatarImg.src=`${_config_config__WEBPACK_IMPORTED_MODULE_4__.cL}/${this._avatarId}/islands-retina-middle`}get username(){return this._username}set username(username){this._username=username??`unnamed`,this.usernameEl.textContent=this._username}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/checkbox.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Checkbox});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/core/eventImpl.ts`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_1__]);_ui__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class Checkbox{container;input;label;onChange=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__.Z;_labelHtml;_checked;_isSubCheckbox;constructor({labelHtml,checked=!1,isSubCheckbox=!1}){this._labelHtml=labelHtml,this._checked=checked,this._isSubCheckbox=isSubCheckbox;let elements=this.createElements();this.container=elements.container,this.input=elements.input,this.label=elements.label}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`label`,[`vot-checkbox`]);this._isSubCheckbox&&container.classList.add(`vot-checkbox-sub`);let input=document.createElement(`input`);input.type=`checkbox`,input.checked=this._checked,input.addEventListener(`change`,()=>{this._checked=input.checked,this.onChange.dispatch(this._checked)});let label=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`span`);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(this._labelHtml,label),container.append(input,label),{container,input,label}}addEventListener(type,listener){return this.onChange.addListener(listener),this}removeEventListener(type,listener){return this.onChange.removeListener(listener),this}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}get disabled(){return this.input.disabled}set disabled(isDisabled){this.input.disabled=isDisabled}get checked(){return this._checked}set checked(isChecked){this._checked!==isChecked&&(this._checked=this.input.checked=isChecked,this.onChange.dispatch(this._checked))}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/details.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Details});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/core/eventImpl.ts`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui/icons.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_1__]);_ui__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class Details{container;header;arrowIcon;onClick=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_3__.Z;_titleHtml;constructor({titleHtml}){this._titleHtml=titleHtml;let elements=this.createElements();this.container=elements.container,this.header=elements.header,this.arrowIcon=elements.arrowIcon}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-details`]),header=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`);header.append(this._titleHtml);let arrowIcon=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-details-arrow-icon`]);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(_icons__WEBPACK_IMPORTED_MODULE_2__.mQ,arrowIcon),container.append(header,arrowIcon),container.addEventListener(`click`,()=>{this.onClick.dispatch()}),{container,header,arrowIcon}}addEventListener(type,listener){return this.onClick.addListener(listener),this}removeEventListener(type,listener){return this.onClick.removeListener(listener),this}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/dialog.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Dialog});var _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/core/eventImpl.ts`),_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui/icons.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__]);_ui__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class Dialog{container;backdrop;box;contentWrapper;headerContainer;titleContainer;title;closeButton;bodyContainer;footerContainer;onClose=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__.Z;_titleHtml;_isTemp;constructor({titleHtml,isTemp=!1}){this._titleHtml=titleHtml,this._isTemp=isTemp;let elements=this.createElements();this.container=elements.container,this.backdrop=elements.backdrop,this.box=elements.box,this.contentWrapper=elements.contentWrapper,this.headerContainer=elements.headerContainer,this.titleContainer=elements.titleContainer,this.title=elements.title,this.closeButton=elements.closeButton,this.bodyContainer=elements.bodyContainer,this.footerContainer=elements.footerContainer}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-container`]);this._isTemp&&container.classList.add(`vot-dialog-temp`),container.hidden=!this._isTemp;let backdrop=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-backdrop`]),box=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog`]),contentWrapper=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-content-wrapper`]),headerContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-header-container`]),titleContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-title-container`]),title=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-title`]);title.append(this._titleHtml),titleContainer.appendChild(title);let closeButton=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createIconButton(_icons__WEBPACK_IMPORTED_MODULE_1__.jr);closeButton.classList.add(`vot-dialog-close-button`),backdrop.addEventListener(`click`,()=>{this.close()}),closeButton.addEventListener(`click`,()=>{this.close()}),headerContainer.append(titleContainer,closeButton);let bodyContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-body-container`]),footerContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-dialog-footer-container`]);return contentWrapper.append(headerContainer,bodyContainer,footerContainer),box.appendChild(contentWrapper),container.append(backdrop,box),{container,backdrop,box,contentWrapper,headerContainer,titleContainer,title,closeButton,bodyContainer,footerContainer}}addEventListener(type,listener){return this.onClose.addListener(listener),this}removeEventListener(type,listener){return this.onClose.removeListener(listener),this}open(){return this.hidden=!1,this}remove(){return this.container.remove(),this.onClose.dispatch(),this}close(){return this._isTemp?this.remove():(this.hidden=!0,this.onClose.dispatch(),this)}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}get isDialogOpen(){return!this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/downloadButton.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>DownloadButton});var _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/core/eventImpl.ts`),_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui/icons.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__]);_ui__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class DownloadButton{button;loaderMain;loaderText;onClick=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__.Z;_progress=0;constructor(){let elements=this.createElements();this.button=elements.button,this.loaderMain=elements.loaderMain,this.loaderText=elements.loaderText}createElements(){let button=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createIconButton(_icons__WEBPACK_IMPORTED_MODULE_1__.nO),loaderMain=button.querySelector(`.vot-loader-main`),loaderText=button.querySelector(`.vot-loader-text`);return button.addEventListener(`click`,()=>{this.onClick.dispatch()}),{button,loaderMain,loaderText}}addEventListener(type,listener){return this.onClick.addListener(listener),this}removeEventListener(type,listener){return this.onClick.removeListener(listener),this}get progress(){return this._progress}set progress(value){this._progress=value,this.loaderText.textContent=value===0?``:value.toString(),!(value>1)&&(this.loaderMain.style.opacity=value===0?`1`:`0`)}set hidden(isHidden){this.button.hidden=isHidden}get hidden(){return this.button.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/hotkeyButton.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>HotkeyButton,_:()=>formatKeysCombo});var _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/core/eventImpl.ts`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/localization/localizationProvider.ts`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__,_ui__WEBPACK_IMPORTED_MODULE_1__]);[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__,_ui__WEBPACK_IMPORTED_MODULE_1__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class HotkeyButton{container;button;onChange=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__.Z;_labelHtml;_key;pressedKeys;recording=!1;constructor({labelHtml,key=null}){this._labelHtml=labelHtml,this._key=key,this.pressedKeys=new Set;let elements=this.createElements();this.container=elements.container,this.button=elements.button}stopRecordingKeys(){this.recording=!1,document.removeEventListener(`keydown`,this.keydownHandle),document.removeEventListener(`keyup`,this.keyupOrBlurHandle),document.removeEventListener(`blur`,this.keyupOrBlurHandle),this.button.removeAttribute(`data-status`),this.pressedKeys.clear()}keydownHandle=event=>{if(!(!this.recording||event.repeat)){if(event.preventDefault(),event.code===`Escape`){this.key=null,this.button.textContent=this.keyText,this.stopRecordingKeys();return}this.pressedKeys.add(event.code),this.button.textContent=formatKeysCombo(this.pressedKeys)}};keyupOrBlurHandle=()=>{this.recording&&(this.key=formatKeysCombo(this.pressedKeys),this.stopRecordingKeys())};createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-hotkey`]),label=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-hotkey-label`]);label.textContent=this._labelHtml;let button=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-hotkey-button`]);return button.textContent=this.keyText,button.addEventListener(`click`,()=>{button.dataset.status=`active`,this.recording=!0,this.pressedKeys.clear(),this.button.textContent=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`PressTheKeyCombination`),document.addEventListener(`keydown`,this.keydownHandle),document.addEventListener(`keyup`,this.keyupOrBlurHandle),document.addEventListener(`blur`,this.keyupOrBlurHandle)}),container.append(label,button),{container,button,label}}addEventListener(type,listener){return this.onChange.addListener(listener),this}removeEventListener(type,listener){return this.onChange.removeListener(listener),this}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}get key(){return this._key}get keyText(){return this._key?this._key?.replace(`Key`,``).replace(`Digit`,``):_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`None`)}set key(newKey){this._key!==newKey&&(this._key=newKey,this.button.textContent=this.keyText,this.onChange.dispatch(this._key))}}function formatKeysCombo(keys){let keysArray=Array.isArray(keys)?keys:Array.from(keys);return keysArray.map(code=>code.replace(`Key`,``).replace(`Digit`,``)).join(`+`)}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/label.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Label});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_1__]);_ui__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class Label{container;icon;_labelText;_icon;constructor({labelText,icon}){this._labelText=labelText,this._icon=icon;let elements=this.createElements();this.container=elements.container,this.icon=elements.icon}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-label`]);container.textContent=this._labelText;let icon=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-label-icon`]);return this._icon&&(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(this._icon,icon),container.appendChild(icon),{container,icon}}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/languagePairSelect.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>LanguagePairSelect});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/localization/localizationProvider.ts`),_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/ui/icons.ts`),_select__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/ui/components/select.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__,_ui__WEBPACK_IMPORTED_MODULE_2__,_select__WEBPACK_IMPORTED_MODULE_4__]);[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__,_ui__WEBPACK_IMPORTED_MODULE_2__,_select__WEBPACK_IMPORTED_MODULE_4__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class LanguagePairSelect{container;fromSelect;directionIcon;toSelect;dialogParent;_fromSelectTitle;_fromDialogTitle;_fromItems;_toSelectTitle;_toDialogTitle;_toItems;constructor({from:{selectTitle:fromSelectTitle=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`videoLanguage`),dialogTitle:fromDialogTitle=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`videoLanguage`),items:fromItems},to:{selectTitle:toSelectTitle=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`translationLanguage`),dialogTitle:toDialogTitle=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`translationLanguage`),items:toItems},dialogParent=document.documentElement}){this._fromSelectTitle=fromSelectTitle,this._fromDialogTitle=fromDialogTitle,this._fromItems=fromItems,this._toSelectTitle=toSelectTitle,this._toDialogTitle=toDialogTitle,this._toItems=toItems,this.dialogParent=dialogParent;let elements=this.createElements();this.container=elements.container,this.fromSelect=elements.fromSelect,this.directionIcon=elements.directionIcon,this.toSelect=elements.toSelect}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-lang-select`]),fromSelect=new _select__WEBPACK_IMPORTED_MODULE_4__.A({selectTitle:this._fromSelectTitle,dialogTitle:this._fromDialogTitle,items:this._fromItems,dialogParent:this.dialogParent}),directionIcon=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-lang-select-icon`]);(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(_icons__WEBPACK_IMPORTED_MODULE_3__.z3,directionIcon);let toSelect=new _select__WEBPACK_IMPORTED_MODULE_4__.A({selectTitle:this._toSelectTitle,dialogTitle:this._toDialogTitle,items:this._toItems,dialogParent:this.dialogParent});return container.append(fromSelect.container,directionIcon,toSelect.container),{container,fromSelect,directionIcon,toSelect}}setSelectedValues(from,to){return this.fromSelect.setSelectedValue(from),this.toSelect.setSelectedValue(to),this}updateItems(fromItems,toItems){return this._fromItems=fromItems,this._toItems=toItems,this.fromSelect=this.fromSelect.updateItems(fromItems),this.toSelect=this.toSelect.updateItems(toItems),this}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/select.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Select});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/core/eventImpl.ts`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/localization/localizationProvider.ts`),_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/ui/icons.ts`),_dialog__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/ui/components/dialog.ts`),_textfield__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/ui/components/textfield.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__,_ui__WEBPACK_IMPORTED_MODULE_2__,_dialog__WEBPACK_IMPORTED_MODULE_4__,_textfield__WEBPACK_IMPORTED_MODULE_5__]);[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__,_ui__WEBPACK_IMPORTED_MODULE_2__,_dialog__WEBPACK_IMPORTED_MODULE_4__,_textfield__WEBPACK_IMPORTED_MODULE_5__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class Select{container;outer;arrowIcon;title;dialogParent;labelElement;_selectTitle;_dialogTitle;multiSelect;_items;isLoading=!1;isDialogOpen=!1;onSelectItem=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_6__.Z;onBeforeOpen=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_6__.Z;contentList;selectedItems=[];selectedValues;constructor({selectTitle,dialogTitle,items,labelElement,dialogParent=document.documentElement,multiSelect}){this._selectTitle=selectTitle,this._dialogTitle=dialogTitle,this._items=items,this.multiSelect=multiSelect??!1,this.labelElement=labelElement,this.dialogParent=dialogParent,this.selectedValues=this.calcSelectedValues();let elements=this.createElements();this.container=elements.container,this.outer=elements.outer,this.arrowIcon=elements.arrowIcon,this.title=elements.title}static genLanguageItems(langs,conditionString){return langs.map(lang=>{let phrase=`langs.${lang}`,label=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(phrase);return{label:label===phrase?lang.toUpperCase():label,value:lang,selected:conditionString===lang}})}multiSelectItemHandle=(contentItem,item)=>{let value=item.value;this.selectedValues.has(value)&&this.selectedValues.size>1?(this.selectedValues.delete(value),item.selected=!1):(this.selectedValues.add(value),item.selected=!0),contentItem.dataset.votSelected=this.selectedValues.has(value).toString(),this.updateSelectedState(),this.onSelectItem.dispatch(Array.from(this.selectedValues))};singleSelectItemHandle=item=>{let value=item.value;this.selectedValues=new Set([value]);for(let contentItem of this.selectedItems)contentItem.dataset.votSelected=(contentItem.dataset.votValue===value).toString();for(let item of this._items)item.selected=item.value===value;this.updateTitle(),this.onSelectItem.dispatch(value)};createDialogContentList(){let contentList=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-select-content-list`]);for(let item of this._items){let contentItem=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-select-content-item`]);contentItem.textContent=item.label,contentItem.dataset.votSelected=item.selected===!0?`true`:`false`,contentItem.dataset.votValue=item.value,item.disabled&&(contentItem.inert=!0),contentItem.addEventListener(`click`,e=>{if(!e.target.inert)return this.multiSelect?this.multiSelectItemHandle(contentItem,item):this.singleSelectItemHandle(item)}),contentList.appendChild(contentItem)}return this.selectedItems=Object.values(contentList.childNodes),contentList}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-select`]);this.labelElement&&container.append(this.labelElement);let outer=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-select-outer`]),title=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-select-title`]);title.textContent=this.visibleText;let arrowIcon=_ui__WEBPACK_IMPORTED_MODULE_2__.A.createEl(`vot-block`,[`vot-select-arrow-icon`]);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(_icons__WEBPACK_IMPORTED_MODULE_3__.mQ,arrowIcon),outer.append(title,arrowIcon),outer.addEventListener(`click`,()=>{if(!(this.isLoading||this.isDialogOpen))try{this.isLoading=!0;let tempDialog=new _dialog__WEBPACK_IMPORTED_MODULE_4__.A({titleHtml:this._dialogTitle,isTemp:!0});this.onBeforeOpen.dispatch(tempDialog),this.dialogParent.appendChild(tempDialog.container);let votSearchLangTextfield=new _textfield__WEBPACK_IMPORTED_MODULE_5__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`searchField`)});votSearchLangTextfield.addEventListener(`input`,searchText=>{for(let contentItem of this.selectedItems)contentItem.hidden=!contentItem.textContent?.toLowerCase().includes(searchText)}),this.contentList=this.createDialogContentList(),tempDialog.bodyContainer.append(votSearchLangTextfield.container,this.contentList),tempDialog.addEventListener(`close`,()=>{this.isDialogOpen=!1,this.selectedItems=[]})}finally{this.isLoading=!1}}),container.appendChild(outer),{container,outer,arrowIcon,title}}calcSelectedValues(){return new Set(this._items.filter(item=>item.selected).map(item=>item.value))}addEventListener(type,listener){return type===`selectItem`?this.onSelectItem.addListener(listener):type===`beforeOpen`&&this.onBeforeOpen.addListener(listener),this}removeEventListener(type,listener){return type===`selectItem`?this.onSelectItem.removeListener(listener):type===`beforeOpen`&&this.onBeforeOpen.removeListener(listener),this}updateTitle(){return this.title.textContent=this.visibleText,this}updateSelectedState(){if(this.selectedItems.length>0)for(let item of this.selectedItems){let val=item.dataset.votValue;if(!val)continue;item.dataset.votSelected=this.selectedValues.has(val).toString()}return this.updateTitle(),this}setSelectedValue(value){this.multiSelect?this.selectedValues=new Set(Array.isArray(value)?value.map(String):[String(value)]):this.selectedValues=new Set([String(value)]);for(let item of this._items)item.selected=this.selectedValues.has(String(item.value));return this.updateSelectedState(),this}updateItems(newItems){this._items=newItems,this.selectedValues=this.calcSelectedValues(),this.updateSelectedState();let dialogContainer=this.contentList?.parentElement;if(!this.contentList||!dialogContainer)return this;let oldContentList=this.contentList;return this.contentList=this.createDialogContentList(),dialogContainer.replaceChild(this.contentList,oldContentList),this}get visibleText(){return this.multiSelect?this._items.filter(item=>this.selectedValues.has(item.value)).map(item=>item.label).join(`, `)??this._selectTitle:this._items.find(item=>item.selected)?.label??this._selectTitle}set selectTitle(title){this._selectTitle=title,this.updateTitle()}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/slider.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Slider});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/core/eventImpl.ts`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_1__]);_ui__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class Slider{container;input;label;onInput=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_2__.Z;_labelHtml;_value;_min;_max;_step;constructor({labelHtml,value=50,min=0,max=100,step=1}){this._labelHtml=labelHtml,this._value=value,this._min=min,this._max=max,this._step=step;let elements=this.createElements();this.container=elements.container,this.input=elements.input,this.label=elements.label,this.update()}updateProgress(){let progress=(this._value-this._min)/(this._max-this._min);return this.container.style.setProperty(`--vot-progress`,progress.toString()),this}update(){return this._value=this.input.valueAsNumber,this._min=+this.input.min,this._max=+this.input.max,this.updateProgress(),this}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-slider`]),input=document.createElement(`input`);input.type=`range`,input.min=this._min.toString(),input.max=this._max.toString(),input.step=this._step.toString(),input.value=this._value.toString();let label=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`span`);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(this._labelHtml,label),container.append(input,label),input.addEventListener(`input`,()=>{this.update(),this.onInput.dispatch(this._value,!1)}),{container,label,input}}addEventListener(type,listener){return this.onInput.addListener(listener),this}removeEventListener(type,listener){return this.onInput.removeListener(listener),this}get value(){return this._value}set value(val){this._value=val,this.input.value=val.toString(),this.updateProgress(),this.onInput.dispatch(this._value,!0)}get min(){return this._min}set min(val){this._min=val,this.input.min=this._min.toString(),this.updateProgress()}get max(){return this._max}set max(val){this._max=val,this.input.max=this._max.toString(),this.updateProgress()}get step(){return this._step}set step(val){this._step=val,this.input.step=this._step.toString()}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/sliderLabel.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>SliderLabel});var _ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__]);_ui__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class SliderLabel{container;strong;_labelText;_labelEOL;_value;_symbol;constructor({labelText,labelEOL=``,value=50,symbol=`%`}){this._labelText=labelText,this._labelEOL=labelEOL,this._value=value,this._symbol=symbol;let elements=this.createElements();this.container=elements.container,this.strong=elements.strong}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-slider-label`]);container.textContent=this.labelText;let strong=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`strong`,[`vot-slider-label-value`]);return strong.textContent=this.valueText,container.append(strong),{container,strong}}get labelText(){return`${this._labelText}${this._labelEOL}`}get valueText(){return`${this._value}${this._symbol}`}get value(){return this._value}set value(val){this._value=val,this.strong.textContent=this.valueText}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/textfield.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Textfield});var _core_eventImpl__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/core/eventImpl.ts`),_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__]);_ui__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class Textfield{container;input;label;onInput=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_1__.Z;onChange=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_1__.Z;_labelHtml;_multiline;_placeholder;_value;constructor({labelHtml=``,placeholder=``,value=``,multiline=!1}){this._labelHtml=labelHtml,this._multiline=multiline,this._placeholder=placeholder,this._value=value;let elements=this.createElements();this.container=elements.container,this.input=elements.input,this.label=elements.label}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-textfield`]),input=document.createElement(this._multiline?`textarea`:`input`);this._labelHtml||input.classList.add(`vot-show-placeholer`),input.placeholder=this._placeholder,input.value=this._value;let label=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`span`);return label.append(this._labelHtml),container.append(input,label),input.addEventListener(`input`,()=>{this._value=this.input.value,this.onInput.dispatch(this._value)}),input.addEventListener(`change`,()=>{this._value=this.input.value,this.onChange.dispatch(this._value)}),{container,label,input}}addEventListener(type,listener){return type===`change`?this.onChange.addListener(listener):type===`input`&&this.onInput.addListener(listener),this}removeEventListener(type,listener){return type===`change`?this.onChange.removeListener(listener):type===`input`&&this.onInput.removeListener(listener),this}get value(){return this._value}set value(val){this._value!==val&&(this.input.value=this._value=val,this.onChange.dispatch(this._value))}get placeholder(){return this._placeholder}set placeholder(text){this.input.placeholder=this._placeholder=text}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/tooltip.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>Tooltip});var _types_components_tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/types/components/tooltip.ts`),_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),_utils_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__,_utils_utils__WEBPACK_IMPORTED_MODULE_1__]);[_ui__WEBPACK_IMPORTED_MODULE_0__,_utils_utils__WEBPACK_IMPORTED_MODULE_1__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class Tooltip{showed=!1;target;anchor;content;position;trigger;parentElement;layoutRoot;offsetX;offsetY;hidden;autoLayout;pageWidth;pageHeight;globalOffsetX;globalOffsetY;maxWidth;backgroundColor;borderRadius;_bordered;container;onResizeObserver;intersectionObserver;constructor({target,anchor=void 0,content=``,position=`top`,trigger=`hover`,offset=4,maxWidth=void 0,hidden=!1,autoLayout=!0,backgroundColor=void 0,borderRadius=void 0,bordered=!0,parentElement=document.body,layoutRoot=document.documentElement}){if(!(target instanceof HTMLElement))throw Error(`target must be a valid HTMLElement`);this.target=target,this.anchor=anchor instanceof HTMLElement?anchor:target,this.content=content,typeof offset==`number`?this.offsetY=this.offsetX=offset:(this.offsetX=offset.x,this.offsetY=offset.y),this.hidden=hidden,this.autoLayout=autoLayout,this.trigger=Tooltip.validateTrigger(trigger)?trigger:`hover`,this.position=Tooltip.validatePos(position)?position:`top`,this.parentElement=parentElement,this.layoutRoot=layoutRoot,this.borderRadius=borderRadius,this._bordered=bordered,this.maxWidth=maxWidth,this.backgroundColor=backgroundColor,this.updatePageSize(),this.init()}static validatePos(position){return _types_components_tooltip__WEBPACK_IMPORTED_MODULE_2__.X.includes(position)}static validateTrigger(trigger){return _types_components_tooltip__WEBPACK_IMPORTED_MODULE_2__.G.includes(trigger)}setPosition(position){return this.position=Tooltip.validatePos(position)?position:`top`,this.updatePos(),this}setContent(content){return this.content=content,this.destroy(),this}onResize=()=>{this.updatePageSize(),this.updatePos()};onClick=()=>{this.showed?this.destroy():this.create()};onScroll=()=>{requestAnimationFrame(()=>{this.updatePageSize(),this.updatePos()})};onHoverPointerDown=e=>{e.pointerType!==`mouse`&&this.create()};onHoverPointerUp=e=>{e.pointerType!==`mouse`&&this.destroy()};onMouseEnter=()=>{this.create()};onMouseLeave=()=>{this.destroy()};updatePageSize(){if(this.layoutRoot!==document.documentElement){let{left,top}=this.parentElement.getBoundingClientRect();this.globalOffsetX=left,this.globalOffsetY=top}else this.globalOffsetX=0,this.globalOffsetY=0;return this.pageWidth=(this.layoutRoot.clientWidth||document.documentElement.clientWidth)+window.pageXOffset,this.pageHeight=(this.layoutRoot.clientHeight||document.documentElement.clientHeight)+window.pageYOffset,this}onIntersect=([entry])=>{if(!entry.isIntersecting)return this.destroy(!0)};init(){return this.onResizeObserver=new ResizeObserver(this.onResize),this.intersectionObserver=new IntersectionObserver(this.onIntersect),document.addEventListener(`scroll`,this.onScroll,{passive:!0,capture:!0}),this.trigger===`click`?(this.target.addEventListener(`pointerdown`,this.onClick),this):(this.target.addEventListener(`mouseenter`,this.onMouseEnter),this.target.addEventListener(`mouseleave`,this.onMouseLeave),this.target.addEventListener(`pointerdown`,this.onHoverPointerDown),this.target.addEventListener(`pointerup`,this.onHoverPointerUp),this)}release(){return this.destroy(),document.removeEventListener(`scroll`,this.onScroll,{capture:!0}),this.trigger===`click`?(this.target.removeEventListener(`pointerdown`,this.onClick),this):(this.target.removeEventListener(`mouseenter`,this.onMouseEnter),this.target.removeEventListener(`mouseleave`,this.onMouseLeave),this.target.removeEventListener(`pointerdown`,this.onHoverPointerDown),this.target.removeEventListener(`pointerup`,this.onHoverPointerUp),this)}create(){return this.destroy(!0),this.showed=!0,this.container=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-tooltip`],this.content),this.bordered&&this.container.classList.add(`vot-tooltip-bordered`),this.container.setAttribute(`role`,`tooltip`),this.container.dataset.trigger=this.trigger,this.container.dataset.position=this.position,this.parentElement.appendChild(this.container),this.updatePos(),this.backgroundColor!==void 0&&(this.container.style.backgroundColor=this.backgroundColor),this.borderRadius!==void 0&&(this.container.style.borderRadius=`${this.borderRadius}px`),this.hidden&&(this.container.hidden=!0),this.container.style.opacity=`1`,this.onResizeObserver?.observe(this.layoutRoot),this.intersectionObserver?.observe(this.target),this}updatePos(){if(!this.container)return this;let{top,left}=this.calcPos(this.autoLayout),availableWidth=this.pageWidth-this.offsetX*2,maxWidth=this.maxWidth??Math.min(availableWidth,this.pageWidth-Math.min(left,this.pageWidth-availableWidth));return this.container.style.transform=`translate(${left}px, ${top}px)`,this.container.style.maxWidth=`${maxWidth}px`,this}calcPos(autoLayout=!0){if(!this.container)return{top:0,left:0};let{left:anchorLeft,right:anchorRight,top:anchorTop,bottom:anchorBottom,width:anchorWidth,height:anchorHeight}=this.anchor.getBoundingClientRect(),{width:containerWidth,height:containerHeight}=this.container.getBoundingClientRect(),width=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(containerWidth,0,this.pageWidth),height=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(containerHeight,0,this.pageHeight),left=anchorLeft-this.globalOffsetX,right=anchorRight-this.globalOffsetX,top=anchorTop-this.globalOffsetY,bottom=anchorBottom-this.globalOffsetY;switch(this.position){case`top`:{let pTop=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(top-height-this.offsetY,0,this.pageHeight);return autoLayout&&pTop+this.offsetY<height?(this.position=`bottom`,this.calcPos(!1)):{top:pTop,left:(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(left-width/2+anchorWidth/2,this.offsetX,this.pageWidth-width-this.offsetX)}}case`right`:{let pLeft=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(right+this.offsetX,0,this.pageWidth-width);return autoLayout&&pLeft+width>this.pageWidth-this.offsetX?(this.position=`left`,this.calcPos(!1)):{top:(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(top+(anchorHeight-height)/2,this.offsetY,this.pageHeight-height-this.offsetY),left:pLeft}}case`bottom`:{let pTop=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(bottom+this.offsetY,0,this.pageHeight-height);return autoLayout&&pTop+height>this.pageHeight-this.offsetY?(this.position=`top`,this.calcPos(!1)):{top:pTop,left:(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(left-width/2+anchorWidth/2,this.offsetX,this.pageWidth-width-this.offsetX)}}case`left`:{let pLeft=Math.max(0,left-width-this.offsetX);return autoLayout&&pLeft+width>left-this.offsetX?(this.position=`right`,this.calcPos(!1)):{top:(0,_utils_utils__WEBPACK_IMPORTED_MODULE_1__.qE)(top+(anchorHeight-height)/2,this.offsetY,this.pageHeight-height-this.offsetY),left:pLeft}}default:return{top:0,left:0}}}destroy(instant=!1){if(!this.container)return this;if(this.showed=!1,this.onResizeObserver?.disconnect(),this.intersectionObserver?.disconnect(),instant)return this.container.remove(),this;let container=this.container;return container.style.opacity=`0`,container.addEventListener(`transitionend`,()=>{container?.remove()},{once:!0}),this}set bordered(isBordered){this._bordered=isBordered,this.container?.classList.toggle(`vot-tooltip-bordered`)}get bordered(){return this._bordered}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/votButton.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>VOTButton});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),_icons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui/icons.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_1__]);_ui__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class VOTButton{container;translateButton;separator;pipButton;separator2;menuButton;label;_position;_direction;_status;_labelHtml;constructor({position=`default`,direction=`default`,status=`none`,labelHtml=``}){this._position=position,this._direction=direction,this._status=status,this._labelHtml=labelHtml;let elements=this.createElements();this.container=elements.container,this.translateButton=elements.translateButton,this.separator=elements.separator,this.pipButton=elements.pipButton,this.separator2=elements.separator2,this.menuButton=elements.menuButton,this.label=elements.label}static calcPosition(percentX,isBigContainer){return isBigContainer?percentX<=44?`left`:percentX>=66?`right`:`default`:`default`}static calcDirection(position){return[`default`,`top`].includes(position)?`row`:`column`}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-segmented-button`]);container.dataset.position=this._position,container.dataset.direction=this._direction,container.dataset.status=this._status;let translateButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-segment`,`vot-translate-button`]);(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(_icons__WEBPACK_IMPORTED_MODULE_2__.cg,translateButton);let label=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`span`,[`vot-segment-label`]);label.append(this._labelHtml),translateButton.appendChild(label);let separator=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-separator`]),pipButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-segment-only-icon`]);(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(_icons__WEBPACK_IMPORTED_MODULE_2__.B9,pipButton);let separator2=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-separator`]),menuButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,[`vot-segment-only-icon`]);return(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.XX)(_icons__WEBPACK_IMPORTED_MODULE_2__.kO,menuButton),container.append(translateButton,separator,pipButton,separator2,menuButton),{container,translateButton,separator,pipButton,separator2,menuButton,label}}showPiPButton(visible){return this.separator2.hidden=this.pipButton.hidden=!visible,this}setText(labelText){return this._labelHtml=this.label.textContent=labelText,this}remove(){return this.container.remove(),this}get tooltipPos(){switch(this.position){case`left`:return`right`;case`right`:return`left`;default:return`bottom`}}set status(status){this._status=this.container.dataset.status=status}get status(){return this._status}set loading(isLoading){this.container.dataset.loading=isLoading.toString()}get loading(){return this.container.dataset.loading===`true`}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}get position(){return this._position}set position(position){this._position=this.container.dataset.position=position}get direction(){return this._direction}set direction(direction){this._direction=this.container.dataset.direction=direction}set opacity(opacity){this.container.style.opacity=opacity.toString()}get opacity(){return Number(this.container.style.opacity)}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/components/votMenu.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{A:()=>VOTMenu});var _ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__]);_ui__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class VOTMenu{container;contentWrapper;headerContainer;bodyContainer;footerContainer;titleContainer;title;_position;_titleHtml;constructor({position=`default`,titleHtml=``}){this._position=position,this._titleHtml=titleHtml;let elements=this.createElements();this.container=elements.container,this.contentWrapper=elements.contentWrapper,this.headerContainer=elements.headerContainer,this.bodyContainer=elements.bodyContainer,this.footerContainer=elements.footerContainer,this.titleContainer=elements.titleContainer,this.title=elements.title}createElements(){let container=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu`]);container.hidden=!0,container.dataset.position=this._position;let contentWrapper=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu-content-wrapper`]);container.appendChild(contentWrapper);let headerContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu-header-container`]),titleContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu-title-container`]);headerContainer.appendChild(titleContainer);let title=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu-title`]);title.append(this._titleHtml),titleContainer.appendChild(title);let bodyContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu-body-container`]),footerContainer=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createEl(`vot-block`,[`vot-menu-footer-container`]);return contentWrapper.append(headerContainer,bodyContainer,footerContainer),{container,contentWrapper,headerContainer,bodyContainer,footerContainer,titleContainer,title}}setText(titleText){return this._titleHtml=this.title.textContent=titleText,this}remove(){return this.container.remove(),this}set hidden(isHidden){this.container.hidden=isHidden}get hidden(){return this.container.hidden}get position(){return this._position}set position(position){this._position=this.container.dataset.position=position}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/icons.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B9:()=>PIP_ICON_SVG,GA:()=>KEY_ICON,M9:()=>REFRESH_ICON,U0:()=>SUBTITLES_ICON,Xd:()=>WARNING_ICON,c1:()=>SETTINGS_ICON,cg:()=>TRANSLATE_ICON_SVG,jr:()=>CLOSE_ICON,kO:()=>MENU_ICON,mQ:()=>CHEVRON_ICON,nO:()=>DOWNLOAD_ICON,w2:()=>HELP_ICON,z3:()=>ARROW_RIGHT_ICON});var lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`);let TRANSLATE_ICON_SVG=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
  <path
    id="vot-translate-icon"
    fill-rule="evenodd"
    d="M15.778 18.95L14.903 21.375C14.8364 21.5583 14.7197 21.7083 14.553 21.825C14.3864 21.9417 14.203 22 14.003 22C13.6697 22 13.3989 21.8625 13.1905 21.5875C12.9822 21.3125 12.9447 21.0083 13.078 20.675L16.878 10.625C16.9614 10.4417 17.0864 10.2917 17.253 10.175C17.4197 10.0583 17.603 10 17.803 10H18.553C18.753 10 18.9364 10.0583 19.103 10.175C19.2697 10.2917 19.3947 10.4417 19.478 10.625L23.278 20.7C23.4114 21.0167 23.378 21.3125 23.178 21.5875C22.978 21.8625 22.7114 22 22.378 22C22.1614 22 21.9739 21.9375 21.8155 21.8125C21.6572 21.6875 21.5364 21.525 21.453 21.325L20.628 18.95H15.778ZM19.978 17.2H16.378L18.228 12.25L19.978 17.2Z"
  ></path>
  <path
    d="M9 14L4.7 18.3C4.51667 18.4833 4.28333 18.575 4 18.575C3.71667 18.575 3.48333 18.4833 3.3 18.3C3.11667 18.1167 3.025 17.8833 3.025 17.6C3.025 17.3167 3.11667 17.0833 3.3 16.9L7.65 12.55C7.01667 11.85 6.4625 11.125 5.9875 10.375C5.5125 9.625 5.1 8.83333 4.75 8H6.85C7.15 8.6 7.47083 9.14167 7.8125 9.625C8.15417 10.1083 8.56667 10.6167 9.05 11.15C9.78333 10.35 10.3917 9.52917 10.875 8.6875C11.3583 7.84583 11.7667 6.95 12.1 6H2C1.71667 6 1.47917 5.90417 1.2875 5.7125C1.09583 5.52083 1 5.28333 1 5C1 4.71667 1.09583 4.47917 1.2875 4.2875C1.47917 4.09583 1.71667 4 2 4H8V3C8 2.71667 8.09583 2.47917 8.2875 2.2875C8.47917 2.09583 8.71667 2 9 2C9.28333 2 9.52083 2.09583 9.7125 2.2875C9.90417 2.47917 10 2.71667 10 3V4H16C16.2833 4 16.5208 4.09583 16.7125 4.2875C16.9042 4.47917 17 4.71667 17 5C17 5.28333 16.9042 5.52083 16.7125 5.7125C16.5208 5.90417 16.2833 6 16 6H14.1C13.75 7.18333 13.275 8.33333 12.675 9.45C12.075 10.5667 11.3333 11.6167 10.45 12.6L12.85 15.05L12.1 17.1L9 14Z"
  ></path>
  <path
    id="vot-loading-icon"
    style="display:none"
    d="M19.8081 16.3697L18.5842 15.6633V13.0832C18.5842 12.9285 18.5228 12.7801 18.4134 12.6707C18.304 12.5613 18.1556 12.4998 18.0009 12.4998C17.8462 12.4998 17.6978 12.5613 17.5884 12.6707C17.479 12.7801 17.4176 12.9285 17.4176 13.0832V15.9998C17.4176 16.1022 17.4445 16.2028 17.4957 16.2915C17.5469 16.3802 17.6205 16.4538 17.7092 16.505L19.2247 17.38C19.2911 17.4189 19.3645 17.4443 19.4407 17.4547C19.5169 17.4652 19.5945 17.4604 19.6688 17.4407C19.7432 17.4211 19.813 17.3869 19.8741 17.3402C19.9352 17.2934 19.9864 17.2351 20.0249 17.1684C20.0634 17.1018 20.0883 17.0282 20.0982 16.952C20.1081 16.8757 20.1028 16.7982 20.0827 16.7239C20.0625 16.6497 20.0279 16.5802 19.9808 16.5194C19.9336 16.4586 19.8749 16.4077 19.8081 16.3697ZM18.0015 10C16.8478 10 15.6603 10.359 14.7011 11C13.7418 11.641 12.9415 12.4341 12.5 13.5C12.0585 14.5659 11.8852 16.0369 12.1103 17.1684C12.3353 18.3 12.8736 19.4942 13.6894 20.31C14.5053 21.1258 15.8684 21.7749 17 22C18.1316 22.2251 19.4341 21.9415 20.5 21.5C21.5659 21.0585 22.359 20.2573 23 19.298C23.641 18.3387 24.0015 17.1537 24.0015 16C23.9998 14.4534 23.5951 13.0936 22.5015 12C21.4079 10.9064 19.5481 10.0017 18.0015 10ZM18.0009 20.6665C17.0779 20.6665 16.1757 20.3928 15.4082 19.88C14.6408 19.3672 14.0427 18.6384 13.6894 17.7857C13.3362 16.933 13.2438 15.9947 13.4239 15.0894C13.604 14.1842 14.0484 13.3527 14.7011 12.7C15.3537 12.0474 16.1852 11.6029 17.0905 11.4228C17.9957 11.2428 18.934 11.3352 19.7867 11.6884C20.6395 12.0416 21.3683 12.6397 21.8811 13.4072C22.3939 14.1746 22.6676 15.0769 22.6676 15.9998C22.666 17.237 22.1738 18.4231 21.299 19.298C20.4242 20.1728 19.2381 20.665 18.0009 20.6665Z"
  ></path>
</svg>`,PIP_ICON_SVG=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
  <path
    d="M120-520q-17 0-28.5-11.5T80-560q0-17 11.5-28.5T120-600h104L80-743q-12-12-12-28.5T80-800q12-12 28.5-12t28.5 12l143 144v-104q0-17 11.5-28.5T320-800q17 0 28.5 11.5T360-760v200q0 17-11.5 28.5T320-520H120Zm40 360q-33 0-56.5-23.5T80-240v-160q0-17 11.5-28.5T120-440q17 0 28.5 11.5T160-400v160h280q17 0 28.5 11.5T480-200q0 17-11.5 28.5T440-160H160Zm680-280q-17 0-28.5-11.5T800-480v-240H480q-17 0-28.5-11.5T440-760q0-17 11.5-28.5T480-800h320q33 0 56.5 23.5T880-720v240q0 17-11.5 28.5T840-440ZM600-160q-17 0-28.5-11.5T560-200v-120q0-17 11.5-28.5T600-360h240q17 0 28.5 11.5T880-320v120q0 17-11.5 28.5T840-160H600Z"
  />
</svg>`,MENU_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
  <path
    d="M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm0-240q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm0-240q-33 0-56.5-23.5T400-720q0-33 23.5-56.5T480-800q33 0 56.5 23.5T560-720q0 33-23.5 56.5T480-640Z"
  />
</svg>`,DOWNLOAD_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="100%" viewBox="0 0 24 24" class="vot-loader" id="vot-loader-download">
  <path class="vot-loader-main" d="M12 15.575C11.8667 15.575 11.7417 15.5542 11.625 15.5125C11.5083 15.4708 11.4 15.4 11.3 15.3L7.7 11.7C7.5 11.5 7.40417 11.2667 7.4125 11C7.42083 10.7333 7.51667 10.5 7.7 10.3C7.9 10.1 8.1375 9.99583 8.4125 9.9875C8.6875 9.97917 8.925 10.075 9.125 10.275L11 12.15V5C11 4.71667 11.0958 4.47917 11.2875 4.2875C11.4792 4.09583 11.7167 4 12 4C12.2833 4 12.5208 4.09583 12.7125 4.2875C12.9042 4.47917 13 4.71667 13 5V12.15L14.875 10.275C15.075 10.075 15.3125 9.97917 15.5875 9.9875C15.8625 9.99583 16.1 10.1 16.3 10.3C16.4833 10.5 16.5792 10.7333 16.5875 11C16.5958 11.2667 16.5 11.5 16.3 11.7L12.7 15.3C12.6 15.4 12.4917 15.4708 12.375 15.5125C12.2583 15.5542 12.1333 15.575 12 15.575ZM6 20C5.45 20 4.97917 19.8042 4.5875 19.4125C4.19583 19.0208 4 18.55 4 18V16C4 15.7167 4.09583 15.4792 4.2875 15.2875C4.47917 15.0958 4.71667 15 5 15C5.28333 15 5.52083 15.0958 5.7125 15.2875C5.90417 15.4792 6 15.7167 6 16V18H18V16C18 15.7167 18.0958 15.4792 18.2875 15.2875C18.4792 15.0958 18.7167 15 19 15C19.2833 15 19.5208 15.0958 19.7125 15.2875C19.9042 15.4792 20 15.7167 20 16V18C20 18.55 19.8042 19.0208 19.4125 19.4125C19.0208 19.8042 18.55 20 18 20H6Z"/>
  <text class="vot-loader-text" dominant-baseline="middle" text-anchor="middle" x="50%" y="50%"></text>
</svg>`,SUBTITLES_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="100%" viewBox="0 0 24 24">
  <path d="M4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.588 1.413T20 20H4Zm2-4h8v-2H6v2Zm10 0h2v-2h-2v2ZM6 12h2v-2H6v2Zm4 0h8v-2h-8v2Z"/>
</svg>`,SETTINGS_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="100%" viewBox="0 -960 960 960">
  <path d="M555-80H405q-15 0-26-10t-13-25l-12-93q-13-5-24.5-12T307-235l-87 36q-14 5-28 1t-22-17L96-344q-8-13-5-28t15-24l75-57q-1-7-1-13.5v-27q0-6.5 1-13.5l-75-57q-12-9-15-24t5-28l74-129q7-14 21.5-17.5T220-761l87 36q11-8 23-15t24-12l12-93q2-15 13-25t26-10h150q15 0 26 10t13 25l12 93q13 5 24.5 12t22.5 15l87-36q14-5 28-1t22 17l74 129q8 13 5 28t-15 24l-75 57q1 7 1 13.5v27q0 6.5-2 13.5l75 57q12 9 15 24t-5 28l-74 128q-8 13-22.5 17.5T738-199l-85-36q-11 8-23 15t-24 12l-12 93q-2 15-13 25t-26 10Zm-73-260q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm0-80q-25 0-42.5-17.5T422-480q0-25 17.5-42.5T482-540q25 0 42.5 17.5T542-480q0 25-17.5 42.5T482-420Zm-2-60Zm-40 320h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Z"/>
</svg>`,CHEVRON_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" >
  <path
    d="M12 14.975q-.2 0-.375-.062T11.3 14.7l-4.6-4.6q-.275-.275-.275-.7t.275-.7q.275-.275.7-.275t.7.275l3.9 3.9l3.9-3.9q.275-.275.7-.275t.7.275q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062Z"
  />
</svg>`,ARROW_RIGHT_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
  <path
    d="M647-440H200q-17 0-28.5-11.5T160-480q0-17 11.5-28.5T200-520h447L451-716q-12-12-11.5-28t12.5-28q12-11 28-11.5t28 11.5l264 264q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L508-188q-11 11-27.5 11T452-188q-12-12-12-28.5t12-28.5l195-195Z"
  />
</svg>`,CLOSE_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="100%" viewBox="0 -960 960 960">
  <path d="M480-424 284-228q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536-480l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-424Z"/>
</svg>`,WARNING_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
  <g fill="none">
    <path d="m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2m0 2a8 8 0 1 0 0 16a8 8 0 0 0 0-16m0 11a1 1 0 1 1 0 2a1 1 0 0 1 0-2m0-9a1 1 0 0 1 1 1v6a1 1 0 1 1-2 0V7a1 1 0 0 1 1-1"/>
  </g>
</svg>`,HELP_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
  <g fill="none">
    <path d="m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2m0 2a8 8 0 1 0 0 16a8 8 0 0 0 0-16m0 12a1 1 0 1 1 0 2a1 1 0 0 1 0-2m0-9.5a3.625 3.625 0 0 1 1.348 6.99a.8.8 0 0 0-.305.201c-.044.05-.051.114-.05.18L13 14a1 1 0 0 1-1.993.117L11 14v-.25c0-1.153.93-1.845 1.604-2.116a1.626 1.626 0 1 0-2.229-1.509a1 1 0 1 1-2 0A3.625 3.625 0 0 1 12 6.5"/>
  </g>
</svg>`,REFRESH_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
  <g fill="none">
    <path d="m12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036q-.016-.004-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.016-.018m.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01z"/>
    <path fill="currentColor" d="M20 9a1 1 0 0 1 1 1v1a8 8 0 0 1-8 8H9.414l.793.793a1 1 0 0 1-1.414 1.414l-2.496-2.496a1 1 0 0 1-.287-.567L6 17.991a1 1 0 0 1 .237-.638l.056-.06l2.5-2.5a1 1 0 0 1 1.414 1.414L9.414 17H13a6 6 0 0 0 6-6v-1a1 1 0 0 1 1-1m-4.793-6.207l2.5 2.5a1 1 0 0 1 0 1.414l-2.5 2.5a1 1 0 1 1-1.414-1.414L14.586 7H11a6 6 0 0 0-6 6v1a1 1 0 1 1-2 0v-1a8 8 0 0 1 8-8h3.586l-.793-.793a1 1 0 0 1 1.414-1.414"/>
  </g>
</svg>`,KEY_ICON=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.JW)`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
  <path fill="currentColor" d="M7 15q1.25 0 2.125-.875T10 12t-.875-2.125T7 9t-2.125.875T4 12t.875 2.125T7 15m0 3q-2.5 0-4.25-1.75T1 12t1.75-4.25T7 6q2.025 0 3.538 1.15T12.65 10h8.375L23 11.975l-3.5 4L17 14l-2 2l-2-2h-.35q-.625 1.8-2.175 2.9T7 18"/>
  </svg>`},"./src/ui/manager.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{o:()=>UIManager});var _vot_js_shared_utils_subs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(`./node_modules/@vot.js/shared/dist/utils/subs.js`),_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),_config_config__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(`./src/config/config.js`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/localization/localizationProvider.ts`),_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/utils/VOTLocalizedError.js`),_utils_debug__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/utils/debug.ts`),_utils_gm__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/utils/gm.ts`),_utils_storage__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/utils/storage.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/utils/utils.ts`),_components_votButton__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./src/ui/components/votButton.ts`),_views_overlay__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/ui/views/overlay.ts`),_views_settings__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(`./src/ui/views/settings.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__,_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_2__,_utils_gm__WEBPACK_IMPORTED_MODULE_4__,_utils_storage__WEBPACK_IMPORTED_MODULE_5__,_utils_utils__WEBPACK_IMPORTED_MODULE_6__,_components_votButton__WEBPACK_IMPORTED_MODULE_7__,_views_overlay__WEBPACK_IMPORTED_MODULE_8__,_views_settings__WEBPACK_IMPORTED_MODULE_9__]);[_ui__WEBPACK_IMPORTED_MODULE_0__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__,_utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_2__,_utils_gm__WEBPACK_IMPORTED_MODULE_4__,_utils_storage__WEBPACK_IMPORTED_MODULE_5__,_utils_utils__WEBPACK_IMPORTED_MODULE_6__,_components_votButton__WEBPACK_IMPORTED_MODULE_7__,_views_overlay__WEBPACK_IMPORTED_MODULE_8__,_views_settings__WEBPACK_IMPORTED_MODULE_9__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class UIManager{root;portalContainer;tooltipLayoutRoot;initialized=!1;videoHandler;data;votGlobalPortal;votOverlayView;votSettingsView;constructor({root,portalContainer,tooltipLayoutRoot,data={},videoHandler}){this.root=root,this.portalContainer=portalContainer,this.tooltipLayoutRoot=tooltipLayoutRoot,this.videoHandler=videoHandler,this.data=data}isInitialized(){return this.initialized}initUI(){if(this.isInitialized())throw Error(`[VOT] UIManager is already initialized`);return this.initialized=!0,this.votGlobalPortal=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createPortal(),document.documentElement.appendChild(this.votGlobalPortal),this.votOverlayView=new _views_overlay__WEBPACK_IMPORTED_MODULE_8__.i({root:this.root,portalContainer:this.portalContainer,tooltipLayoutRoot:this.tooltipLayoutRoot,globalPortal:this.votGlobalPortal,data:this.data,videoHandler:this.videoHandler}),this.votOverlayView.initUI(),this.votSettingsView=new _views_settings__WEBPACK_IMPORTED_MODULE_9__.r({globalPortal:this.votGlobalPortal,data:this.data,videoHandler:this.videoHandler}),this.votSettingsView.initUI(),this}initUIEvents(){if(!this.isInitialized())throw Error(`[VOT] UIManager isn't initialized`);this.votOverlayView.initUIEvents(),this.votOverlayView.addEventListener(`click:translate`,async()=>{await this.handleTranslationBtnClick()}).addEventListener(`click:pip`,async()=>{if(!this.videoHandler)return;let isPiPActive=this.videoHandler.video===document.pictureInPictureElement;await(isPiPActive?document.exitPictureInPicture():this.videoHandler.video.requestPictureInPicture())}).addEventListener(`click:settings`,async()=>{this.videoHandler?.subtitlesWidget.releaseTooltip(),this.votSettingsView.open(),await(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.Eh)()}).addEventListener(`click:downloadTranslation`,async()=>{if(!(!this.votOverlayView.isInitialized()||!this.videoHandler?.downloadTranslationUrl||!this.videoHandler.videoData)){try{if(!this.data.downloadWithName||!_utils_gm__WEBPACK_IMPORTED_MODULE_4__.yx)return(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.Wo)(this.videoHandler.downloadTranslationUrl);this.votOverlayView.downloadTranslationButton.progress=0;let res=await(0,_utils_gm__WEBPACK_IMPORTED_MODULE_4__.G3)(this.videoHandler.downloadTranslationUrl,{timeout:0});if(!res.ok)throw Error(`HTTP ${res.status}`);let filename=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.Le)(this.videoHandler.videoData.downloadTitle);await(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.MR)(res,filename,progress=>{this.votOverlayView.downloadTranslationButton.progress=progress})}catch(err){console.error(`[VOT] Download translation failed:`,err),(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.Wo)(this.videoHandler.downloadTranslationUrl)}this.votOverlayView.downloadTranslationButton.progress=0}}).addEventListener(`click:downloadSubtitles`,async()=>{if(!this.videoHandler||!this.videoHandler.yandexSubtitles||!this.videoHandler.videoData)return;let subsFormat=this.data.subtitlesDownloadFormat??`json`,subsContent=(0,_vot_js_shared_utils_subs__WEBPACK_IMPORTED_MODULE_10__.vk)(this.videoHandler.yandexSubtitles,subsFormat),blob=new Blob([subsFormat===`json`?JSON.stringify(subsContent):subsContent],{type:`text/plain`}),filename=this.data.downloadWithName?(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.Le)(this.videoHandler.videoData.downloadTitle):`subtitles_${this.videoHandler.videoData.videoId}`;(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.WN)(blob,`${filename}.${subsFormat}`)}).addEventListener(`input:videoVolume`,volume=>{this.videoHandler&&(this.videoHandler.setVideoVolume(volume/100),this.data.syncVolume&&this.videoHandler.syncVolumeWrapper(`video`,volume))}).addEventListener(`input:translationVolume`,()=>{if(!this.videoHandler)return;let defaultVolume=this.data.defaultVolume??100;this.videoHandler.audioPlayer.player.volume=defaultVolume/100,this.data.syncVolume&&(this.videoHandler.syncVolumeWrapper(`translation`,defaultVolume),[`youtube`,`googledrive`].includes(this.videoHandler.site.host)&&this.videoHandler.site.additionalData!==`mobile`&&this.videoHandler.setVideoVolume(this.videoHandler.tempOriginalVolume/100))}).addEventListener(`select:subtitles`,async data=>{await this.videoHandler?.changeSubtitlesLang(data)}),this.votSettingsView.initUIEvents(),this.votSettingsView.addEventListener(`update:account`,async account=>{this.videoHandler&&(this.videoHandler.votClient.apiToken=account?.token)}).addEventListener(`change:autoTranslate`,async checked=>{checked&&this.videoHandler&&!this.videoHandler?.hasActiveSource()&&await this.handleTranslationBtnClick()}).addEventListener(`change:showVideoVolume`,()=>{this.votOverlayView.isInitialized()&&(this.votOverlayView.videoVolumeSlider.container.hidden=!this.data.showVideoSlider||this.votOverlayView.votButton.status!==`success`)}).addEventListener(`change:audioBuster`,async()=>{if(!this.votOverlayView.isInitialized())return;let currentVolume=this.votOverlayView.translationVolumeSlider.value;this.votOverlayView.translationVolumeSlider.max=this.data.audioBooster?_config_config__WEBPACK_IMPORTED_MODULE_11__.T8:100,this.votOverlayView.translationVolumeSlider.value=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_6__.qE)(currentVolume,0,100)}).addEventListener(`change:useLivelyVoice`,()=>{this.videoHandler?.stopTranslate()}).addEventListener(`change:subtitlesHighlightWords`,checked=>{this.videoHandler?.subtitlesWidget.setHighlightWords(this.data.highlightWords??checked)}).addEventListener(`input:subtitlesMaxLength`,value=>{this.videoHandler?.subtitlesWidget.setMaxLength(this.data.subtitlesMaxLength??value)}).addEventListener(`input:subtitlesFontSize`,value=>{this.videoHandler?.subtitlesWidget.setFontSize(this.data.subtitlesFontSize??value)}).addEventListener(`input:subtitlesBackgroundOpacity`,value=>{this.videoHandler?.subtitlesWidget.setOpacity(this.data.subtitlesOpacity??value)}).addEventListener(`change:proxyWorkerHost`,value=>{!this.data.translateProxyEnabled||!this.videoHandler||(this.videoHandler.votClient.host=this.data.proxyWorkerHost??value)}).addEventListener(`select:proxyTranslationStatus`,()=>{this.videoHandler?.initVOTClient()}).addEventListener(`change:useNewAudioPlayer`,()=>{this.videoHandler&&(this.videoHandler.stopTranslate(),this.videoHandler.createPlayer())}).addEventListener(`change:onlyBypassMediaCSP`,()=>{this.videoHandler&&(this.videoHandler.stopTranslate(),this.videoHandler.createPlayer())}).addEventListener(`select:translationTextService`,()=>{this.videoHandler&&(this.videoHandler.subtitlesWidget.strTranslatedTokens=``,this.videoHandler.subtitlesWidget.releaseTooltip())}).addEventListener(`change:showPiPButton`,()=>{this.votOverlayView.isInitialized()&&(this.votOverlayView.votButton.pipButton.hidden=this.votOverlayView.votButton.separator2.hidden=!this.votOverlayView.pipButtonVisible)}).addEventListener(`select:buttonPosition`,item=>{if(!this.votOverlayView.isInitialized())return;let newPosition=this.data.buttonPos??item;this.votOverlayView.updateButtonLayout(newPosition,_components_votButton__WEBPACK_IMPORTED_MODULE_7__.A.calcDirection(newPosition))}).addEventListener(`select:menuLanguage`,async()=>{await this.reloadMenu()}).addEventListener(`click:bugReport`,()=>{if(!this.videoHandler)return;let params=new URLSearchParams(this.videoHandler.collectReportInfo()).toString();window.open(`${_config_config__WEBPACK_IMPORTED_MODULE_11__.Ek}/issues/new?${params}`,`_blank`)?.focus()}).addEventListener(`click:resetSettings`,async()=>{let valuesForClear=await _utils_storage__WEBPACK_IMPORTED_MODULE_5__.d.list();await Promise.all(valuesForClear.map(async val=>await _utils_storage__WEBPACK_IMPORTED_MODULE_5__.d.delete(val))),await _utils_storage__WEBPACK_IMPORTED_MODULE_5__.d.set(`compatVersion`,_config_config__WEBPACK_IMPORTED_MODULE_11__.r4),window.location.reload()})}async reloadMenu(){if(!this.votOverlayView?.isInitialized())throw Error(`[VOT] OverlayView isn't initialized`);if(this.videoHandler?.stopTranslation(),this.release(),this.initUI(),this.initUIEvents(),!this.videoHandler)return this;await this.videoHandler.updateSubtitlesLangSelect(),this.videoHandler.subtitlesWidget.portal=this.votOverlayView.votOverlayPortal,this.videoHandler.subtitlesWidget.strTranslatedTokens=``}async handleTranslationBtnClick(){if(!this.votOverlayView?.isInitialized())throw Error(`[VOT] OverlayView isn't initialized`);if(!this.videoHandler)return this;if(_utils_debug__WEBPACK_IMPORTED_MODULE_3__.A.log(`[handleTranslationBtnClick] click translationBtn`),this.videoHandler.hasActiveSource())return _utils_debug__WEBPACK_IMPORTED_MODULE_3__.A.log(`[handleTranslationBtnClick] video has active source`),this.videoHandler.stopTranslation(),this;if(this.votOverlayView.votButton.status!==`none`||this.votOverlayView.votButton.loading)return _utils_debug__WEBPACK_IMPORTED_MODULE_3__.A.log(`[handleTranslationBtnClick] translationBtn isn't in none state`),this.videoHandler.actionsAbortController.abort(),this.videoHandler.stopTranslation(),this;try{if(_utils_debug__WEBPACK_IMPORTED_MODULE_3__.A.log(`[handleTranslationBtnClick] trying execute translation`),!this.videoHandler.videoData?.videoId)throw new _utils_VOTLocalizedError_js__WEBPACK_IMPORTED_MODULE_2__.n(`VOTNoVideoIDFound`);(this.videoHandler.site.host===`vk`&&this.videoHandler.site.additionalData===`clips`||this.videoHandler.site.host===`douyin`)&&(this.videoHandler.videoData=await this.videoHandler.getVideoData()),_utils_debug__WEBPACK_IMPORTED_MODULE_3__.A.log(`[handleTranslationBtnClick] Run translateFunc`,this.videoHandler.videoData.videoId),await this.videoHandler.translateFunc(this.videoHandler.videoData.videoId,this.videoHandler.videoData.isStream,this.videoHandler.videoData.detectedLanguage,this.videoHandler.videoData.responseLanguage,this.videoHandler.videoData.translationHelp)}catch(err){if(console.error(`[VOT]`,err),!(err instanceof Error))return this.transformBtn(`error`,String(err)),this;let message=err.name===`VOTLocalizedError`?err.localizedMessage:err.message;this.transformBtn(`error`,message)}return this}isLoadingText(text){return typeof text==`string`&&(text.includes(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`translationTake`))||text.includes(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_1__.j.get(`TranslationDelayed`)))}transformBtn(status,text){if(!this.votOverlayView?.isInitialized())throw Error(`[VOT] OverlayView isn't initialized`);return this.votOverlayView.votButton.status=status,this.votOverlayView.votButton.loading=status===`error`&&this.isLoadingText(text),this.votOverlayView.votButton.setText(text),this.votOverlayView.votButtonTooltip.setContent(text),this}releaseUI(initialized=!1){if(!this.isInitialized())throw Error(`[VOT] UIManager isn't initialized`);return this.votOverlayView.releaseUI(!0),this.votSettingsView.releaseUI(!0),this.votGlobalPortal.remove(),this.initialized=initialized,this}releaseUIEvents(initialized=!1){if(!this.isInitialized())throw Error(`[VOT] UIManager isn't initialized`);return this.votOverlayView.releaseUIEvents(!1),this.votSettingsView.releaseUIEvents(!1),this.initialized=initialized,this}release(){return this.releaseUI(!0),this.releaseUIEvents(!1),this}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/views/overlay.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{i:()=>OverlayView});var _vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/consts.js`),_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/ui.js`),_components_languagePairSelect__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui/components/languagePairSelect.ts`),_components_select__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui/components/select.ts`),_components_slider__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/ui/components/slider.ts`),_components_sliderLabel__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/ui/components/sliderLabel.ts`),_components_tooltip__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/ui/components/tooltip.ts`),_components_votButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/ui/components/votButton.ts`),_components_votMenu__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./src/ui/components/votMenu.ts`),_icons__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/ui/icons.ts`),_config_config__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(`./src/config/config.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(`./src/core/eventImpl.ts`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(`./src/localization/localizationProvider.ts`),_utils_storage__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(`./src/utils/storage.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(`./src/utils/utils.ts`),_components_downloadButton__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(`./src/ui/components/downloadButton.ts`),_components_label__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(`./src/ui/components/label.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_0__,_components_languagePairSelect__WEBPACK_IMPORTED_MODULE_1__,_components_select__WEBPACK_IMPORTED_MODULE_2__,_components_slider__WEBPACK_IMPORTED_MODULE_3__,_components_sliderLabel__WEBPACK_IMPORTED_MODULE_4__,_components_tooltip__WEBPACK_IMPORTED_MODULE_5__,_components_votButton__WEBPACK_IMPORTED_MODULE_6__,_components_votMenu__WEBPACK_IMPORTED_MODULE_7__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__,_utils_storage__WEBPACK_IMPORTED_MODULE_10__,_utils_utils__WEBPACK_IMPORTED_MODULE_11__,_components_downloadButton__WEBPACK_IMPORTED_MODULE_12__,_components_label__WEBPACK_IMPORTED_MODULE_13__]);[_ui__WEBPACK_IMPORTED_MODULE_0__,_components_languagePairSelect__WEBPACK_IMPORTED_MODULE_1__,_components_select__WEBPACK_IMPORTED_MODULE_2__,_components_slider__WEBPACK_IMPORTED_MODULE_3__,_components_sliderLabel__WEBPACK_IMPORTED_MODULE_4__,_components_tooltip__WEBPACK_IMPORTED_MODULE_5__,_components_votButton__WEBPACK_IMPORTED_MODULE_6__,_components_votMenu__WEBPACK_IMPORTED_MODULE_7__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__,_utils_storage__WEBPACK_IMPORTED_MODULE_10__,_utils_utils__WEBPACK_IMPORTED_MODULE_11__,_components_downloadButton__WEBPACK_IMPORTED_MODULE_12__,_components_label__WEBPACK_IMPORTED_MODULE_13__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class OverlayView{root;tooltipLayoutRoot;portalContainer;globalPortal;dragging=!1;initialized=!1;data;videoHandler;cancelDraggingEvents=[`pointercancel`,`touchcancel`];onClickSettings=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onClickPiP=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onClickTranslate=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onClickDownloadTranslation=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onClickDownloadSubtitles=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onSelectFromLanguage=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onSelectToLanguage=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onSelectSubtitles=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onInputVideoVolume=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;onInputTranslationVolume=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_14__.Z;votOverlayPortal;votButton;votButtonTooltip;votMenu;downloadTranslationButton;downloadSubtitlesButton;openSettingsButton;languagePairSelect;subtitlesSelectLabel;subtitlesSelect;videoVolumeSliderLabel;videoVolumeSlider;tranlsationVolumeSliderLabel;translationVolumeSlider;constructor({root,portalContainer,tooltipLayoutRoot,globalPortal,data={},videoHandler}){this.root=root,this.portalContainer=portalContainer,this.tooltipLayoutRoot=tooltipLayoutRoot,this.globalPortal=globalPortal,this.data=data,this.videoHandler=videoHandler}isInitialized(){return this.initialized}calcButtonLayout(position){return this.isBigContainer&&[`left`,`right`].includes(position)?{direction:`column`,position}:{direction:`row`,position:`default`}}addEventListener(type,listener){switch(type){case`click:settings`:this.onClickSettings.addListener(listener);break;case`click:pip`:this.onClickPiP.addListener(listener);break;case`click:downloadTranslation`:this.onClickDownloadTranslation.addListener(listener);break;case`click:downloadSubtitles`:this.onClickDownloadSubtitles.addListener(listener);break;case`click:translate`:this.onClickTranslate.addListener(listener);break;case`input:videoVolume`:this.onInputVideoVolume.addListener(listener);break;case`input:translationVolume`:this.onInputTranslationVolume.addListener(listener);break;case`select:fromLanguage`:this.onSelectFromLanguage.addListener(listener);break;case`select:toLanguage`:this.onSelectToLanguage.addListener(listener);break;case`select:subtitles`:this.onSelectSubtitles.addListener(listener);break}return this}removeEventListener(type,listener){switch(type){case`click:settings`:this.onClickSettings.removeListener(listener);break;case`click:pip`:this.onClickPiP.removeListener(listener);break;case`click:downloadTranslation`:this.onClickDownloadTranslation.removeListener(listener);break;case`click:downloadSubtitles`:this.onClickDownloadSubtitles.removeListener(listener);break;case`click:translate`:this.onClickTranslate.removeListener(listener);break;case`input:videoVolume`:this.onInputVideoVolume.removeListener(listener);break;case`input:translationVolume`:this.onInputTranslationVolume.removeListener(listener);break;case`select:fromLanguage`:this.onSelectFromLanguage.removeListener(listener);break;case`select:toLanguage`:this.onSelectToLanguage.removeListener(listener);break;case`select:subtitles`:this.onSelectSubtitles.removeListener(listener);break}return this}initUI(buttonPosition=`default`){if(this.isInitialized())throw Error(`[VOT] OverlayView is already initialized`);this.initialized=!0;let{position,direction}=this.calcButtonLayout(buttonPosition);this.votOverlayPortal=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createPortal(!0),this.portalContainer.appendChild(this.votOverlayPortal),this.votButton=new _components_votButton__WEBPACK_IMPORTED_MODULE_6__.A({position,direction,status:`none`,labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`translateVideo`)}),this.votButton.opacity=0,this.pipButtonVisible||this.votButton.showPiPButton(!1),this.root.appendChild(this.votButton.container),this.votButtonTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_5__.A({target:this.votButton.translateButton,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`translateVideo`),position:this.votButton.tooltipPos,hidden:direction===`row`,bordered:!1,parentElement:this.votOverlayPortal,layoutRoot:this.tooltipLayoutRoot}),this.votMenu=new _components_votMenu__WEBPACK_IMPORTED_MODULE_7__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSettings`),position}),this.root.appendChild(this.votMenu.container),this.downloadTranslationButton=new _components_downloadButton__WEBPACK_IMPORTED_MODULE_12__.A,this.downloadTranslationButton.hidden=!0,this.downloadSubtitlesButton=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createIconButton(_icons__WEBPACK_IMPORTED_MODULE_8__.U0),this.downloadSubtitlesButton.hidden=!0,this.openSettingsButton=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createIconButton(_icons__WEBPACK_IMPORTED_MODULE_8__.c1),this.votMenu.headerContainer.append(this.downloadTranslationButton.button,this.downloadSubtitlesButton,this.openSettingsButton);let detectedLanguage=this.videoHandler?.videoData?.detectedLanguage??`en`,responseLanguage=this.data.responseLanguage??`ru`;this.languagePairSelect=new _components_languagePairSelect__WEBPACK_IMPORTED_MODULE_1__.A({from:{selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`langs.${detectedLanguage}`),items:_components_select__WEBPACK_IMPORTED_MODULE_2__.A.genLanguageItems(_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_15__.xm,detectedLanguage)},to:{selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`langs.${responseLanguage}`),items:_components_select__WEBPACK_IMPORTED_MODULE_2__.A.genLanguageItems(_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_15__.Xh,responseLanguage)}}),this.subtitlesSelectLabel=new _components_label__WEBPACK_IMPORTED_MODULE_13__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSubtitles`)}),this.subtitlesSelect=new _components_select__WEBPACK_IMPORTED_MODULE_2__.A({selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSubtitlesDisabled`),dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSubtitles`),labelElement:this.subtitlesSelectLabel.container,dialogParent:this.globalPortal,items:[{label:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTSubtitlesDisabled`),value:`disabled`,selected:!0}]});let videoVolume=this.videoHandler?this.videoHandler.getVideoVolume()*100:100;this.videoVolumeSliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_4__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTVolume`),value:videoVolume}),this.videoVolumeSlider=new _components_slider__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:this.videoVolumeSliderLabel.container,value:videoVolume}),this.videoVolumeSlider.hidden=!this.data.showVideoSlider||this.votButton.status!==`success`;let defaultVolume=this.data.defaultVolume??100;return this.tranlsationVolumeSliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_4__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_9__.j.get(`VOTVolumeTranslation`),value:defaultVolume}),this.translationVolumeSlider=new _components_slider__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:this.tranlsationVolumeSliderLabel.container,value:defaultVolume,max:this.data.audioBooster?_config_config__WEBPACK_IMPORTED_MODULE_16__.T8:100}),this.translationVolumeSlider.hidden=this.votButton.status!==`success`,this.votMenu.bodyContainer.append(this.languagePairSelect.container,this.subtitlesSelect.container,this.videoVolumeSlider.container,this.translationVolumeSlider.container),this}initUIEvents(){if(!this.isInitialized())throw Error(`[VOT] OverlayView isn't initialized`);this.votButton.container.addEventListener(`click`,e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}),this.votButton.translateButton.addEventListener(`pointerdown`,async()=>{this.onClickTranslate.dispatch()}),this.votButton.pipButton.addEventListener(`pointerdown`,async()=>{this.onClickPiP.dispatch()}),this.votButton.menuButton.addEventListener(`pointerdown`,async()=>{this.votMenu.hidden=!this.votMenu.hidden});let enableDraggingByEvent=event=>{this.dragging=!0,event.preventDefault()};this.votButton.container.addEventListener(`pointerdown`,enableDraggingByEvent),this.root.addEventListener(`pointerup`,this.disableDragging),this.root.addEventListener(`pointermove`,this.handleContainerPointerMove),this.votButton.container.addEventListener(`touchstart`,enableDraggingByEvent,{passive:!1}),this.root.addEventListener(`touchend`,this.disableDragging),this.root.addEventListener(`touchmove`,this.handleContainerTouchMove,{passive:!1});for(let event of this.cancelDraggingEvents)document.addEventListener(event,this.disableDragging);this.votMenu.container.addEventListener(`click`,e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()});for(let event of[`pointerdown`,`mousedown`])this.votMenu.container.addEventListener(event,e=>{e.stopImmediatePropagation()});return this.downloadTranslationButton.addEventListener(`click`,async()=>{this.onClickDownloadTranslation.dispatch()}),this.downloadSubtitlesButton.addEventListener(`click`,async()=>{this.onClickDownloadSubtitles.dispatch()}),this.openSettingsButton.addEventListener(`click`,async()=>{this.onClickSettings.dispatch()}),this.languagePairSelect.fromSelect.addEventListener(`selectItem`,language=>{this.videoHandler?.videoData&&(this.videoHandler.videoData.detectedLanguage=language),this.onSelectFromLanguage.dispatch(language)}),this.languagePairSelect.toSelect.addEventListener(`selectItem`,async language=>{this.videoHandler?.videoData&&(this.videoHandler.translateToLang=this.videoHandler.videoData.responseLanguage=language),this.data.responseLanguage=language,await _utils_storage__WEBPACK_IMPORTED_MODULE_10__.d.set(`responseLanguage`,this.data.responseLanguage),this.onSelectToLanguage.dispatch(language)}),this.subtitlesSelect.addEventListener(`beforeOpen`,async dialog=>{if(!this.videoHandler?.videoData)return;let cacheKey=`${this.videoHandler.videoData.videoId}_${this.videoHandler.videoData.detectedLanguage}_${this.videoHandler.videoData.responseLanguage}_${this.data.useLivelyVoice}`;if(this.videoHandler.cacheManager.getSubtitles(cacheKey))return;this.votButton.loading=!0;let loadingEl=_ui__WEBPACK_IMPORTED_MODULE_0__.A.createInlineLoader();loadingEl.style.margin=`0 auto`,dialog.footerContainer.appendChild(loadingEl),await this.videoHandler.loadSubtitles(),dialog.footerContainer.removeChild(loadingEl),this.votButton.loading=!1}),this.subtitlesSelect.addEventListener(`selectItem`,data=>{this.onSelectSubtitles.dispatch(data)}),this.videoVolumeSlider.addEventListener(`input`,(value,fromSetter)=>{this.videoVolumeSliderLabel.value=value,!fromSetter&&this.onInputVideoVolume.dispatch(value)}),this.translationVolumeSlider.addEventListener(`input`,async(value,fromSetter)=>{this.tranlsationVolumeSliderLabel.value=value,this.data.defaultVolume=value,await _utils_storage__WEBPACK_IMPORTED_MODULE_10__.d.set(`defaultVolume`,this.data.defaultVolume),!fromSetter&&this.onInputTranslationVolume.dispatch(value)}),this}updateButtonLayout(position,direction){return this.isInitialized()?(this.votMenu.position=position,this.votButton.position=position,this.votButton.direction=direction,this.votButtonTooltip.hidden=direction===`row`,this.votButtonTooltip.setPosition(this.votButton.tooltipPos),this):this}async moveButton(percentX){if(!this.isInitialized())return this;let position=_components_votButton__WEBPACK_IMPORTED_MODULE_6__.A.calcPosition(percentX,this.isBigContainer);if(position===this.votButton.position)return this;let direction=_components_votButton__WEBPACK_IMPORTED_MODULE_6__.A.calcDirection(position);return this.data.buttonPos=position,this.updateButtonLayout(position,direction),this.isBigContainer&&await _utils_storage__WEBPACK_IMPORTED_MODULE_10__.d.set(`buttonPos`,position),this}async handleDragMove(event,clientX,rect=this.root.getBoundingClientRect()){if(!this.dragging)return this;event.preventDefault();let x=clientX-rect.left,percentX=x/rect.width*100;return await this.moveButton(percentX),this}disableDragging=()=>{this.dragging=!1};handleContainerPointerMove=async event=>{await this.handleDragMove(event,event.clientX)};handleContainerTouchMove=async event=>{await this.handleDragMove(event,event.touches[0].clientX)};updateButtonOpacity(opacity){return!this.isInitialized()||!this.votMenu.hidden||(this.votButton.opacity=opacity),this}releaseUI(initialized=!1){if(!this.isInitialized())throw Error(`[VOT] OverlayView isn't initialized`);return this.votButton.remove(),this.votMenu.remove(),this.votButtonTooltip.release(),this.votOverlayPortal.remove(),this.initialized=initialized,this}releaseUIEvents(initialized=!1){if(!this.isInitialized())throw Error(`[VOT] OverlayView isn't initialized`);this.root.removeEventListener(`pointerup`,this.disableDragging),this.root.removeEventListener(`pointermove`,this.handleContainerPointerMove),this.root.removeEventListener(`touchend`,this.disableDragging),this.root.removeEventListener(`touchmove`,this.handleContainerTouchMove);for(let event of this.cancelDraggingEvents)document.removeEventListener(event,this.disableDragging);return this.onClickSettings.clear(),this.onClickPiP.clear(),this.onClickTranslate.clear(),this.onClickDownloadTranslation.clear(),this.onClickDownloadSubtitles.clear(),this.onSelectFromLanguage.clear(),this.onSelectToLanguage.clear(),this.onSelectSubtitles.clear(),this.onInputVideoVolume.clear(),this.onInputTranslationVolume.clear(),this.initialized=initialized,this}release(){return this.releaseUI(!0),this.releaseUIEvents(!1),this}get isBigContainer(){return this.root.clientWidth>550}get pipButtonVisible(){return(0,_utils_utils__WEBPACK_IMPORTED_MODULE_11__.Bs)()&&!!this.data.showPiPButton}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/ui/views/settings.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{r:()=>SettingsView});var _vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/consts.js`),lit_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/lit-html/lit-html.js`),_ui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/ui.js`),_components_accountButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/ui/components/accountButton.ts`),_components_checkbox__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/ui/components/checkbox.ts`),_components_details__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/ui/components/details.ts`),_components_dialog__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(`./src/ui/components/dialog.ts`),_components_hotkeyButton__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(`./src/ui/components/hotkeyButton.ts`),_components_label__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(`./src/ui/components/label.ts`),_components_select__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(`./src/ui/components/select.ts`),_components_slider__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(`./src/ui/components/slider.ts`),_components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(`./src/ui/components/sliderLabel.ts`),_components_textfield__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(`./src/ui/components/textfield.ts`),_components_tooltip__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(`./src/ui/components/tooltip.ts`),_vot_js_ext_types_service__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(`./node_modules/@vot.js/ext/dist/types/service.js`),___WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(`./src/index.js`),_audioDownloader__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(`./src/audioDownloader/index.ts`),_config_config__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(`./src/config/config.js`),_core_eventImpl__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(`./src/core/eventImpl.ts`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(`./src/localization/localizationProvider.ts`),_types_components_votButton__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(`./src/types/components/votButton.ts`),_utils_debug__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(`./src/utils/debug.ts`),_utils_gm__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(`./src/utils/gm.ts`),_utils_storage__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(`./src/utils/storage.ts`),_utils_translateApis__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(`./src/utils/translateApis.ts`),_utils_utils__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(`./src/utils/utils.ts`),_icons__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(`./src/ui/icons.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_ui__WEBPACK_IMPORTED_MODULE_1__,_components_accountButton__WEBPACK_IMPORTED_MODULE_2__,_components_checkbox__WEBPACK_IMPORTED_MODULE_3__,_components_details__WEBPACK_IMPORTED_MODULE_4__,_components_dialog__WEBPACK_IMPORTED_MODULE_5__,_components_hotkeyButton__WEBPACK_IMPORTED_MODULE_6__,_components_label__WEBPACK_IMPORTED_MODULE_7__,_components_select__WEBPACK_IMPORTED_MODULE_8__,_components_slider__WEBPACK_IMPORTED_MODULE_9__,_components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__,_components_textfield__WEBPACK_IMPORTED_MODULE_11__,_components_tooltip__WEBPACK_IMPORTED_MODULE_12__,___WEBPACK_IMPORTED_MODULE_14__,_audioDownloader__WEBPACK_IMPORTED_MODULE_15__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__,_utils_gm__WEBPACK_IMPORTED_MODULE_18__,_utils_storage__WEBPACK_IMPORTED_MODULE_19__,_utils_translateApis__WEBPACK_IMPORTED_MODULE_20__,_utils_utils__WEBPACK_IMPORTED_MODULE_21__]);[_ui__WEBPACK_IMPORTED_MODULE_1__,_components_accountButton__WEBPACK_IMPORTED_MODULE_2__,_components_checkbox__WEBPACK_IMPORTED_MODULE_3__,_components_details__WEBPACK_IMPORTED_MODULE_4__,_components_dialog__WEBPACK_IMPORTED_MODULE_5__,_components_hotkeyButton__WEBPACK_IMPORTED_MODULE_6__,_components_label__WEBPACK_IMPORTED_MODULE_7__,_components_select__WEBPACK_IMPORTED_MODULE_8__,_components_slider__WEBPACK_IMPORTED_MODULE_9__,_components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__,_components_textfield__WEBPACK_IMPORTED_MODULE_11__,_components_tooltip__WEBPACK_IMPORTED_MODULE_12__,___WEBPACK_IMPORTED_MODULE_14__,_audioDownloader__WEBPACK_IMPORTED_MODULE_15__,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__,_utils_gm__WEBPACK_IMPORTED_MODULE_18__,_utils_storage__WEBPACK_IMPORTED_MODULE_19__,_utils_translateApis__WEBPACK_IMPORTED_MODULE_20__,_utils_utils__WEBPACK_IMPORTED_MODULE_21__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;class SettingsView{globalPortal;initialized=!1;data;videoHandler;onClickBugReport=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onClickResetSettings=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onUpdateAccount=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeAutoTranslate=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeShowVideoVolume=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeAudioBooster=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeUseLivelyVoice=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeSubtitlesHighlightWords=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeProxyWorkerHost=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeUseNewAudioPlayer=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeOnlyBypassMediaCSP=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onChangeShowPiPButton=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onInputSubtitlesMaxLength=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onInputSubtitlesFontSize=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onInputSubtitlesBackgroundOpacity=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onInputAutoHideButtonDelay=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onSelectItemProxyTranslationStatus=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onSelectItemTranslationTextService=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onSelectItemButtonPosition=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;onSelectItemMenuLanguage=new _core_eventImpl__WEBPACK_IMPORTED_MODULE_23__.Z;dialog;accountHeader;accountButton;accountButtonRefreshTooltip;accountButtonTokenTooltip;translationSettingsHeader;autoTranslateCheckbox;dontTranslateLanguagesCheckbox;dontTranslateLanguagesSelect;autoSetVolumeSliderLabel;autoSetVolumeCheckbox;autoSetVolumeSlider;showVideoVolumeSliderCheckbox;audioBoosterCheckbox;audioBoosterTooltip;syncVolumeCheckbox;downloadWithNameCheckbox;sendNotifyOnCompleteCheckbox;useLivelyVoiceCheckbox;useLivelyVoiceTooltip;useAudioDownloadCheckbox;useAudioDownloadCheckboxLabel;useAudioDownloadCheckboxTooltip;subtitlesSettingsHeader;subtitlesDownloadFormatSelectLabel;subtitlesDownloadFormatSelect;subtitlesDesignDetails;hotkeysSettingsHeader;translateHotkeyButton;proxySettingsHeader;proxyM3U8HostTextfield;proxyWorkerHostTextfield;proxyTranslationStatusSelectLabel;proxyTranslationStatusSelectTooltip;proxyTranslationStatusSelect;miscSettingsHeader;translateAPIErrorsCheckbox;useNewAudioPlayerCheckbox;useNewAudioPlayerTooltip;onlyBypassMediaCSPCheckbox;onlyBypassMediaCSPTooltip;translationTextServiceLabel;translationTextServiceSelect;translationTextServiceTooltip;detectServiceLabel;detectServiceSelect;appearanceDetails;aboutExtensionDetails;bugReportButton;resetSettingsButton;constructor({globalPortal,data={},videoHandler}){this.globalPortal=globalPortal,this.data=data,this.videoHandler=videoHandler}isInitialized(){return this.initialized}initUI(){if(this.isInitialized())throw Error(`[VOT] SettingsView is already initialized`);this.initialized=!0,this.dialog=new _components_dialog__WEBPACK_IMPORTED_MODULE_5__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSettings`)}),this.globalPortal.appendChild(this.dialog.container),this.accountHeader=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createHeader(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTMyAccount`)),this.accountButton=new _components_accountButton__WEBPACK_IMPORTED_MODULE_2__.A({avatarId:this.data.account?.avatarId,username:this.data.account?.username,loggedIn:!!this.data.account?.token}),_utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.isSupportOnlyLS()?(this.accountButton.refreshButton.setAttribute(`disabled`,`true`),this.accountButton.actionButton.setAttribute(`disabled`,`true`)):this.accountButtonRefreshTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.accountButton.refreshButton,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTRefresh`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal}),this.accountButtonTokenTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.accountButton.tokenButton,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTLoginViaToken`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal}),this.translationSettingsHeader=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createHeader(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`translationSettings`)),this.autoTranslateCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTAutoTranslate`),checked:this.data.autoTranslate});let dontTranslateLanguages=this.data.dontTranslateLanguages??[];this.dontTranslateLanguagesCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`DontTranslateSelectedLanguages`),checked:this.data.enabledDontTranslateLanguages}),this.dontTranslateLanguagesSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({dialogParent:this.globalPortal,dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`DontTranslateSelectedLanguages`),selectTitle:dontTranslateLanguages.map(lang=>_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`langs.${lang}`)).join(`, `)??_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`DontTranslateSelectedLanguages`),items:_components_select__WEBPACK_IMPORTED_MODULE_8__.A.genLanguageItems(_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_24__.xm).map(item=>({...item,selected:dontTranslateLanguages.includes(item.value)})),multiSelect:!0,labelElement:this.dontTranslateLanguagesCheckbox.container});let autoVolume=this.data.autoVolume??_config_config__WEBPACK_IMPORTED_MODULE_25__.JD;this.autoSetVolumeSliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTAutoSetVolume`),value:autoVolume}),this.autoSetVolumeCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:this.autoSetVolumeSliderLabel.container,checked:this.data.enabledAutoVolume??!0}),this.autoSetVolumeSlider=new _components_slider__WEBPACK_IMPORTED_MODULE_9__.A({labelHtml:this.autoSetVolumeCheckbox.container,value:autoVolume}),this.showVideoVolumeSliderCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`showVideoVolumeSlider`),checked:this.data.showVideoSlider}),this.audioBoosterCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTAudioBooster`),checked:this.data.audioBooster}),this.videoHandler?.audioContext||(this.audioBoosterCheckbox.disabled=!0,this.audioBoosterTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.audioBoosterCheckbox.container,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTNeedWebAudioAPI`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal})),this.syncVolumeCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSyncVolume`),checked:this.data.syncVolume}),this.downloadWithNameCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTDownloadWithName`),checked:this.data.downloadWithName}),this.downloadWithNameCheckbox.disabled=!_utils_gm__WEBPACK_IMPORTED_MODULE_18__.yx,this.sendNotifyOnCompleteCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSendNotifyOnComplete`),checked:this.data.sendNotifyOnComplete}),this.useLivelyVoiceCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTUseLivelyVoice`),checked:this.data.useLivelyVoice}),this.useLivelyVoiceTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.useLivelyVoiceCheckbox.container,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTAccountRequired`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal,hidden:!!this.data.account?.token}),this.data.account?.token||(this.useLivelyVoiceCheckbox.disabled=!0),this.useAudioDownloadCheckboxLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTUseAudioDownload`),icon:_icons__WEBPACK_IMPORTED_MODULE_22__.Xd}),this.useAudioDownloadCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:this.useAudioDownloadCheckboxLabel.container,checked:this.data.useAudioDownload}),_utils_gm__WEBPACK_IMPORTED_MODULE_18__.B0||(this.useAudioDownloadCheckbox.disabled=!0),this.useAudioDownloadCheckboxTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.useAudioDownloadCheckboxLabel.container,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTUseAudioDownloadWarning`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal}),this.dialog.bodyContainer.append(this.accountHeader,this.accountButton.container,this.translationSettingsHeader,this.autoTranslateCheckbox.container,this.dontTranslateLanguagesSelect.container,this.autoSetVolumeSlider.container,this.showVideoVolumeSliderCheckbox.container,this.audioBoosterCheckbox.container,this.syncVolumeCheckbox.container,this.downloadWithNameCheckbox.container,this.sendNotifyOnCompleteCheckbox.container,this.useLivelyVoiceCheckbox.container,this.useAudioDownloadCheckbox.container),this.subtitlesSettingsHeader=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createHeader(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`subtitlesSettings`)),this.subtitlesDownloadFormatSelectLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesDownloadFormat`)}),this.subtitlesDownloadFormatSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({selectTitle:this.data.subtitlesDownloadFormat??_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesDownloadFormat`),dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesDownloadFormat`),dialogParent:this.globalPortal,labelElement:this.subtitlesDownloadFormatSelectLabel.container,items:_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_24__.EG.map(format=>({label:format.toUpperCase(),value:format,selected:format===this.data.subtitlesDownloadFormat}))}),this.subtitlesDesignDetails=new _components_details__WEBPACK_IMPORTED_MODULE_4__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesDesign`)}),this.dialog.bodyContainer.append(this.subtitlesSettingsHeader,this.subtitlesDownloadFormatSelect.container,this.subtitlesDesignDetails.container),this.hotkeysSettingsHeader=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createHeader(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`hotkeysSettings`)),this.translateHotkeyButton=new _components_hotkeyButton__WEBPACK_IMPORTED_MODULE_6__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`translateVideo`),key:this.data.translationHotkey}),this.dialog.bodyContainer.append(this.hotkeysSettingsHeader,this.translateHotkeyButton.container),this.proxySettingsHeader=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createHeader(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`proxySettings`)),this.proxyM3U8HostTextfield=new _components_textfield__WEBPACK_IMPORTED_MODULE_11__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTM3u8ProxyHost`),value:this.data.m3u8ProxyHost,placeholder:_config_config__WEBPACK_IMPORTED_MODULE_25__.se}),this.proxyWorkerHostTextfield=new _components_textfield__WEBPACK_IMPORTED_MODULE_11__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTProxyWorkerHost`),value:this.data.proxyWorkerHost,placeholder:_config_config__WEBPACK_IMPORTED_MODULE_25__.Pm});let proxyEnabledLabels=[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateProxyDisabled`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateProxyEnabled`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateProxyEverything`)],translateProxyEnabled=this.data.translateProxyEnabled??0,isTranslateProxyRequired=___WEBPACK_IMPORTED_MODULE_14__.k&&_config_config__WEBPACK_IMPORTED_MODULE_25__.vZ.includes(___WEBPACK_IMPORTED_MODULE_14__.k);this.proxyTranslationStatusSelectLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({icon:isTranslateProxyRequired?_icons__WEBPACK_IMPORTED_MODULE_22__.Xd:void 0,labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateProxyStatus`)}),isTranslateProxyRequired&&(this.proxyTranslationStatusSelectTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.proxyTranslationStatusSelectLabel.icon,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateProxyStatusDefault`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal})),this.proxyTranslationStatusSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({selectTitle:proxyEnabledLabels[translateProxyEnabled],dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateProxyStatus`),dialogParent:this.globalPortal,labelElement:this.proxyTranslationStatusSelectLabel.container,items:proxyEnabledLabels.map((label,idx)=>({label,value:idx.toString(),selected:idx===translateProxyEnabled,disabled:idx===0&&_utils_gm__WEBPACK_IMPORTED_MODULE_18__.up}))}),this.dialog.bodyContainer.append(this.proxySettingsHeader,this.proxyM3U8HostTextfield.container,this.proxyWorkerHostTextfield.container,this.proxyTranslationStatusSelect.container),this.miscSettingsHeader=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createHeader(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`miscSettings`)),this.translateAPIErrorsCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslateAPIErrors`),checked:this.data.translateAPIErrors??!0}),this.translateAPIErrorsCheckbox.hidden=_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.lang===`ru`,this.useNewAudioPlayerCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTNewAudioPlayer`),checked:this.data.newAudioPlayer}),this.videoHandler?.audioContext||(this.useNewAudioPlayerCheckbox.disabled=!0,this.useNewAudioPlayerTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.useNewAudioPlayerCheckbox.container,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTNeedWebAudioAPI`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal}));let onlyBypassMediaCSPLabel=this.videoHandler?.site.needBypassCSP?`${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTOnlyBypassMediaCSP`)} (${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTMediaCSPEnabledOnSite`)})`:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTOnlyBypassMediaCSP`);this.onlyBypassMediaCSPCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:onlyBypassMediaCSPLabel,checked:this.data.onlyBypassMediaCSP,isSubCheckbox:!0}),this.videoHandler?.audioContext||(this.onlyBypassMediaCSPTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.onlyBypassMediaCSPCheckbox.container,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTNeedWebAudioAPI`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal})),this.onlyBypassMediaCSPCheckbox.disabled=!this.data.newAudioPlayer&&!!this.videoHandler?.audioContext,this.data.newAudioPlayer||(this.onlyBypassMediaCSPCheckbox.hidden=!0),this.translationTextServiceLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslationTextService`),icon:_icons__WEBPACK_IMPORTED_MODULE_22__.w2});let translationService=this.data.translationService??_config_config__WEBPACK_IMPORTED_MODULE_25__.mE;this.translationTextServiceSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`services.${translationService}`),dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTTranslationTextService`),dialogParent:this.globalPortal,labelElement:this.translationTextServiceLabel.container,items:_utils_translateApis__WEBPACK_IMPORTED_MODULE_20__.vN.map(service=>({label:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`services.${service}`),value:service,selected:service===translationService}))}),this.translationTextServiceTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:this.translationTextServiceLabel.icon,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTNotAffectToVoice`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal}),this.detectServiceLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTDetectService`)});let detectService=this.data.detectService??_config_config__WEBPACK_IMPORTED_MODULE_25__.K2;return this.detectServiceSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`services.${detectService}`),dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTDetectService`),dialogParent:this.globalPortal,labelElement:this.detectServiceLabel.container,items:_utils_translateApis__WEBPACK_IMPORTED_MODULE_20__.qh.map(service=>({label:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`services.${service}`),value:service,selected:service===detectService}))}),this.appearanceDetails=new _components_details__WEBPACK_IMPORTED_MODULE_4__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`appearance`)}),this.aboutExtensionDetails=new _components_details__WEBPACK_IMPORTED_MODULE_4__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`aboutExtension`)}),this.bugReportButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createOutlinedButton(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTBugReport`)),this.resetSettingsButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createButton(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`resetSettings`)),this.dialog.bodyContainer.append(this.miscSettingsHeader,this.translateAPIErrorsCheckbox.container,this.useNewAudioPlayerCheckbox.container,this.onlyBypassMediaCSPCheckbox.container,this.translationTextServiceSelect.container,this.detectServiceSelect.container,this.appearanceDetails.container,this.aboutExtensionDetails.container,this.bugReportButton,this.resetSettingsButton),this}initUIEvents(){if(!this.isInitialized())throw Error(`[VOT] SettingsView isn't initialized`);return this.accountButton.addEventListener(`click`,async()=>{if(!_utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.isSupportOnlyLS()){if(this.accountButton.loggedIn)return await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.delete(`account`),this.data.account={},this.updateAccountInfo();window.open(_config_config__WEBPACK_IMPORTED_MODULE_25__.xW,`_blank`)?.focus()}}),this.accountButton.addEventListener(`click:secret`,async()=>{let dialog=new _components_dialog__WEBPACK_IMPORTED_MODULE_5__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTLoginViaToken`),isTemp:!0});this.globalPortal.appendChild(dialog.container);let tokenInfoEl=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createEl(`vot-block`,void 0,_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTYandexTokenInfo`)),tokenTextfield=new _components_textfield__WEBPACK_IMPORTED_MODULE_11__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTYandexToken`),value:this.data.account?.token});tokenTextfield.addEventListener(`change`,async token=>{this.data.account=token?{expires:Date.now()+3153418e4,token}:{},await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`account`,this.data.account),this.updateAccountInfo()}),dialog.bodyContainer.append(tokenInfoEl,tokenTextfield.container)}),this.accountButton.addEventListener(`refresh`,async()=>{_utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.isSupportOnlyLS()||(this.data.account=await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.get(`account`,{}),this.updateAccountInfo())}),this.autoTranslateCheckbox.addEventListener(`change`,async checked=>{this.data.autoTranslate=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`autoTranslate`,this.data.autoTranslate),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`autoTranslate value changed. New value:`,checked),this.onChangeAutoTranslate.dispatch(checked)}),this.dontTranslateLanguagesCheckbox.addEventListener(`change`,async checked=>{this.data.enabledDontTranslateLanguages=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`enabledDontTranslateLanguages`,this.data.enabledDontTranslateLanguages),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`enabledDontTranslateLanguages value changed. New value:`,checked)}),this.dontTranslateLanguagesSelect.addEventListener(`selectItem`,async values=>{this.data.dontTranslateLanguages=values,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`dontTranslateLanguages`,this.data.dontTranslateLanguages),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`dontTranslateLanguages value changed. New value:`,values)}),this.autoSetVolumeCheckbox.addEventListener(`change`,async checked=>{this.data.enabledAutoVolume=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`enabledAutoVolume`,this.data.enabledAutoVolume),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`enabledAutoVolume value changed. New value:`,checked)}),this.autoSetVolumeSlider.addEventListener(`input`,async value=>{this.data.autoVolume=this.autoSetVolumeSliderLabel.value=value,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`autoVolume`,this.data.autoVolume),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`autoVolume value changed. New value:`,value)}),this.showVideoVolumeSliderCheckbox.addEventListener(`change`,async checked=>{this.data.showVideoSlider=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`showVideoSlider`,this.data.showVideoSlider),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`showVideoVolumeSlider value changed. New value:`,checked),this.onChangeShowVideoVolume.dispatch(checked)}),this.audioBoosterCheckbox.addEventListener(`change`,async checked=>{this.data.audioBooster=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`audioBooster`,this.data.audioBooster),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`audioBooster value changed. New value:`,checked),this.onChangeAudioBooster.dispatch(checked)}),this.syncVolumeCheckbox.addEventListener(`change`,async checked=>{this.data.syncVolume=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`syncVolume`,this.data.syncVolume),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`syncVolume value changed. New value:`,checked)}),this.downloadWithNameCheckbox.addEventListener(`change`,async checked=>{this.data.downloadWithName=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`downloadWithName`,this.data.downloadWithName),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`downloadWithName value changed. New value:`,checked)}),this.sendNotifyOnCompleteCheckbox.addEventListener(`change`,async checked=>{this.data.sendNotifyOnComplete=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`sendNotifyOnComplete`,this.data.sendNotifyOnComplete),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`sendNotifyOnComplete value changed. New value:`,checked)}),this.useLivelyVoiceCheckbox.addEventListener(`change`,async checked=>{this.data.useLivelyVoice=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`useLivelyVoice`,this.data.useLivelyVoice),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`useLivelyVoice value changed. New value:`,checked),this.onChangeUseLivelyVoice.dispatch(checked)}),this.useAudioDownloadCheckbox.addEventListener(`change`,async checked=>{this.data.useAudioDownload=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`useAudioDownload`,this.data.useAudioDownload),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`useAudioDownload value changed. New value:`,checked)}),this.subtitlesDownloadFormatSelect.addEventListener(`selectItem`,async item=>{this.data.subtitlesDownloadFormat=item,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`subtitlesDownloadFormat`,this.data.subtitlesDownloadFormat),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`subtitlesDownloadFormat value changed. New value:`,item)}),this.subtitlesDesignDetails.addEventListener(`click`,()=>{let dialog=new _components_dialog__WEBPACK_IMPORTED_MODULE_5__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesDesign`),isTemp:!0});this.globalPortal.appendChild(dialog.container);let subtitlesHighlightWordsCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTHighlightWords`),checked:this.data.highlightWords}),subtitlesMaxLength=this.data.subtitlesMaxLength??300,subtitlesMaxLengthSliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesMaxLength`),labelEOL:`:`,symbol:``,value:subtitlesMaxLength}),subtitlesMaxLengthSlider=new _components_slider__WEBPACK_IMPORTED_MODULE_9__.A({labelHtml:subtitlesMaxLengthSliderLabel.container,value:subtitlesMaxLength,min:50,max:300}),subtitlesFontSize=this.data.subtitlesFontSize??20,subtitlesFontSizeSliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesFontSize`),labelEOL:`:`,symbol:`px`,value:subtitlesFontSize}),subtitlesFontSizeSlider=new _components_slider__WEBPACK_IMPORTED_MODULE_9__.A({labelHtml:subtitlesFontSizeSliderLabel.container,value:subtitlesFontSize,min:8,max:50}),subtitlesBackgroundOpacity=this.data.subtitlesOpacity??20,subtitlesBackgroundOpacitySliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTSubtitlesOpacity`),labelEOL:`:`,value:subtitlesBackgroundOpacity}),subtitlesBackgroundOpacitySlider=new _components_slider__WEBPACK_IMPORTED_MODULE_9__.A({labelHtml:subtitlesBackgroundOpacitySliderLabel.container,value:subtitlesBackgroundOpacity});dialog.bodyContainer.append(subtitlesHighlightWordsCheckbox.container,subtitlesMaxLengthSlider.container,subtitlesFontSizeSlider.container,subtitlesBackgroundOpacitySlider.container),subtitlesHighlightWordsCheckbox.addEventListener(`change`,async checked=>{this.data.highlightWords=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`highlightWords`,this.data.highlightWords),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`highlightWords value changed. New value:`,checked),this.onChangeSubtitlesHighlightWords.dispatch(checked)}),subtitlesMaxLengthSlider.addEventListener(`input`,value=>{subtitlesMaxLengthSliderLabel.value=value,this.data.subtitlesMaxLength=value,_utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`subtitlesMaxLength`,this.data.subtitlesMaxLength),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`highlightWords value changed. New value:`,value),this.onInputSubtitlesMaxLength.dispatch(value)}),subtitlesFontSizeSlider.addEventListener(`input`,value=>{subtitlesFontSizeSliderLabel.value=value,this.data.subtitlesFontSize=value,_utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`subtitlesFontSize`,this.data.subtitlesFontSize),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`subtitlesFontSize value changed. New value:`,value),this.onInputSubtitlesFontSize.dispatch(value)}),subtitlesBackgroundOpacitySlider.addEventListener(`input`,value=>{subtitlesBackgroundOpacitySliderLabel.value=value,this.data.subtitlesOpacity=value,_utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`subtitlesOpacity`,this.data.subtitlesOpacity),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`subtitlesOpacity value changed. New value:`,value),this.onInputSubtitlesBackgroundOpacity.dispatch(value)})}),this.translateHotkeyButton.addEventListener(`change`,async key=>{this.data.translationHotkey=key,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`translationHotkey`,this.data.translationHotkey),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`translationHotkey value changed. New value:`,key)}),this.proxyM3U8HostTextfield.addEventListener(`change`,async value=>{this.data.m3u8ProxyHost=value||_config_config__WEBPACK_IMPORTED_MODULE_25__.se,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`m3u8ProxyHost`,this.data.m3u8ProxyHost),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`m3u8ProxyHost value changed. New value:`,this.data.m3u8ProxyHost)}),this.proxyWorkerHostTextfield.addEventListener(`change`,async value=>{this.data.proxyWorkerHost=value||_config_config__WEBPACK_IMPORTED_MODULE_25__.Pm,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`proxyWorkerHost`,this.data.proxyWorkerHost),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`proxyWorkerHost value changed. New value:`,this.data.proxyWorkerHost),this.onChangeProxyWorkerHost.dispatch(value)}),this.proxyTranslationStatusSelect.addEventListener(`selectItem`,async item=>{this.data.translateProxyEnabled=Number.parseInt(item),await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`translateProxyEnabled`,this.data.translateProxyEnabled),await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`translateProxyEnabledDefault`,!1),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`translateProxyEnabled value changed. New value:`,this.data.translateProxyEnabled),this.onSelectItemProxyTranslationStatus.dispatch(item)}),this.translateAPIErrorsCheckbox.addEventListener(`change`,async checked=>{this.data.translateAPIErrors=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`translateAPIErrors`,this.data.translateAPIErrors),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`translateAPIErrors value changed. New value:`,checked)}),this.useNewAudioPlayerCheckbox.addEventListener(`change`,async checked=>{this.data.newAudioPlayer=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`newAudioPlayer`,this.data.newAudioPlayer),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`newAudioPlayer value changed. New value:`,checked),this.onlyBypassMediaCSPCheckbox.disabled=this.onlyBypassMediaCSPCheckbox.hidden=!checked,this.onChangeUseNewAudioPlayer.dispatch(checked)}),this.onlyBypassMediaCSPCheckbox.addEventListener(`change`,async checked=>{this.data.onlyBypassMediaCSP=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`onlyBypassMediaCSP`,this.data.onlyBypassMediaCSP),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`onlyBypassMediaCSP value changed. New value:`,checked),this.onChangeOnlyBypassMediaCSP.dispatch(checked)}),this.translationTextServiceSelect.addEventListener(`selectItem`,async item=>{this.data.translationService=item,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`translationService`,this.data.translationService),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`translationService value changed. New value:`,item),this.onSelectItemTranslationTextService.dispatch(item)}),this.detectServiceSelect.addEventListener(`selectItem`,async item=>{this.data.detectService=item,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`detectService`,this.data.detectService),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`detectService value changed. New value:`,item)}),this.appearanceDetails.addEventListener(`click`,()=>{let dialog=new _components_dialog__WEBPACK_IMPORTED_MODULE_5__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`appearance`),isTemp:!0});this.globalPortal.appendChild(dialog.container);let showPiPButtonCheckbox=new _components_checkbox__WEBPACK_IMPORTED_MODULE_3__.A({labelHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTShowPiPButton`),checked:this.data.showPiPButton});showPiPButtonCheckbox.hidden=!(0,_utils_utils__WEBPACK_IMPORTED_MODULE_21__.Bs)();let autoHideButtonDelay=(this.data.autoHideButtonDelay??_config_config__WEBPACK_IMPORTED_MODULE_25__.qU)/1e3,autoHideButtonDelaySliderLabel=new _components_sliderLabel__WEBPACK_IMPORTED_MODULE_10__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`autoHideButtonDelay`),labelEOL:`:`,symbol:` ${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`secs`)}`,value:autoHideButtonDelay}),autoHideButtonDelaySlider=new _components_slider__WEBPACK_IMPORTED_MODULE_9__.A({labelHtml:autoHideButtonDelaySliderLabel.container,value:autoHideButtonDelay,min:.1,max:3,step:.1}),buttonPositionSelectLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`buttonPositionInWidePlayer`),icon:_icons__WEBPACK_IMPORTED_MODULE_22__.w2}),buttonPositionSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`buttonPositionInWidePlayer`),dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`buttonPositionInWidePlayer`),labelElement:buttonPositionSelectLabel.container,dialogParent:this.globalPortal,items:_types_components_votButton__WEBPACK_IMPORTED_MODULE_26__.X.map(position=>({label:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`position.${position}`),value:position,selected:position===this.data.buttonPos}))}),buttonPositionTooltip=new _components_tooltip__WEBPACK_IMPORTED_MODULE_12__.A({target:buttonPositionSelectLabel.icon,content:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`minButtonPositionContainer`),position:`bottom`,backgroundColor:`var(--vot-helper-ondialog)`,parentElement:this.globalPortal}),menuLanguageSelectLabel=new _components_label__WEBPACK_IMPORTED_MODULE_7__.A({labelText:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTMenuLanguage`)}),menuLanguageSelect=new _components_select__WEBPACK_IMPORTED_MODULE_8__.A({selectTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`langs.${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.langOverride}`),dialogTitle:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTMenuLanguage`),labelElement:menuLanguageSelectLabel.container,dialogParent:this.globalPortal,items:_components_select__WEBPACK_IMPORTED_MODULE_8__.A.genLanguageItems(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.getAvailableLangs(),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.langOverride)});dialog.bodyContainer.append(showPiPButtonCheckbox.container,autoHideButtonDelaySlider.container,buttonPositionSelect.container,menuLanguageSelect.container),dialog.addEventListener(`close`,()=>{buttonPositionTooltip.release()}),showPiPButtonCheckbox.addEventListener(`change`,async checked=>{this.data.showPiPButton=checked,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`showPiPButton`,this.data.showPiPButton),_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`showPiPButton value changed. New value:`,checked),this.onChangeShowPiPButton.dispatch(checked)}),autoHideButtonDelaySlider.addEventListener(`input`,async value=>{autoHideButtonDelaySliderLabel.value=value;let newDelay=Math.round(value*1e3);_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`autoHideButtonDelay value changed. New value:`,newDelay),this.data.autoHideButtonDelay=newDelay,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`autoHideButtonDelay`,this.data.autoHideButtonDelay),this.onInputAutoHideButtonDelay.dispatch(value)}),buttonPositionSelect.addEventListener(`selectItem`,async item=>{_utils_debug__WEBPACK_IMPORTED_MODULE_17__.A.log(`buttonPos value changed. New value:`,item),this.data.buttonPos=item,await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`buttonPos`,this.data.buttonPos),this.onSelectItemButtonPosition.dispatch(item)}),menuLanguageSelect.addEventListener(`selectItem`,async item=>{let result=await _localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.changeLang(item);result&&(this.data.localeUpdatedAt=await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.get(`localeUpdatedAt`,0),this.onSelectItemMenuLanguage.dispatch(item))})}),this.aboutExtensionDetails.addEventListener(`click`,()=>{let dialog=new _components_dialog__WEBPACK_IMPORTED_MODULE_5__.A({titleHtml:_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`aboutExtension`),isTemp:!0});this.globalPortal.appendChild(dialog.container);let versionInfo=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createInformation(`${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTVersion`)}:`,GM_info.script.version||_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`notFound`)),authorsInfo=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createInformation(`${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTAuthors`)}:`,GM_info.script.author??_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`notFound`)),loaderInfo=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createInformation(`${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTLoader`)}:`,`${GM_info.scriptHandler} v${GM_info.version}`),userBrowserInfo=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createInformation(`${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTBrowser`)}:`,`${_utils_utils__WEBPACK_IMPORTED_MODULE_21__.R5.browser.name} ${_utils_utils__WEBPACK_IMPORTED_MODULE_21__.R5.browser.version} (${_utils_utils__WEBPACK_IMPORTED_MODULE_21__.R5.os.name} ${_utils_utils__WEBPACK_IMPORTED_MODULE_21__.R5.os.version})`),localeUpdatedAt=new Date((this.data.localeUpdatedAt??0)*1e3).toLocaleString(),localeInfoValue=(0,lit_html__WEBPACK_IMPORTED_MODULE_0__.qy)`${this.data.localeHash}<br />(${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTUpdatedAt`)}
        ${localeUpdatedAt})`,localeInfo=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createInformation(`${_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTLocaleHash`)}:`,localeInfoValue),updateLocaleFilesButton=_ui__WEBPACK_IMPORTED_MODULE_1__.A.createOutlinedButton(_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.get(`VOTUpdateLocaleFiles`));dialog.bodyContainer.append(versionInfo.container,authorsInfo.container,loaderInfo.container,userBrowserInfo.container,localeInfo.container,updateLocaleFilesButton),updateLocaleFilesButton.addEventListener(`click`,async()=>{await _utils_storage__WEBPACK_IMPORTED_MODULE_19__.d.set(`localeHash`,``),await _localization_localizationProvider__WEBPACK_IMPORTED_MODULE_16__.j.update(!0),window.location.reload()})}),this.bugReportButton.addEventListener(`click`,()=>{this.onClickBugReport.dispatch()}),this.resetSettingsButton.addEventListener(`click`,()=>{this.onClickResetSettings.dispatch()}),this}addEventListener(type,listener){switch(type){case`click:bugReport`:this.onClickBugReport.addListener(listener);break;case`click:resetSettings`:this.onClickResetSettings.addListener(listener);break;case`update:account`:this.onUpdateAccount.addListener(listener);break;case`change:autoTranslate`:this.onChangeAutoTranslate.addListener(listener);break;case`change:showVideoVolume`:this.onChangeShowVideoVolume.addListener(listener);break;case`change:audioBuster`:this.onChangeAudioBooster.addListener(listener);break;case`change:useLivelyVoice`:this.onChangeUseLivelyVoice.addListener(listener);break;case`change:subtitlesHighlightWords`:this.onChangeSubtitlesHighlightWords.addListener(listener);break;case`change:proxyWorkerHost`:this.onChangeProxyWorkerHost.addListener(listener);break;case`change:useNewAudioPlayer`:this.onChangeUseNewAudioPlayer.addListener(listener);break;case`change:onlyBypassMediaCSP`:this.onChangeOnlyBypassMediaCSP.addListener(listener);break;case`change:showPiPButton`:this.onChangeShowPiPButton.addListener(listener);break;case`input:subtitlesMaxLength`:this.onInputSubtitlesMaxLength.addListener(listener);break;case`input:subtitlesFontSize`:this.onInputSubtitlesFontSize.addListener(listener);break;case`input:subtitlesBackgroundOpacity`:this.onInputSubtitlesBackgroundOpacity.addListener(listener);break;case`input:autoHideButtonDelay`:this.onInputAutoHideButtonDelay.addListener(listener);break;case`select:proxyTranslationStatus`:this.onSelectItemProxyTranslationStatus.addListener(listener);break;case`select:translationTextService`:this.onSelectItemTranslationTextService.addListener(listener);break;case`select:buttonPosition`:this.onSelectItemButtonPosition.addListener(listener);break;case`select:menuLanguage`:this.onSelectItemMenuLanguage.addListener(listener);break}return this}removeEventListener(type,listener){switch(type){case`click:bugReport`:this.onClickBugReport.removeListener(listener);break;case`click:resetSettings`:this.onClickResetSettings.removeListener(listener);break;case`update:account`:this.onUpdateAccount.removeListener(listener);break;case`change:autoTranslate`:this.onChangeAutoTranslate.removeListener(listener);break;case`change:showVideoVolume`:this.onChangeShowVideoVolume.removeListener(listener);break;case`change:audioBuster`:this.onChangeAudioBooster.removeListener(listener);break;case`change:useLivelyVoice`:this.onChangeUseLivelyVoice.removeListener(listener);break;case`change:subtitlesHighlightWords`:this.onChangeSubtitlesHighlightWords.removeListener(listener);break;case`change:proxyWorkerHost`:this.onChangeProxyWorkerHost.removeListener(listener);break;case`change:useNewAudioPlayer`:this.onChangeUseNewAudioPlayer.removeListener(listener);break;case`change:onlyBypassMediaCSP`:this.onChangeOnlyBypassMediaCSP.removeListener(listener);break;case`change:showPiPButton`:this.onChangeShowPiPButton.removeListener(listener);break;case`input:subtitlesMaxLength`:this.onInputSubtitlesMaxLength.removeListener(listener);break;case`input:subtitlesFontSize`:this.onInputSubtitlesFontSize.removeListener(listener);break;case`input:subtitlesBackgroundOpacity`:this.onInputSubtitlesBackgroundOpacity.removeListener(listener);break;case`input:autoHideButtonDelay`:this.onInputAutoHideButtonDelay.removeListener(listener);break;case`select:proxyTranslationStatus`:this.onSelectItemProxyTranslationStatus.removeListener(listener);break;case`select:translationTextService`:this.onSelectItemTranslationTextService.removeListener(listener);break;case`select:buttonPosition`:this.onSelectItemButtonPosition.removeListener(listener);break;case`select:menuLanguage`:this.onSelectItemMenuLanguage.removeListener(listener);break}return this}releaseUI(initialized=!1){if(!this.isInitialized())throw Error(`[VOT] SettingsView isn't initialized`);return this.dialog.remove(),this.accountButtonRefreshTooltip?.release(),this.accountButtonTokenTooltip?.release(),this.audioBoosterTooltip?.release(),this.useAudioDownloadCheckboxTooltip?.release(),this.useNewAudioPlayerTooltip?.release(),this.onlyBypassMediaCSPTooltip?.release(),this.translationTextServiceTooltip?.release(),this.proxyTranslationStatusSelectTooltip?.release(),this.initialized=initialized,this}releaseUIEvents(initialized=!1){if(!this.isInitialized())throw Error(`[VOT] SettingsView isn't initialized`);return this.onClickBugReport.clear(),this.onClickResetSettings.clear(),this.onUpdateAccount.clear(),this.onChangeAutoTranslate.clear(),this.onChangeShowVideoVolume.clear(),this.onChangeAudioBooster.clear(),this.onChangeUseLivelyVoice.clear(),this.onChangeSubtitlesHighlightWords.clear(),this.onChangeProxyWorkerHost.clear(),this.onChangeUseNewAudioPlayer.clear(),this.onChangeOnlyBypassMediaCSP.clear(),this.onChangeShowPiPButton.clear(),this.onInputSubtitlesMaxLength.clear(),this.onInputSubtitlesFontSize.clear(),this.onInputSubtitlesBackgroundOpacity.clear(),this.onInputAutoHideButtonDelay.clear(),this.onSelectItemProxyTranslationStatus.clear(),this.onSelectItemTranslationTextService.clear(),this.onSelectItemButtonPosition.clear(),this.onSelectItemMenuLanguage.clear(),this.initialized=initialized,this}release(){return this.releaseUI(!0),this.releaseUIEvents(!1),this}updateAccountInfo(){if(!this.isInitialized())throw Error(`[VOT] SettingsView isn't initialized`);let loggedIn=!!this.data.account?.token;return this.accountButton.avatarId=this.data.account?.avatarId,this.useLivelyVoiceTooltip.hidden=this.accountButton.loggedIn=loggedIn,this.accountButton.username=this.data.account?.username,this.useLivelyVoiceCheckbox.disabled=!loggedIn,this.onUpdateAccount.dispatch(this.data.account),this}open(){if(!this.isInitialized())throw Error(`[VOT] SettingsView isn't initialized`);return this.dialog.open()}close(){if(!this.isInitialized())throw Error(`[VOT] SettingsView isn't initialized`);return this.dialog.close()}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/VOTLocalizedError.js":(__webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(__webpack_module__,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{n:()=>VOTLocalizedError});var _localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/localization/localizationProvider.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_0__]);_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];class VOTLocalizedError extends Error{constructor(message){super(_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_0__.j.getDefault(message)),this.name=`VOTLocalizedError`,this.unlocalizedMessage=message,this.localizedMessage=_localization_localizationProvider_ts__WEBPACK_IMPORTED_MODULE_0__.j.get(message)}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/VideoObserver.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>VideoObserver});var requestidlecallback_polyfill__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/requestidlecallback-polyfill/index.js`),_vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/alternativeUrls.js`),_core_eventImpl_ts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/core/eventImpl.ts`),_debug_ts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/debug.ts`);class VideoObserver{static adKeywords=new Set([`advertise`,`advertisement`,`promo`,`sponsor`,`banner`,`commercial`,`preroll`,`midroll`,`postroll`,`ad-container`,`sponsored`]);constructor(){this.videoCache=new WeakSet,this.observedNodes={added:new Set,removed:new Set},this.onVideoAdded=new _core_eventImpl_ts__WEBPACK_IMPORTED_MODULE_2__.Z,this.onVideoRemoved=new _core_eventImpl_ts__WEBPACK_IMPORTED_MODULE_2__.Z,this.observer=new MutationObserver(this.handleMutations)}isAdRelated(element){let attributes=[`class`,`id`,`title`];for(let attr of attributes){let value=element.getAttribute(attr);if(value&&VideoObserver.adKeywords.has(value.toLowerCase()))return!0}return!1}hasAudio(video){return _vot_js_shared_alternativeUrls__WEBPACK_IMPORTED_MODULE_3__.sx.includes(window.location.hostname)?!video.muted:video.mozHasAudio===void 0?video.webkitAudioDecodedByteCount===void 0?`audioTracks`in video&&video.audioTracks.length>0||!video.muted:video.webkitAudioDecodedByteCount>0:video.mozHasAudio}isValidVideo(video){if(this.isAdRelated(video))return!1;let parent=video.parentElement;for(;parent&&!this.isAdRelated(parent);)parent=parent.parentElement;return parent?!1:this.hasAudio(video)?!0:(_debug_ts__WEBPACK_IMPORTED_MODULE_1__.A.log(`Ignoring video without audio:`,video),!1)}traverseDOM(root){if(root instanceof HTMLVideoElement){this.checkVideoState(root);return}let treeWalker=document.createTreeWalker(root,NodeFilter.SHOW_ELEMENT,{acceptNode:node=>node.tagName===`VIDEO`||node.shadowRoot?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;treeWalker.nextNode();){let currentNode=treeWalker.currentNode;currentNode instanceof HTMLVideoElement&&this.checkVideoState(currentNode),currentNode.shadowRoot&&this.traverseDOM(currentNode.shadowRoot)}}checkVideoState(video){if(this.videoCache.has(video))return;this.videoCache.add(video);let onLoadedData=()=>{this.isValidVideo(video)&&this.onVideoAdded.dispatch(video),video.removeEventListener(`loadeddata`,onLoadedData)},onEmptied=()=>{video.isConnected||(this.onVideoRemoved.dispatch(video),this.videoCache.delete(video),video.removeEventListener(`emptied`,onEmptied))};video.addEventListener(`emptied`,onEmptied),video.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?onLoadedData():video.addEventListener(`loadeddata`,onLoadedData)}handleMutations=mutations=>{for(let mutation of mutations){if(mutation.type!==`childList`)continue;for(let node of mutation.addedNodes)this.observedNodes.added.add(node);for(let node of mutation.removedNodes)this.observedNodes.removed.add(node)}window.requestIdleCallback(()=>{for(let node of this.observedNodes.added)this.traverseDOM(node);for(let node of this.observedNodes.removed)if(node.querySelectorAll){let videos=node.querySelectorAll(`video`);for(let video of videos)video.isConnected||(this.onVideoRemoved.dispatch(video),this.videoCache.delete(video))}this.observedNodes.added.clear(),this.observedNodes.removed.clear()},{timeout:1e3})};enable(){this.observer.observe(document.documentElement,{childList:!0,subtree:!0}),this.traverseDOM(document.documentElement)}disable(){this.observer.disconnect(),this.videoCache=new WeakSet}}},"./src/utils/debug.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});let __WEBPACK_DEFAULT_EXPORT__={log:(...text)=>{}}},"./src/utils/gm.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{B0:()=>isUnsafeWindowAllowed,G3:()=>GM_fetch,O6:()=>isSupportGM4,up:()=>isProxyOnlyExtension,yx:()=>isSupportGMXhr});var _config_config__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/config/config.js`),_debug__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/utils/debug.ts`),_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils__WEBPACK_IMPORTED_MODULE_1__]);_utils__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];let isProxyOnlyExtension=GM_info?.scriptHandler&&!_config_config__WEBPACK_IMPORTED_MODULE_2__.Wl.includes(GM_info.scriptHandler),isSupportGM4=typeof GM<`u`,isUnsafeWindowAllowed=typeof unsafeWindow<`u`,isSupportGMXhr=typeof GM_xmlhttpRequest<`u`;async function GM_fetch(url,opts={}){let{timeout=15e3,...fetchOptions}=opts,controller=new AbortController;try{if(typeof url==`string`&&url.includes(`api.browser.yandex.ru`))throw Error(`Preventing yandex cors`);return await fetch(url,{signal:controller.signal,...fetchOptions})}catch(err){_debug__WEBPACK_IMPORTED_MODULE_0__.A.log(`GM_fetch preventing CORS by GM_xmlhttpRequest`,err.message);let headers=(0,_utils__WEBPACK_IMPORTED_MODULE_1__.dJ)(fetchOptions.headers);return new Promise((resolve,reject)=>{GM_xmlhttpRequest({method:fetchOptions.method||`GET`,url:url.toString(),responseType:`blob`,data:fetchOptions.body,timeout,headers,onload:resp=>{let headers=resp.responseHeaders.split(/\r?\n/).reduce((acc,line)=>{let[,key,value]=line.match(/^([\w-]+): (.+)$/)||[];return key&&(acc[key]=value),acc},{}),response=new Response(resp.response,{status:resp.status,headers});Object.defineProperty(response,`url`,{value:resp.finalUrl??``}),resolve(response)},ontimeout:()=>reject(Error(`Timeout`)),onerror:error=>reject(Error(error)),onabort:()=>reject(Error(`AbortError`))})})}}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/iframeConnector.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{$2:()=>postResponseMessage,IA:()=>ensureServiceIframe,Io:()=>initIframeService,Ok:()=>generateMessageId,WF:()=>IFRAME_HASH,d4:()=>isIframe,hG:()=>requestDataFromMainWorld,yB:()=>hasServiceIframe});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/utils/utils.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_utils__WEBPACK_IMPORTED_MODULE_0__]);_utils__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];let IFRAME_HASH=`vot_iframe`,isIframe=()=>window.self!==window.top,generateMessageId=()=>`main-world-bridge-${performance.now()}-${Math.random()}`,hasServiceIframe=iframeId=>document.getElementById(iframeId);async function setupServiceIframe(src,id,service){let iframe=document.createElement(`iframe`);iframe.style.position=`absolute`,iframe.style.zIndex=`-1`,iframe.style.display=`none`,iframe.id=id,iframe.src=`${src}#${IFRAME_HASH}`,document.body.appendChild(iframe);let ready=new Promise(resolve=>{let handleMessage=({data})=>{data.messageType===`say-${service}-iframe-is-ready`&&(window.removeEventListener(`message`,handleMessage),resolve(!0))};window.addEventListener(`message`,handleMessage)});return await Promise.race([ready,(0,_utils__WEBPACK_IMPORTED_MODULE_0__.wR)(15e3,`Service iframe did not have time to be ready`)]),iframe}async function ensureServiceIframe(iframe,src,iframeId,service){if(src.includes(`#`))throw Error(`The src parameter should not contain a hash (#) character.`);let serviceIframe=hasServiceIframe(iframeId);if(serviceIframe){if(iframe!==null)return iframe;serviceIframe?.remove()}return iframe=await setupServiceIframe(src,iframeId,service),iframe}function initIframeService(service,onmessage){window.addEventListener(`message`,onmessage),window.parent.postMessage({messageType:`say-${service}-iframe-is-ready`,messageDirection:`response`},`*`)}function requestDataFromMainWorld(messageType,payload){let messageId=generateMessageId();return new Promise((resolve,reject)=>{let handleMessage=({data})=>{data?.messageId===messageId&&data.messageType===messageType&&data.messageDirection===`response`&&(window.removeEventListener(`message`,handleMessage),data.error?reject(data.error):resolve(data.payload))};window.addEventListener(`message`,handleMessage),window.postMessage({messageId,messageType,messageDirection:`request`,...payload!==void 0&&{payload}},`*`)})}function postResponseMessage(event,payload){let{data,source,origin}=event;if(!source)throw Error(`No source in postResponseMessage event`);source.postMessage({messageId:data.messageId,messageDirection:`response`,messageType:data.messageType,payload},{targetOrigin:origin})}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/localization.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{o:()=>secsToStrTime,v:()=>lang});var _localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/localization/localizationProvider.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__]);_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];let MAX_SECS_FRACTION=.66,lang=navigator.language?.substring(0,2).toLowerCase()||`en`;function secsToStrTime(secs){let minutes=Math.floor(secs/60),seconds=Math.floor(secs%60),fraction=seconds/60;if(fraction>=MAX_SECS_FRACTION&&(minutes+=1,seconds=0),minutes>=60)return _localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`translationTakeMoreThanHour`);if(minutes<=1)return _localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`translationTakeAboutMinute`);let minutesStr=String(minutes);return minutes!==11&&minutes%10==1?_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`translationTakeApproximatelyMinute2`).replace(`{0}`,minutesStr):![12,13,14].includes(minutes)&&[2,3,4].includes(minutes%10)?_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`translationTakeApproximatelyMinute`).replace(`{0}`,minutesStr):_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.get(`translationTakeApproximatelyMinutes`).replace(`{0}`,minutesStr)}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/storage.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{_:()=>updateConfig,d:()=>votStorage});var _config_config__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./src/config/config.js`),_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/localization/localizationProvider.ts`),_types_storage__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(`./src/types/storage.ts`),_debug__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/debug.ts`),_gm__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/utils/gm.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__,_gm__WEBPACK_IMPORTED_MODULE_2__]);[_localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__,_gm__WEBPACK_IMPORTED_MODULE_2__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;let compatMay2025Data={numToBool:[[`autoTranslate`],[`dontTranslateYourLang`,`enabledDontTranslateLanguages`],[`autoSetVolumeYandexStyle`,`enabledAutoVolume`],[`showVideoSlider`],[`syncVolume`],[`downloadWithName`],[`sendNotifyOnComplete`],[`highlightWords`],[`onlyBypassMediaCSP`],[`newAudioPlayer`],[`showPiPButton`],[`translateAPIErrors`],[`audioBooster`],[`useNewModel`,`useLivelyVoice`]],number:[[`autoVolume`]],array:[[`dontTranslateLanguage`,`dontTranslateLanguages`]],string:[[`hotkeyButton`,`translationHotkey`],[`locale-lang-override`,`localeLangOverride`],[`locale-lang`,`localeLang`]]};function getCompatCategory(key,value,convertData){if(typeof value==`number`)return convertData?.number.some(item=>item[0]===key)?`number`:`numToBool`;if(Array.isArray(value))return`array`;if(typeof value==`string`||value===null)return`string`}function convertByCompatCategory(category,value){return[`string`,`array`,`number`].includes(category)?value:!!value}async function updateConfig(data){if(data.compatVersion===_config_config__WEBPACK_IMPORTED_MODULE_3__.r4)return data;let oldKeys=Object.values(compatMay2025Data).flat().reduce((result,key)=>(key[1]&&(result[key[0]]=void 0),result),{}),oldData=await votStorage.getValues(oldKeys),existsOldData=Object.fromEntries(Object.entries(oldData).filter(([_,value])=>value!==void 0)),allData={...data,...existsOldData},allDataKeys=Object.keys(allData).reduce((result,key)=>(result[key]=void 0,result),{}),realValues=await votStorage.getValues(allDataKeys),newData=data;for(let[key,value]of Object.entries(allData)){let category=getCompatCategory(key,value,compatMay2025Data);if(!category)continue;let compatItem=compatMay2025Data[category].find(item=>item[0]===key);if(!compatItem)continue;let newKey=compatItem[1]??key;if(realValues[key]===void 0)continue;let newValue=convertByCompatCategory(category,value);key===`autoVolume`&&value<1&&(newValue=Math.round(value*100)),newData[newKey]=newValue,existsOldData[key]!==void 0&&await votStorage.delete(key),newKey===`localeLangOverride`&&await _localization_localizationProvider__WEBPACK_IMPORTED_MODULE_0__.j.changeLang(value),await votStorage.set(newKey,newValue)}return{...newData,compatVersion:`2025-05-09`}}let votStorage=new class{supportGM;supportGMPromises;supportGMGetValues;constructor(){this.supportGM=typeof GM_getValue==`function`,this.supportGMPromises=_gm__WEBPACK_IMPORTED_MODULE_2__.O6&&typeof GM?.getValue==`function`,this.supportGMGetValues=_gm__WEBPACK_IMPORTED_MODULE_2__.O6&&typeof GM?.getValues==`function`,_debug__WEBPACK_IMPORTED_MODULE_1__.A.log(`[VOT Storage] GM Promises: ${this.supportGMPromises} | GM: ${this.supportGM}`)}isSupportOnlyLS(){return!this.supportGM&&!this.supportGMPromises}syncGet(name,def){if(this.supportGM)return GM_getValue(name,def);let val=(window.localStorage.getItem(name));if(!val)return def;try{return JSON.parse(val)}catch{return def}}async get(name,def){return this.supportGMPromises?await GM.getValue(name,def):Promise.resolve(this.syncGet(name,def))}async getValues(data){return this.supportGMGetValues?await GM.getValues(data):Object.fromEntries(await Promise.all(Object.entries(data).map(async([key,value])=>{let val=await this.get(key,value);return[key,val]})))}syncSet(name,value){return this.supportGM?GM_setValue(name,value):window.localStorage.setItem(name,JSON.stringify(value))}async set(name,value){return this.supportGMPromises?await GM.setValue(name,value):Promise.resolve(this.syncSet(name,value))}syncDelete(name){return this.supportGM?GM_deleteValue(name):window.localStorage.removeItem(name)}async delete(name){return this.supportGMPromises?await GM.deleteValue(name):Promise.resolve(this.syncDelete(name))}syncList(){return this.supportGM?GM_listValues():_types_storage__WEBPACK_IMPORTED_MODULE_4__.w}async list(){return this.supportGMPromises?await GM.listValues():Promise.resolve(this.syncList())}};__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/translateApis.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{Tl:()=>translate,o0:()=>detect,qh:()=>detectServices,vN:()=>foswlyServices});var _config_config_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./src/config/config.js`),_gm__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./src/utils/gm.ts`),_storage__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/storage.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_gm__WEBPACK_IMPORTED_MODULE_0__,_storage__WEBPACK_IMPORTED_MODULE_1__]);[_gm__WEBPACK_IMPORTED_MODULE_0__,_storage__WEBPACK_IMPORTED_MODULE_1__]=__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__;let FOSWLYTranslateAPI=new class{isFOSWLYError(data){return Object.hasOwn(data,`error`)}async request(path,opts={}){try{let res=await((0,_gm__WEBPACK_IMPORTED_MODULE_0__.G3)(`${_config_config_js__WEBPACK_IMPORTED_MODULE_2__.k$}${path}`,{timeout:3e3,...opts})),data=await(res.json());if(this.isFOSWLYError(data))throw data.error;return data}catch(err){console.error(`[VOT] Failed to get data from FOSWLY Translate API, because ${err.message}`);return}}async translateMultiple(text,lang,service){let result=await(this.request(`/translate`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({text,lang,service})}));return result?result.translations:text}async translate(text,lang,service){let result=await(this.request(`/translate?${new URLSearchParams({text,lang,service})}`));return result?result.translations[0]:text}async detect(text,service){let result=await(this.request(`/detect?${new URLSearchParams({text,service})}`));return result?result.lang:`en`}},RustServerAPI={async detect(text){try{let response=await(0,_gm__WEBPACK_IMPORTED_MODULE_0__.G3)(_config_config_js__WEBPACK_IMPORTED_MODULE_2__.sl,{method:`POST`,body:text,timeout:3e3});return await response.text()}catch(error){return console.error(`[VOT] Error getting lang from text, because ${error.message}`),`en`}}};async function translate(text,fromLang=``,toLang=`ru`){let service=await _storage__WEBPACK_IMPORTED_MODULE_1__.d.get(`translationService`,_config_config_js__WEBPACK_IMPORTED_MODULE_2__.mE);switch(service){case`yandexbrowser`:case`msedge`:{let langPair=fromLang&&toLang?`${fromLang}-${toLang}`:toLang;return Array.isArray(text)?await FOSWLYTranslateAPI.translateMultiple(text,langPair,service):await FOSWLYTranslateAPI.translate(text,langPair,service)}default:return text}}async function detect(text){let service=await _storage__WEBPACK_IMPORTED_MODULE_1__.d.get(`detectService`,_config_config_js__WEBPACK_IMPORTED_MODULE_2__.K2);switch(service){case`yandexbrowser`:case`msedge`:return await FOSWLYTranslateAPI.detect(text,service);case`rust-server`:return await RustServerAPI.detect(text);default:return`en`}}let foswlyServices=[`yandexbrowser`,`msedge`],detectServices=[...foswlyServices,`rust-server`];__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/utils.ts":(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.a(module,async(__webpack_handle_async_dependencies__,__webpack_async_result__)=>{try{__webpack_require__.d(__webpack_exports__,{Bs:()=>isPiPAvailable,CK:()=>initHls,Eh:()=>exitFullscreen,GW:()=>toFlatObj,HD:()=>calculatedResLang,Le:()=>clearFileName,MR:()=>downloadTranslation,R5:()=>browserInfo,UV:()=>waitForCondition,WN:()=>downloadBlob,Wo:()=>openDownloadTranslation,X5:()=>cleanText,dJ:()=>getHeaders,lg:()=>getTimestamp,qE:()=>clamp,wR:()=>timeout});var bowser__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(`./node_modules/bowser/es5.js`),bowser__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(bowser__WEBPACK_IMPORTED_MODULE_0__),browser_id3_writer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(`./node_modules/browser-id3-writer/dist/browser-id3-writer.mjs`),_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(`./node_modules/@vot.js/shared/dist/data/consts.js`),_localization__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(`./src/utils/localization.ts`),__webpack_async_dependencies__=__webpack_handle_async_dependencies__([_localization__WEBPACK_IMPORTED_MODULE_1__]);_localization__WEBPACK_IMPORTED_MODULE_1__=(__webpack_async_dependencies__.then?(await __webpack_async_dependencies__)():__webpack_async_dependencies__)[0];let textFilters=/(?:https?|www|\bhttp\s+)[^\s/]*?(?:\.\s*[a-z]{2,}|\/)\S*|#[^\s#]+|auto-generated\s+by\s+youtube|provided\s+to\s+youtube\s+by|released\s+on|paypal?|0x[\da-f]{40}|[13][1-9a-z]{25,34}|4[\dab][1-9a-z]{93}|t[1-9a-z]{33}/gi,slavicLangs=new Set([`uk`,`be`,`bg`,`mk`,`sr`,`bs`,`hr`,`sl`,`pl`,`sk`,`cs`]),calculatedResLang=(()=>_vot_js_shared_consts__WEBPACK_IMPORTED_MODULE_2__.Xh.includes(_localization__WEBPACK_IMPORTED_MODULE_1__.v)?_localization__WEBPACK_IMPORTED_MODULE_1__.v:slavicLangs.has(_localization__WEBPACK_IMPORTED_MODULE_1__.v)?`ru`:`en`)(),browserInfo=bowser__WEBPACK_IMPORTED_MODULE_0___default().getParser(window.navigator.userAgent).getResult(),isPiPAvailable=()=>`pictureInPictureEnabled`in document&&document.pictureInPictureEnabled;function initHls(){return typeof Hls<`u`&&Hls?.isSupported()?new Hls({debug:!1,lowLatencyMode:!0,backBufferLength:90}):void 0}function cleanText(title,description){return(title+` `+(description||``)).replace(textFilters,``).replace(/[^\p{L}]+/gu,` `).substring(0,450).trim()}function downloadBlob(blob,filename){let url=URL.createObjectURL(blob),a=document.createElement(`a`);a.href=url,a.download=filename,a.click(),URL.revokeObjectURL(url)}function clearFileName(filename){return filename.trim().length===0?new Date().toLocaleDateString(`en-us`).replaceAll(`/`,`-`):filename.replace(/^https?:\/\//,``).replace(/[\\/:*?"'<>|]/g,`-`)}function getTimestamp(){return Math.floor(Date.now()/1e3)}function getHeaders(headers){return headers instanceof Headers?Object.fromEntries(headers.entries()):Array.isArray(headers)?Object.fromEntries(headers):headers||{}}function clamp(value,min=0,max=100){return Math.min(Math.max(value,min),max)}function toFlatObj(data){return Object.entries(data).reduce((result,[key,val])=>{if(val===void 0)return result;if(typeof val!=`object`)return result[key]=val,result;let nestedItem=Object.entries(toFlatObj(data[key])).reduce((res,[k,v])=>(res[`${key}.${k}`]=v,res),{});return{...result,...nestedItem}},{})}async function exitFullscreen(){let doc=document;(doc.fullscreenElement||doc.webkitFullscreenElement)&&(doc.webkitExitFullscreen&&await doc.webkitExitFullscreen(),doc.exitFullscreen&&await doc.exitFullscreen())}let sleep=ms=>new Promise(resolve=>setTimeout(resolve,ms));function timeout(ms,message=`Operation timed out`){return new Promise((_,reject)=>{setTimeout(()=>reject(Error(message)),ms)})}async function waitForCondition(condition,timeoutMs,throwOnTimeout=!1){let timedOut=!1;return Promise.race([(async()=>{for(;!condition()&&!timedOut;)await sleep(100)})(),new Promise((resolve,reject)=>{setTimeout(()=>{timedOut=!0,throwOnTimeout?reject(Error(`Wait for condition reached timeout of ${timeoutMs}`)):resolve()},timeoutMs)})])}async function _downloadTranslationWithProgress(res,contentLength,onProgress=_progress=>{}){let reader=res.body?.getReader();if(!reader)throw Error(`Response body is not readable`);let chunksBuffer=new Uint8Array(contentLength),offset=0;for(;;){let{done,value}=await reader.read();if(done)break;chunksBuffer.set(value,offset),offset+=value.length,onProgress(Math.round(offset/contentLength*100))}return chunksBuffer.buffer}async function downloadTranslation(res,filename,onProgress=_progress=>{}){let contentLength=+(res.headers.get(`Content-Length`)??0),arrayBuffer=await(contentLength?_downloadTranslationWithProgress(res,contentLength,onProgress):res.arrayBuffer());onProgress(100);let writer=new browser_id3_writer__WEBPACK_IMPORTED_MODULE_3__.Q(arrayBuffer);return writer.setFrame(`TIT2`,filename),writer.addTag(),downloadBlob(writer.getBlob(),`${filename}.mp3`),!0}function openDownloadTranslation(url){window.open(url,`_blank`)?.focus()}__webpack_async_result__()}catch(e){__webpack_async_result__(e)}})},"./src/utils/volume.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>syncVolume});function syncVolume(element,sliderVolume,otherSliderVolume,tempVolume){let finalValue=sliderVolume;return sliderVolume>tempVolume?(finalValue=otherSliderVolume+(sliderVolume-tempVolume),finalValue=finalValue>100?100:Math.max(finalValue,0),element.volume=finalValue/100):sliderVolume<tempVolume&&(finalValue=otherSliderVolume-(tempVolume-sliderVolume),finalValue=finalValue>100?100:Math.max(finalValue,0),element.volume=finalValue/100),finalValue}}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==void 0)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}(()=>{var webpackQueues=typeof Symbol==`function`?Symbol(`webpack queues`):`__webpack_queues__`,webpackExports=typeof Symbol==`function`?Symbol(`webpack exports`):`__webpack_exports__`,webpackError=typeof Symbol==`function`?Symbol(`webpack error`):`__webpack_error__`,resolveQueue=queue=>{queue&&queue.d<1&&(queue.d=1,queue.forEach(fn=>fn.r--),queue.forEach(fn=>fn.r--?fn.r++:fn()))},wrapDeps=deps=>deps.map(dep=>{if(typeof dep==`object`&&dep){if(dep[webpackQueues])return dep;if(dep.then){var queue=[];queue.d=0,dep.then(r=>{obj[webpackExports]=r,resolveQueue(queue)},e=>{obj[webpackError]=e,resolveQueue(queue)});var obj={};return obj[webpackQueues]=fn=>fn(queue),obj}}var ret={};return ret[webpackQueues]=x=>{},ret[webpackExports]=dep,ret});__webpack_require__.a=(module,body,hasAwait)=>{var queue;hasAwait&&((queue=[]).d=-1);var depQueues=new Set,exports=module.exports,currentDeps,outerResolve,reject,promise=new Promise((resolve,rej)=>{reject=rej,outerResolve=resolve});promise[webpackExports]=exports,promise[webpackQueues]=fn=>(queue&&fn(queue),depQueues.forEach(fn),promise.catch(x=>{})),module.exports=promise,body(deps=>{currentDeps=wrapDeps(deps);var fn,getResult=()=>currentDeps.map(d=>{if(d[webpackError])throw d[webpackError];return d[webpackExports]}),promise=new Promise(resolve=>{fn=()=>resolve(getResult),fn.r=0;var fnQueue=q=>q!==queue&&!depQueues.has(q)&&(depQueues.add(q),q&&!q.d&&(fn.r++,q.push(fn)));currentDeps.map(dep=>dep[webpackQueues](fnQueue))});return fn.r?promise:getResult()},err=>(err?reject(promise[webpackError]=err):outerResolve(exports),resolveQueue(queue))),queue&&queue.d<0&&(queue.d=0)}})(),__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop);var __webpack_exports__=__webpack_require__(`./src/index.js`)})();